import{f as tf,j as tn,k as te,h as Sr,i as So,m as Sm,w as rf,o as sf,p as Nc,t as Ao,q as Am,e as jr,s as Ii,V as Rm,M as Om,N as G,u as Cm,v as Ec,x as Tm,K as $m,A as Nm,y as kh,z as Dm,H as Fm,F as qm,B as Bh,$ as jm,C as Lm,J as Mm,D as Zs,E as Kh,X as zm,G as Um,I as Dc,_ as nf,L as Fr,O as Hm,P as Vh,Q as gs,R as Ot,U as Kt,S as Ei,T as ar,W as km,Y as ys,Z as of,a0 as Bm,a1 as Km,a2 as Vm,a3 as af,a4 as Gm,a5 as cf,a6 as uf,a7 as ms,a8 as Ic,a9 as wo,aa as bs,ab as Wm,ac as bo,ad as Jm,ae as Qm,af as Ym,ag as Zm,ah as lo,ai as Xm,aj as e1,ak as oc,al as Gh,am as t1,an as r1,ao as i1,ap as Wh,aq as s1,ar as n1,as as o1,at as a1,au as c1,av as u1,aw as h1,ax as Ws,ay as hf,az as ac,aA as l1,aB as f1,aC as p1}from"./index-b9e86077.js";const d1=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,g1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,y1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function v1(a,t){if(a==="__proto__"||a==="constructor"&&t&&typeof t=="object"&&"prototype"in t){m1(a);return}return t}function m1(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function fo(a,t={}){if(typeof a!="string")return a;const i=a.trim();if(a[0]==='"'&&a.endsWith('"')&&!a.includes("\\"))return i.slice(1,-1);if(i.length<=9){const n=i.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!y1.test(a)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(d1.test(a)||g1.test(a)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,v1)}return JSON.parse(a)}catch(n){if(t.strict)throw n;return a}}function w1(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function qt(a,...t){try{return w1(a(...t))}catch(i){return Promise.reject(i)}}function b1(a){const t=typeof a;return a===null||t!=="object"&&t!=="function"}function _1(a){const t=Object.getPrototypeOf(a);return!t||t.isPrototypeOf(Object)}function _o(a){if(b1(a))return String(a);if(_1(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return _o(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function lf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const xc="base64:";function E1(a){if(typeof a=="string")return a;lf();const t=Buffer.from(a).toString("base64");return xc+t}function I1(a){return typeof a!="string"||!a.startsWith(xc)?a:(lf(),Buffer.from(a.slice(xc.length),"base64"))}function or(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function x1(...a){return or(a.join(":"))}function po(a){return a=or(a),a?a+":":""}const P1="memory",S1=()=>{const a=new Map;return{name:P1,options:{},hasItem(t){return a.has(t)},getItem(t){return a.get(t)??null},getItemRaw(t){return a.get(t)??null},setItem(t,i){a.set(t,i)},setItemRaw(t,i){a.set(t,i)},removeItem(t){a.delete(t)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function A1(a={}){const t={mounts:{"":a.driver||S1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},i=g=>{for(const E of t.mountpoints)if(g.startsWith(E))return{base:E,relativeKey:g.slice(E.length),driver:t.mounts[E]};return{base:"",relativeKey:g,driver:t.mounts[""]}},n=(g,E)=>t.mountpoints.filter(R=>R.startsWith(g)||E&&g.startsWith(R)).map(R=>({relativeBase:g.length>R.length?g.slice(R.length):void 0,mountpoint:R,driver:t.mounts[R]})),o=(g,E)=>{if(t.watching){E=or(E);for(const R of t.watchListeners)R(g,E)}},h=async()=>{if(!t.watching){t.watching=!0;for(const g in t.mounts)t.unwatch[g]=await Jh(t.mounts[g],o,g)}},p=async()=>{if(t.watching){for(const g in t.unwatch)await t.unwatch[g]();t.unwatch={},t.watching=!1}},y=(g,E,R)=>{const N=new Map,q=C=>{let Y=N.get(C.base);return Y||(Y={driver:C.driver,base:C.base,items:[]},N.set(C.base,Y)),Y};for(const C of g){const Y=typeof C=="string",re=or(Y?C:C.key),oe=Y?void 0:C.value,ce=Y||!C.options?E:{...E,...C.options},ae=i(re);q(ae).items.push({key:re,value:oe,relativeKey:ae.relativeKey,options:ce})}return Promise.all([...N.values()].map(C=>R(C))).then(C=>C.flat())},m={hasItem(g,E={}){g=or(g);const{relativeKey:R,driver:N}=i(g);return qt(N.hasItem,R,E)},getItem(g,E={}){g=or(g);const{relativeKey:R,driver:N}=i(g);return qt(N.getItem,R,E).then(q=>fo(q))},getItems(g,E){return y(g,E,R=>R.driver.getItems?qt(R.driver.getItems,R.items.map(N=>({key:N.relativeKey,options:N.options})),E).then(N=>N.map(q=>({key:x1(R.base,q.key),value:fo(q.value)}))):Promise.all(R.items.map(N=>qt(R.driver.getItem,N.relativeKey,N.options).then(q=>({key:N.key,value:fo(q)})))))},getItemRaw(g,E={}){g=or(g);const{relativeKey:R,driver:N}=i(g);return N.getItemRaw?qt(N.getItemRaw,R,E):qt(N.getItem,R,E).then(q=>I1(q))},async setItem(g,E,R={}){if(E===void 0)return m.removeItem(g);g=or(g);const{relativeKey:N,driver:q}=i(g);q.setItem&&(await qt(q.setItem,N,_o(E),R),q.watch||o("update",g))},async setItems(g,E){await y(g,E,async R=>{if(R.driver.setItems)return qt(R.driver.setItems,R.items.map(N=>({key:N.relativeKey,value:_o(N.value),options:N.options})),E);R.driver.setItem&&await Promise.all(R.items.map(N=>qt(R.driver.setItem,N.relativeKey,_o(N.value),N.options)))})},async setItemRaw(g,E,R={}){if(E===void 0)return m.removeItem(g,R);g=or(g);const{relativeKey:N,driver:q}=i(g);if(q.setItemRaw)await qt(q.setItemRaw,N,E,R);else if(q.setItem)await qt(q.setItem,N,E1(E),R);else return;q.watch||o("update",g)},async removeItem(g,E={}){typeof E=="boolean"&&(E={removeMeta:E}),g=or(g);const{relativeKey:R,driver:N}=i(g);N.removeItem&&(await qt(N.removeItem,R,E),(E.removeMeta||E.removeMata)&&await qt(N.removeItem,R+"$",E),N.watch||o("remove",g))},async getMeta(g,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),g=or(g);const{relativeKey:R,driver:N}=i(g),q=Object.create(null);if(N.getMeta&&Object.assign(q,await qt(N.getMeta,R,E)),!E.nativeOnly){const C=await qt(N.getItem,R+"$",E).then(Y=>fo(Y));C&&typeof C=="object"&&(typeof C.atime=="string"&&(C.atime=new Date(C.atime)),typeof C.mtime=="string"&&(C.mtime=new Date(C.mtime)),Object.assign(q,C))}return q},setMeta(g,E,R={}){return this.setItem(g+"$",E,R)},removeMeta(g,E={}){return this.removeItem(g+"$",E)},async getKeys(g,E={}){g=po(g);const R=n(g,!0);let N=[];const q=[];for(const C of R){const re=(await qt(C.driver.getKeys,C.relativeBase,E)).map(oe=>C.mountpoint+or(oe)).filter(oe=>!N.some(ce=>oe.startsWith(ce)));q.push(...re),N=[C.mountpoint,...N.filter(oe=>!oe.startsWith(C.mountpoint))]}return g?q.filter(C=>C.startsWith(g)&&!C.endsWith("$")):q.filter(C=>!C.endsWith("$"))},async clear(g,E={}){g=po(g),await Promise.all(n(g,!1).map(async R=>{if(R.driver.clear)return qt(R.driver.clear,R.relativeBase,E);if(R.driver.removeItem){const N=await R.driver.getKeys(R.relativeBase||"",E);return Promise.all(N.map(q=>R.driver.removeItem(q,E)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(g=>Qh(g)))},async watch(g){return await h(),t.watchListeners.push(g),async()=>{t.watchListeners=t.watchListeners.filter(E=>E!==g),t.watchListeners.length===0&&await p()}},async unwatch(){t.watchListeners=[],await p()},mount(g,E){if(g=po(g),g&&t.mounts[g])throw new Error(`already mounted at ${g}`);return g&&(t.mountpoints.push(g),t.mountpoints.sort((R,N)=>N.length-R.length)),t.mounts[g]=E,t.watching&&Promise.resolve(Jh(E,o,g)).then(R=>{t.unwatch[g]=R}).catch(console.error),m},async unmount(g,E=!0){g=po(g),!(!g||!t.mounts[g])&&(t.watching&&g in t.unwatch&&(t.unwatch[g](),delete t.unwatch[g]),E&&await Qh(t.mounts[g]),t.mountpoints=t.mountpoints.filter(R=>R!==g),delete t.mounts[g])},getMount(g=""){g=or(g)+":";const E=i(g);return{driver:E.driver,base:E.base}},getMounts(g="",E={}){return g=or(g),n(g,E.parents).map(N=>({driver:N.driver,base:N.mountpoint}))}};return m}function Jh(a,t,i){return a.watch?a.watch((n,o)=>t(n,i+o)):()=>{}}async function Qh(a){typeof a.dispose=="function"&&await qt(a.dispose)}function Bi(a){return new Promise((t,i)=>{a.oncomplete=a.onsuccess=()=>t(a.result),a.onabort=a.onerror=()=>i(a.error)})}function ff(a,t){const i=indexedDB.open(a);i.onupgradeneeded=()=>i.result.createObjectStore(t);const n=Bi(i);return(o,h)=>n.then(p=>h(p.transaction(t,o).objectStore(t)))}let cc;function rn(){return cc||(cc=ff("keyval-store","keyval")),cc}function Yh(a,t=rn()){return t("readonly",i=>Bi(i.get(a)))}function R1(a,t,i=rn()){return i("readwrite",n=>(n.put(t,a),Bi(n.transaction)))}function O1(a,t=rn()){return t("readwrite",i=>(i.delete(a),Bi(i.transaction)))}function C1(a=rn()){return a("readwrite",t=>(t.clear(),Bi(t.transaction)))}function T1(a,t){return a.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Bi(a.transaction)}function $1(a=rn()){return a("readonly",t=>{if(t.getAllKeys)return Bi(t.getAllKeys());const i=[];return T1(t,n=>i.push(n.key)).then(()=>i)})}const N1=a=>JSON.stringify(a,(t,i)=>typeof i=="bigint"?i.toString()+"n":i),D1=a=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=a.replace(t,'$1"$2n"$3');return JSON.parse(i,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function sn(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return D1(a)}catch{return a}}function ki(a){return typeof a=="string"?a:N1(a)||""}const F1="idb-keyval";var q1=(a={})=>{const t=a.base&&a.base.length>0?`${a.base}:`:"",i=o=>t+o;let n;return a.dbName&&a.storeName&&(n=ff(a.dbName,a.storeName)),{name:F1,options:a,async hasItem(o){return!(typeof await Yh(i(o),n)>"u")},async getItem(o){return await Yh(i(o),n)??null},setItem(o,h){return R1(i(o),h,n)},removeItem(o){return O1(i(o),n)},getKeys(){return $1(n)},clear(){return C1(n)}}};const j1="WALLET_CONNECT_V2_INDEXED_DB",L1="keyvaluestorage";let M1=class{constructor(){this.indexedDb=A1({driver:q1({dbName:j1,storeName:L1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const i=await this.indexedDb.getItem(t);if(i!==null)return i}async setItem(t,i){await this.indexedDb.setItem(t,ki(i))}async removeItem(t){await this.indexedDb.removeItem(t)}};var uc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Eo={exports:{}};(function(){let a;function t(){}a=t,a.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},a.prototype.setItem=function(i,n){this[i]=String(n)},a.prototype.removeItem=function(i){delete this[i]},a.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(n){i[n]=void 0,delete i[n]})},a.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof uc<"u"&&uc.localStorage?Eo.exports=uc.localStorage:typeof window<"u"&&window.localStorage?Eo.exports=window.localStorage:Eo.exports=new t})();function z1(a){var t;return[a[0],sn((t=a[1])!=null?t:"")]}class U1{constructor(){this.localStorage=Eo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(z1)}async getItem(t){const i=this.localStorage.getItem(t);if(i!==null)return sn(i)}async setItem(t,i){this.localStorage.setItem(t,ki(i))}async removeItem(t){this.localStorage.removeItem(t)}}const H1="wc_storage_version",Zh=1,k1=async(a,t,i)=>{const n=H1,o=await t.getItem(n);if(o&&o>=Zh){i(t);return}const h=await a.getKeys();if(!h.length){i(t);return}const p=[];for(;h.length;){const y=h.shift();if(!y)continue;const m=y.toLowerCase();if(m.includes("wc@")||m.includes("walletconnect")||m.includes("wc_")||m.includes("wallet_connect")){const g=await a.getItem(y);await t.setItem(y,g),p.push(y)}}await t.setItem(n,Zh),i(t),B1(a,p)},B1=async(a,t)=>{t.length&&t.forEach(async i=>{await a.removeItem(i)})};let K1=class{constructor(){this.initialized=!1,this.setInitialized=i=>{this.storage=i,this.initialized=!0};const t=new U1;this.storage=t;try{const i=new M1;k1(t,i,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,i){return await this.initialize(),this.storage.setItem(t,i)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const i=setInterval(()=>{this.initialized&&(clearInterval(i),t())},20)})}};var _s={},Us={},hc={},Hs={};class Ki{}const V1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ki},Symbol.toStringTag,{value:"Module"})),G1=tf(V1);var Xh;function W1(){if(Xh)return Hs;Xh=1,Object.defineProperty(Hs,"__esModule",{value:!0}),Hs.IHeartBeat=void 0;const a=G1;class t extends a.IEvents{constructor(n){super()}}return Hs.IHeartBeat=t,Hs}var el;function pf(){return el||(el=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),tn.__exportStar(W1(),a)}(hc)),hc}var lc={},Hi={},tl;function J1(){if(tl)return Hi;tl=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.HEARTBEAT_EVENTS=Hi.HEARTBEAT_INTERVAL=void 0;const a=te;return Hi.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Hi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Hi}var rl;function df(){return rl||(rl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),tn.__exportStar(J1(),a)}(lc)),lc}var il;function Q1(){if(il)return Us;il=1,Object.defineProperty(Us,"__esModule",{value:!0}),Us.HeartBeat=void 0;const a=tn,t=Sr,i=te,n=pf(),o=df();class h extends n.IHeartBeat{constructor(y){super(y),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(y==null?void 0:y.interval)||o.HEARTBEAT_INTERVAL}static init(y){return a.__awaiter(this,void 0,void 0,function*(){const m=new h(y);return yield m.init(),m})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(y,m){this.events.on(y,m)}once(y,m){this.events.once(y,m)}off(y,m){this.events.off(y,m)}removeListener(y,m){this.events.removeListener(y,m)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Us.HeartBeat=h,Us}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=tn;t.__exportStar(Q1(),a),t.__exportStar(pf(),a),t.__exportStar(df(),a)})(_s);function Y1(a){try{return JSON.stringify(a)}catch{return'"[Circular]"'}}var Z1=X1;function X1(a,t,i){var n=i&&i.stringify||Y1,o=1;if(typeof a=="object"&&a!==null){var h=t.length+o;if(h===1)return a;var p=new Array(h);p[0]=n(a);for(var y=1;y<h;y++)p[y]=n(t[y]);return p.join(" ")}if(typeof a!="string")return a;var m=t.length;if(m===0)return a;for(var g="",E=1-o,R=-1,N=a&&a.length||0,q=0;q<N;){if(a.charCodeAt(q)===37&&q+1<N){switch(R=R>-1?R:0,a.charCodeAt(q+1)){case 100:case 102:if(E>=m||t[E]==null)break;R<q&&(g+=a.slice(R,q)),g+=Number(t[E]),R=q+2,q++;break;case 105:if(E>=m||t[E]==null)break;R<q&&(g+=a.slice(R,q)),g+=Math.floor(Number(t[E])),R=q+2,q++;break;case 79:case 111:case 106:if(E>=m||t[E]===void 0)break;R<q&&(g+=a.slice(R,q));var C=typeof t[E];if(C==="string"){g+="'"+t[E]+"'",R=q+2,q++;break}if(C==="function"){g+=t[E].name||"<anonymous>",R=q+2,q++;break}g+=n(t[E]),R=q+2,q++;break;case 115:if(E>=m)break;R<q&&(g+=a.slice(R,q)),g+=String(t[E]),R=q+2,q++;break;case 37:R<q&&(g+=a.slice(R,q)),g+="%",R=q+2,q++,E--;break}++E}++q}return R===-1?a:(R<N&&(g+=a.slice(R)),g)}const sl=Z1;var ew=Kr;const Xs=hw().console||{},tw={mapHttpRequest:go,mapHttpResponse:go,wrapRequestSerializer:fc,wrapResponseSerializer:fc,wrapErrorSerializer:fc,req:go,res:go,err:ow};function rw(a,t){return Array.isArray(a)?a.filter(function(n){return n!=="!stdSerializers.err"}):a===!0?Object.keys(t):!1}function Kr(a){a=a||{},a.browser=a.browser||{};const t=a.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const i=a.browser.write||Xs;a.browser.write&&(a.browser.asObject=!0);const n=a.serializers||{},o=rw(a.browser.serialize,n);let h=a.browser.serialize;Array.isArray(a.browser.serialize)&&a.browser.serialize.indexOf("!stdSerializers.err")>-1&&(h=!1);const p=["error","fatal","warn","info","debug","trace"];typeof i=="function"&&(i.error=i.fatal=i.warn=i.info=i.debug=i.trace=i),a.enabled===!1&&(a.level="silent");const y=a.level||"info",m=Object.create(i);m.log||(m.log=en),Object.defineProperty(m,"levelVal",{get:E}),Object.defineProperty(m,"level",{get:R,set:N});const g={transmit:t,serialize:o,asObject:a.browser.asObject,levels:p,timestamp:aw(a)};m.levels=Kr.levels,m.level=y,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=en,m.serializers=n,m._serialize=o,m._stdErrSerialize=h,m.child=q,t&&(m._logEvent=Pc());function E(){return this.level==="silent"?1/0:this.levels.values[this.level]}function R(){return this._level}function N(C){if(C!=="silent"&&!this.levels.values[C])throw Error("unknown level "+C);this._level=C,ps(g,m,"error","log"),ps(g,m,"fatal","error"),ps(g,m,"warn","error"),ps(g,m,"info","log"),ps(g,m,"debug","log"),ps(g,m,"trace","log")}function q(C,Y){if(!C)throw new Error("missing bindings for child Pino");Y=Y||{},o&&C.serializers&&(Y.serializers=C.serializers);const re=Y.serializers;if(o&&re){var oe=Object.assign({},n,re),ce=a.browser.serialize===!0?Object.keys(oe):o;delete C.serializers,Ro([C],ce,oe,this._stdErrSerialize)}function ae(ee){this._childLevel=(ee._childLevel|0)+1,this.error=ds(ee,C,"error"),this.fatal=ds(ee,C,"fatal"),this.warn=ds(ee,C,"warn"),this.info=ds(ee,C,"info"),this.debug=ds(ee,C,"debug"),this.trace=ds(ee,C,"trace"),oe&&(this.serializers=oe,this._serialize=ce),t&&(this._logEvent=Pc([].concat(ee._logEvent.bindings,C)))}return ae.prototype=this,new ae(this)}return m}Kr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Kr.stdSerializers=tw;Kr.stdTimeFunctions=Object.assign({},{nullTime:gf,epochTime:yf,unixTime:cw,isoTime:uw});function ps(a,t,i,n){const o=Object.getPrototypeOf(t);t[i]=t.levelVal>t.levels.values[i]?en:o[i]?o[i]:Xs[i]||Xs[n]||en,iw(a,t,i)}function iw(a,t,i){!a.transmit&&t[i]===en||(t[i]=function(n){return function(){const h=a.timestamp(),p=new Array(arguments.length),y=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Xs?Xs:this;for(var m=0;m<p.length;m++)p[m]=arguments[m];if(a.serialize&&!a.asObject&&Ro(p,this._serialize,this.serializers,this._stdErrSerialize),a.asObject?n.call(y,sw(this,i,p,h)):n.apply(y,p),a.transmit){const g=a.transmit.level||t.level,E=Kr.levels.values[g],R=Kr.levels.values[i];if(R<E)return;nw(this,{ts:h,methodLevel:i,methodValue:R,transmitLevel:g,transmitValue:Kr.levels.values[a.transmit.level||t.level],send:a.transmit.send,val:t.levelVal},p)}}}(t[i]))}function sw(a,t,i,n){a._serialize&&Ro(i,a._serialize,a.serializers,a._stdErrSerialize);const o=i.slice();let h=o[0];const p={};n&&(p.time=n),p.level=Kr.levels.values[t];let y=(a._childLevel|0)+1;if(y<1&&(y=1),h!==null&&typeof h=="object"){for(;y--&&typeof o[0]=="object";)Object.assign(p,o.shift());h=o.length?sl(o.shift(),o):void 0}else typeof h=="string"&&(h=sl(o.shift(),o));return h!==void 0&&(p.msg=h),p}function Ro(a,t,i,n){for(const o in a)if(n&&a[o]instanceof Error)a[o]=Kr.stdSerializers.err(a[o]);else if(typeof a[o]=="object"&&!Array.isArray(a[o]))for(const h in a[o])t&&t.indexOf(h)>-1&&h in i&&(a[o][h]=i[h](a[o][h]))}function ds(a,t,i){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var o=1;o<n.length;o++)n[o]=arguments[o-1];return a[i].apply(this,n)}}function nw(a,t,i){const n=t.send,o=t.ts,h=t.methodLevel,p=t.methodValue,y=t.val,m=a._logEvent.bindings;Ro(i,a._serialize||Object.keys(a.serializers),a.serializers,a._stdErrSerialize===void 0?!0:a._stdErrSerialize),a._logEvent.ts=o,a._logEvent.messages=i.filter(function(g){return m.indexOf(g)===-1}),a._logEvent.level.label=h,a._logEvent.level.value=p,n(h,a._logEvent,y),a._logEvent=Pc(m)}function Pc(a){return{ts:0,messages:[],bindings:a||[],level:{label:"",value:0}}}function ow(a){const t={type:a.constructor.name,msg:a.message,stack:a.stack};for(const i in a)t[i]===void 0&&(t[i]=a[i]);return t}function aw(a){return typeof a.timestamp=="function"?a.timestamp:a.timestamp===!1?gf:yf}function go(){return{}}function fc(a){return a}function en(){}function gf(){return!1}function yf(){return Date.now()}function cw(){return Math.round(Date.now()/1e3)}function uw(){return new Date(Date.now()).toISOString()}function hw(){function a(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return a(self)||a(window)||a(this)||{}}}const Oo=So(ew),lw={level:"info"},nn="custom_context";var fw=Object.defineProperty,pw=Object.defineProperties,dw=Object.getOwnPropertyDescriptors,nl=Object.getOwnPropertySymbols,gw=Object.prototype.hasOwnProperty,yw=Object.prototype.propertyIsEnumerable,ol=(a,t,i)=>t in a?fw(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,vw=(a,t)=>{for(var i in t||(t={}))gw.call(t,i)&&ol(a,i,t[i]);if(nl)for(var i of nl(t))yw.call(t,i)&&ol(a,i,t[i]);return a},mw=(a,t)=>pw(a,dw(t));function Co(a){return mw(vw({},a),{level:(a==null?void 0:a.level)||lw.level})}function ww(a,t=nn){return a[t]||""}function bw(a,t,i=nn){return a[i]=t,a}function cr(a,t=nn){let i="";return typeof a.bindings>"u"?i=ww(a,t):i=a.bindings().context||"",i}function _w(a,t,i=nn){const n=cr(a,i);return n.trim()?`${n}/${t}`:t}function ur(a,t,i=nn){const n=_w(a,t,i),o=a.child({context:n});return bw(o,n,i)}let Ew=class extends Ki{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}},Iw=class extends Ki{constructor(t,i){super(),this.core=t,this.logger=i,this.records=new Map}},xw=class{constructor(t,i){this.logger=t,this.core=i}},Pw=class extends Ki{constructor(t,i){super(),this.relayer=t,this.logger=i}},Sw=class extends Ki{constructor(t){super()}},Aw=class{constructor(t,i,n,o){this.core=t,this.logger=i,this.name=n}},Rw=class extends Ki{constructor(t,i){super(),this.relayer=t,this.logger=i}},Ow=class extends Ki{constructor(t,i){super(),this.core=t,this.logger=i}},Cw=class{constructor(t,i){this.projectId=t,this.logger=i}},Tw=class{constructor(t,i){this.projectId=t,this.logger=i}},$w=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Nw=class{constructor(t){this.client=t}};var Fc={},vf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var t=Sm,i=rf;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function y(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return y.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},y.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},y.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},y.prototype.update=function(m,g){if(g===void 0&&(g=m.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=m[E++],g--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(E=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,m,E,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=m[E++],g--;return this},y.prototype.finish=function(m){if(!this._finished){var g=this._bytesHashed,E=this._bufferLength,R=g/536870912|0,N=g<<3,q=g%128<112?128:256;this._buffer[E]=128;for(var C=E+1;C<q-8;C++)this._buffer[C]=0;t.writeUint32BE(R,this._buffer,q-8),t.writeUint32BE(N,this._buffer,q-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,q),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)t.writeUint32BE(this._stateHi[C],m,C*8),t.writeUint32BE(this._stateLo[C],m,C*8+4);return this},y.prototype.digest=function(){var m=new Uint8Array(this.digestLength);return this.finish(m),m},y.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},y.prototype.restoreState=function(m){return this._stateHi.set(m.stateHi),this._stateLo.set(m.stateLo),this._bufferLength=m.bufferLength,m.buffer&&this._buffer.set(m.buffer),this._bytesHashed=m.bytesHashed,this._finished=!1,this},y.prototype.cleanSavedState=function(m){i.wipe(m.stateHi),i.wipe(m.stateLo),m.buffer&&i.wipe(m.buffer),m.bufferLength=0,m.bytesHashed=0},y}();a.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(y,m,g,E,R,N,q){for(var C=g[0],Y=g[1],re=g[2],oe=g[3],ce=g[4],ae=g[5],ee=g[6],he=g[7],pe=E[0],Q=E[1],ve=E[2],wt=E[3],st=E[4],ke=E[5],jt=E[6],Lt=E[7],b,S,J,le,H,U,k,B;q>=128;){for(var Xe=0;Xe<16;Xe++){var nt=8*Xe+N;y[Xe]=t.readUint32BE(R,nt),m[Xe]=t.readUint32BE(R,nt+4)}for(var Xe=0;Xe<80;Xe++){var Ai=C,Ee=Y,Ar=re,D=oe,$=ce,O=ae,u=ee,I=he,Z=pe,ue=Q,me=ve,Ae=wt,Oe=st,Ie=ke,bt=jt,dt=Lt;if(b=he,S=Lt,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=(ce>>>14|st<<32-14)^(ce>>>18|st<<32-18)^(st>>>41-32|ce<<32-(41-32)),S=(st>>>14|ce<<32-14)^(st>>>18|ce<<32-18)^(ce>>>41-32|st<<32-(41-32)),H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,b=ce&ae^~ce&ee,S=st&ke^~st&jt,H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,b=o[Xe*2],S=o[Xe*2+1],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,b=y[Xe%16],S=m[Xe%16],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,J=k&65535|B<<16,le=H&65535|U<<16,b=J,S=le,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=(C>>>28|pe<<32-28)^(pe>>>34-32|C<<32-(34-32))^(pe>>>39-32|C<<32-(39-32)),S=(pe>>>28|C<<32-28)^(C>>>34-32|pe<<32-(34-32))^(C>>>39-32|pe<<32-(39-32)),H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,b=C&Y^C&re^Y&re,S=pe&Q^pe&ve^Q&ve,H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,I=k&65535|B<<16,dt=H&65535|U<<16,b=D,S=Ae,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=J,S=le,H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,D=k&65535|B<<16,Ae=H&65535|U<<16,Y=Ai,re=Ee,oe=Ar,ce=D,ae=$,ee=O,he=u,C=I,Q=Z,ve=ue,wt=me,st=Ae,ke=Oe,jt=Ie,Lt=bt,pe=dt,Xe%16===15)for(var nt=0;nt<16;nt++)b=y[nt],S=m[nt],H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=y[(nt+9)%16],S=m[(nt+9)%16],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,J=y[(nt+1)%16],le=m[(nt+1)%16],b=(J>>>1|le<<32-1)^(J>>>8|le<<32-8)^J>>>7,S=(le>>>1|J<<32-1)^(le>>>8|J<<32-8)^(le>>>7|J<<32-7),H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,J=y[(nt+14)%16],le=m[(nt+14)%16],b=(J>>>19|le<<32-19)^(le>>>61-32|J<<32-(61-32))^J>>>6,S=(le>>>19|J<<32-19)^(J>>>61-32|le<<32-(61-32))^(le>>>6|J<<32-6),H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,y[nt]=k&65535|B<<16,m[nt]=H&65535|U<<16}b=C,S=pe,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=g[0],S=E[0],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,g[0]=C=k&65535|B<<16,E[0]=pe=H&65535|U<<16,b=Y,S=Q,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=g[1],S=E[1],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,g[1]=Y=k&65535|B<<16,E[1]=Q=H&65535|U<<16,b=re,S=ve,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=g[2],S=E[2],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,g[2]=re=k&65535|B<<16,E[2]=ve=H&65535|U<<16,b=oe,S=wt,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=g[3],S=E[3],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,g[3]=oe=k&65535|B<<16,E[3]=wt=H&65535|U<<16,b=ce,S=st,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=g[4],S=E[4],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,g[4]=ce=k&65535|B<<16,E[4]=st=H&65535|U<<16,b=ae,S=ke,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=g[5],S=E[5],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,g[5]=ae=k&65535|B<<16,E[5]=ke=H&65535|U<<16,b=ee,S=jt,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=g[6],S=E[6],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,g[6]=ee=k&65535|B<<16,E[6]=jt=H&65535|U<<16,b=he,S=Lt,H=S&65535,U=S>>>16,k=b&65535,B=b>>>16,b=g[7],S=E[7],H+=S&65535,U+=S>>>16,k+=b&65535,B+=b>>>16,U+=H>>>16,k+=U>>>16,B+=k>>>16,g[7]=he=k&65535|B<<16,E[7]=Lt=H&65535|U<<16,N+=128,q-=128}return N}function p(y){var m=new n;m.update(y);var g=m.digest();return m.clean(),g}a.hash=p})(vf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const t=sf,i=vf,n=rf;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(D){const $=new Float64Array(16);if(D)for(let O=0;O<D.length;O++)$[O]=D[O];return $}const h=new Uint8Array(32);h[0]=9;const p=o(),y=o([1]),m=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),R=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),N=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function q(D,$){for(let O=0;O<16;O++)D[O]=$[O]|0}function C(D){let $=1;for(let O=0;O<16;O++){let u=D[O]+$+65535;$=Math.floor(u/65536),D[O]=u-$*65536}D[0]+=$-1+37*($-1)}function Y(D,$,O){const u=~(O-1);for(let I=0;I<16;I++){const Z=u&(D[I]^$[I]);D[I]^=Z,$[I]^=Z}}function re(D,$){const O=o(),u=o();for(let I=0;I<16;I++)u[I]=$[I];C(u),C(u),C(u);for(let I=0;I<2;I++){O[0]=u[0]-65517;for(let ue=1;ue<15;ue++)O[ue]=u[ue]-65535-(O[ue-1]>>16&1),O[ue-1]&=65535;O[15]=u[15]-32767-(O[14]>>16&1);const Z=O[15]>>16&1;O[14]&=65535,Y(u,O,1-Z)}for(let I=0;I<16;I++)D[2*I]=u[I]&255,D[2*I+1]=u[I]>>8}function oe(D,$){let O=0;for(let u=0;u<32;u++)O|=D[u]^$[u];return(1&O-1>>>8)-1}function ce(D,$){const O=new Uint8Array(32),u=new Uint8Array(32);return re(O,D),re(u,$),oe(O,u)}function ae(D){const $=new Uint8Array(32);return re($,D),$[0]&1}function ee(D,$){for(let O=0;O<16;O++)D[O]=$[2*O]+($[2*O+1]<<8);D[15]&=32767}function he(D,$,O){for(let u=0;u<16;u++)D[u]=$[u]+O[u]}function pe(D,$,O){for(let u=0;u<16;u++)D[u]=$[u]-O[u]}function Q(D,$,O){let u,I,Z=0,ue=0,me=0,Ae=0,Oe=0,Ie=0,bt=0,dt=0,et=0,Te=0,Be=0,Ke=0,tt=0,Fe=0,Ve=0,Re=0,je=0,ot=0,Ne=0,_t=0,Ct=0,Mt=0,zt=0,Nt=0,Gt=0,Xt=0,Lr=0,Wt=0,Vr=0,li=0,Ri=0,at=O[0],Je=O[1],ct=O[2],ut=O[3],rt=O[4],Qe=O[5],Et=O[6],It=O[7],ht=O[8],xt=O[9],lt=O[10],gt=O[11],ft=O[12],He=O[13],Pt=O[14],St=O[15];u=$[0],Z+=u*at,ue+=u*Je,me+=u*ct,Ae+=u*ut,Oe+=u*rt,Ie+=u*Qe,bt+=u*Et,dt+=u*It,et+=u*ht,Te+=u*xt,Be+=u*lt,Ke+=u*gt,tt+=u*ft,Fe+=u*He,Ve+=u*Pt,Re+=u*St,u=$[1],ue+=u*at,me+=u*Je,Ae+=u*ct,Oe+=u*ut,Ie+=u*rt,bt+=u*Qe,dt+=u*Et,et+=u*It,Te+=u*ht,Be+=u*xt,Ke+=u*lt,tt+=u*gt,Fe+=u*ft,Ve+=u*He,Re+=u*Pt,je+=u*St,u=$[2],me+=u*at,Ae+=u*Je,Oe+=u*ct,Ie+=u*ut,bt+=u*rt,dt+=u*Qe,et+=u*Et,Te+=u*It,Be+=u*ht,Ke+=u*xt,tt+=u*lt,Fe+=u*gt,Ve+=u*ft,Re+=u*He,je+=u*Pt,ot+=u*St,u=$[3],Ae+=u*at,Oe+=u*Je,Ie+=u*ct,bt+=u*ut,dt+=u*rt,et+=u*Qe,Te+=u*Et,Be+=u*It,Ke+=u*ht,tt+=u*xt,Fe+=u*lt,Ve+=u*gt,Re+=u*ft,je+=u*He,ot+=u*Pt,Ne+=u*St,u=$[4],Oe+=u*at,Ie+=u*Je,bt+=u*ct,dt+=u*ut,et+=u*rt,Te+=u*Qe,Be+=u*Et,Ke+=u*It,tt+=u*ht,Fe+=u*xt,Ve+=u*lt,Re+=u*gt,je+=u*ft,ot+=u*He,Ne+=u*Pt,_t+=u*St,u=$[5],Ie+=u*at,bt+=u*Je,dt+=u*ct,et+=u*ut,Te+=u*rt,Be+=u*Qe,Ke+=u*Et,tt+=u*It,Fe+=u*ht,Ve+=u*xt,Re+=u*lt,je+=u*gt,ot+=u*ft,Ne+=u*He,_t+=u*Pt,Ct+=u*St,u=$[6],bt+=u*at,dt+=u*Je,et+=u*ct,Te+=u*ut,Be+=u*rt,Ke+=u*Qe,tt+=u*Et,Fe+=u*It,Ve+=u*ht,Re+=u*xt,je+=u*lt,ot+=u*gt,Ne+=u*ft,_t+=u*He,Ct+=u*Pt,Mt+=u*St,u=$[7],dt+=u*at,et+=u*Je,Te+=u*ct,Be+=u*ut,Ke+=u*rt,tt+=u*Qe,Fe+=u*Et,Ve+=u*It,Re+=u*ht,je+=u*xt,ot+=u*lt,Ne+=u*gt,_t+=u*ft,Ct+=u*He,Mt+=u*Pt,zt+=u*St,u=$[8],et+=u*at,Te+=u*Je,Be+=u*ct,Ke+=u*ut,tt+=u*rt,Fe+=u*Qe,Ve+=u*Et,Re+=u*It,je+=u*ht,ot+=u*xt,Ne+=u*lt,_t+=u*gt,Ct+=u*ft,Mt+=u*He,zt+=u*Pt,Nt+=u*St,u=$[9],Te+=u*at,Be+=u*Je,Ke+=u*ct,tt+=u*ut,Fe+=u*rt,Ve+=u*Qe,Re+=u*Et,je+=u*It,ot+=u*ht,Ne+=u*xt,_t+=u*lt,Ct+=u*gt,Mt+=u*ft,zt+=u*He,Nt+=u*Pt,Gt+=u*St,u=$[10],Be+=u*at,Ke+=u*Je,tt+=u*ct,Fe+=u*ut,Ve+=u*rt,Re+=u*Qe,je+=u*Et,ot+=u*It,Ne+=u*ht,_t+=u*xt,Ct+=u*lt,Mt+=u*gt,zt+=u*ft,Nt+=u*He,Gt+=u*Pt,Xt+=u*St,u=$[11],Ke+=u*at,tt+=u*Je,Fe+=u*ct,Ve+=u*ut,Re+=u*rt,je+=u*Qe,ot+=u*Et,Ne+=u*It,_t+=u*ht,Ct+=u*xt,Mt+=u*lt,zt+=u*gt,Nt+=u*ft,Gt+=u*He,Xt+=u*Pt,Lr+=u*St,u=$[12],tt+=u*at,Fe+=u*Je,Ve+=u*ct,Re+=u*ut,je+=u*rt,ot+=u*Qe,Ne+=u*Et,_t+=u*It,Ct+=u*ht,Mt+=u*xt,zt+=u*lt,Nt+=u*gt,Gt+=u*ft,Xt+=u*He,Lr+=u*Pt,Wt+=u*St,u=$[13],Fe+=u*at,Ve+=u*Je,Re+=u*ct,je+=u*ut,ot+=u*rt,Ne+=u*Qe,_t+=u*Et,Ct+=u*It,Mt+=u*ht,zt+=u*xt,Nt+=u*lt,Gt+=u*gt,Xt+=u*ft,Lr+=u*He,Wt+=u*Pt,Vr+=u*St,u=$[14],Ve+=u*at,Re+=u*Je,je+=u*ct,ot+=u*ut,Ne+=u*rt,_t+=u*Qe,Ct+=u*Et,Mt+=u*It,zt+=u*ht,Nt+=u*xt,Gt+=u*lt,Xt+=u*gt,Lr+=u*ft,Wt+=u*He,Vr+=u*Pt,li+=u*St,u=$[15],Re+=u*at,je+=u*Je,ot+=u*ct,Ne+=u*ut,_t+=u*rt,Ct+=u*Qe,Mt+=u*Et,zt+=u*It,Nt+=u*ht,Gt+=u*xt,Xt+=u*lt,Lr+=u*gt,Wt+=u*ft,Vr+=u*He,li+=u*Pt,Ri+=u*St,Z+=38*je,ue+=38*ot,me+=38*Ne,Ae+=38*_t,Oe+=38*Ct,Ie+=38*Mt,bt+=38*zt,dt+=38*Nt,et+=38*Gt,Te+=38*Xt,Be+=38*Lr,Ke+=38*Wt,tt+=38*Vr,Fe+=38*li,Ve+=38*Ri,I=1,u=Z+I+65535,I=Math.floor(u/65536),Z=u-I*65536,u=ue+I+65535,I=Math.floor(u/65536),ue=u-I*65536,u=me+I+65535,I=Math.floor(u/65536),me=u-I*65536,u=Ae+I+65535,I=Math.floor(u/65536),Ae=u-I*65536,u=Oe+I+65535,I=Math.floor(u/65536),Oe=u-I*65536,u=Ie+I+65535,I=Math.floor(u/65536),Ie=u-I*65536,u=bt+I+65535,I=Math.floor(u/65536),bt=u-I*65536,u=dt+I+65535,I=Math.floor(u/65536),dt=u-I*65536,u=et+I+65535,I=Math.floor(u/65536),et=u-I*65536,u=Te+I+65535,I=Math.floor(u/65536),Te=u-I*65536,u=Be+I+65535,I=Math.floor(u/65536),Be=u-I*65536,u=Ke+I+65535,I=Math.floor(u/65536),Ke=u-I*65536,u=tt+I+65535,I=Math.floor(u/65536),tt=u-I*65536,u=Fe+I+65535,I=Math.floor(u/65536),Fe=u-I*65536,u=Ve+I+65535,I=Math.floor(u/65536),Ve=u-I*65536,u=Re+I+65535,I=Math.floor(u/65536),Re=u-I*65536,Z+=I-1+37*(I-1),I=1,u=Z+I+65535,I=Math.floor(u/65536),Z=u-I*65536,u=ue+I+65535,I=Math.floor(u/65536),ue=u-I*65536,u=me+I+65535,I=Math.floor(u/65536),me=u-I*65536,u=Ae+I+65535,I=Math.floor(u/65536),Ae=u-I*65536,u=Oe+I+65535,I=Math.floor(u/65536),Oe=u-I*65536,u=Ie+I+65535,I=Math.floor(u/65536),Ie=u-I*65536,u=bt+I+65535,I=Math.floor(u/65536),bt=u-I*65536,u=dt+I+65535,I=Math.floor(u/65536),dt=u-I*65536,u=et+I+65535,I=Math.floor(u/65536),et=u-I*65536,u=Te+I+65535,I=Math.floor(u/65536),Te=u-I*65536,u=Be+I+65535,I=Math.floor(u/65536),Be=u-I*65536,u=Ke+I+65535,I=Math.floor(u/65536),Ke=u-I*65536,u=tt+I+65535,I=Math.floor(u/65536),tt=u-I*65536,u=Fe+I+65535,I=Math.floor(u/65536),Fe=u-I*65536,u=Ve+I+65535,I=Math.floor(u/65536),Ve=u-I*65536,u=Re+I+65535,I=Math.floor(u/65536),Re=u-I*65536,Z+=I-1+37*(I-1),D[0]=Z,D[1]=ue,D[2]=me,D[3]=Ae,D[4]=Oe,D[5]=Ie,D[6]=bt,D[7]=dt,D[8]=et,D[9]=Te,D[10]=Be,D[11]=Ke,D[12]=tt,D[13]=Fe,D[14]=Ve,D[15]=Re}function ve(D,$){Q(D,$,$)}function wt(D,$){const O=o();let u;for(u=0;u<16;u++)O[u]=$[u];for(u=253;u>=0;u--)ve(O,O),u!==2&&u!==4&&Q(O,O,$);for(u=0;u<16;u++)D[u]=O[u]}function st(D,$){const O=o();let u;for(u=0;u<16;u++)O[u]=$[u];for(u=250;u>=0;u--)ve(O,O),u!==1&&Q(O,O,$);for(u=0;u<16;u++)D[u]=O[u]}function ke(D,$){const O=o(),u=o(),I=o(),Z=o(),ue=o(),me=o(),Ae=o(),Oe=o(),Ie=o();pe(O,D[1],D[0]),pe(Ie,$[1],$[0]),Q(O,O,Ie),he(u,D[0],D[1]),he(Ie,$[0],$[1]),Q(u,u,Ie),Q(I,D[3],$[3]),Q(I,I,g),Q(Z,D[2],$[2]),he(Z,Z,Z),pe(ue,u,O),pe(me,Z,I),he(Ae,Z,I),he(Oe,u,O),Q(D[0],ue,me),Q(D[1],Oe,Ae),Q(D[2],Ae,me),Q(D[3],ue,Oe)}function jt(D,$,O){for(let u=0;u<4;u++)Y(D[u],$[u],O)}function Lt(D,$){const O=o(),u=o(),I=o();wt(I,$[2]),Q(O,$[0],I),Q(u,$[1],I),re(D,u),D[31]^=ae(O)<<7}function b(D,$,O){q(D[0],p),q(D[1],y),q(D[2],y),q(D[3],p);for(let u=255;u>=0;--u){const I=O[u/8|0]>>(u&7)&1;jt(D,$,I),ke($,D),ke(D,D),jt(D,$,I)}}function S(D,$){const O=[o(),o(),o(),o()];q(O[0],E),q(O[1],R),q(O[2],y),Q(O[3],E,R),b(D,O,$)}function J(D){if(D.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const $=(0,i.hash)(D);$[0]&=248,$[31]&=127,$[31]|=64;const O=new Uint8Array(32),u=[o(),o(),o(),o()];S(u,$),Lt(O,u);const I=new Uint8Array(64);return I.set(D),I.set(O,32),{publicKey:O,secretKey:I}}a.generateKeyPairFromSeed=J;function le(D){const $=(0,t.randomBytes)(32,D),O=J($);return(0,n.wipe)($),O}a.generateKeyPair=le;function H(D){if(D.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}a.extractPublicKeyFromSecretKey=H;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k(D,$){let O,u,I,Z;for(u=63;u>=32;--u){for(O=0,I=u-32,Z=u-12;I<Z;++I)$[I]+=O-16*$[u]*U[I-(u-32)],O=Math.floor(($[I]+128)/256),$[I]-=O*256;$[I]+=O,$[u]=0}for(O=0,I=0;I<32;I++)$[I]+=O-($[31]>>4)*U[I],O=$[I]>>8,$[I]&=255;for(I=0;I<32;I++)$[I]-=O*U[I];for(u=0;u<32;u++)$[u+1]+=$[u]>>8,D[u]=$[u]&255}function B(D){const $=new Float64Array(64);for(let O=0;O<64;O++)$[O]=D[O];for(let O=0;O<64;O++)D[O]=0;k(D,$)}function Xe(D,$){const O=new Float64Array(64),u=[o(),o(),o(),o()],I=(0,i.hash)(D.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const Z=new Uint8Array(64);Z.set(I.subarray(32),32);const ue=new i.SHA512;ue.update(Z.subarray(32)),ue.update($);const me=ue.digest();ue.clean(),B(me),S(u,me),Lt(Z,u),ue.reset(),ue.update(Z.subarray(0,32)),ue.update(D.subarray(32)),ue.update($);const Ae=ue.digest();B(Ae);for(let Oe=0;Oe<32;Oe++)O[Oe]=me[Oe];for(let Oe=0;Oe<32;Oe++)for(let Ie=0;Ie<32;Ie++)O[Oe+Ie]+=Ae[Oe]*I[Ie];return k(Z.subarray(32),O),Z}a.sign=Xe;function nt(D,$){const O=o(),u=o(),I=o(),Z=o(),ue=o(),me=o(),Ae=o();return q(D[2],y),ee(D[1],$),ve(I,D[1]),Q(Z,I,m),pe(I,I,D[2]),he(Z,D[2],Z),ve(ue,Z),ve(me,ue),Q(Ae,me,ue),Q(O,Ae,I),Q(O,O,Z),st(O,O),Q(O,O,I),Q(O,O,Z),Q(O,O,Z),Q(D[0],O,Z),ve(u,D[0]),Q(u,u,Z),ce(u,I)&&Q(D[0],D[0],N),ve(u,D[0]),Q(u,u,Z),ce(u,I)?-1:(ae(D[0])===$[31]>>7&&pe(D[0],p,D[0]),Q(D[3],D[0],D[1]),0)}function Ai(D,$,O){const u=new Uint8Array(32),I=[o(),o(),o(),o()],Z=[o(),o(),o(),o()];if(O.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(nt(Z,D))return!1;const ue=new i.SHA512;ue.update(O.subarray(0,32)),ue.update(D),ue.update($);const me=ue.digest();return B(me),b(I,Z,me),S(Z,O.subarray(32)),ke(I,Z),Lt(u,I),!oe(O,u)}a.verify=Ai;function Ee(D){let $=[o(),o(),o(),o()];if(nt($,D))throw new Error("Ed25519: invalid public key");let O=o(),u=o(),I=$[1];he(O,y,I),pe(u,y,I),wt(u,u),Q(O,O,u);let Z=new Uint8Array(32);return re(Z,O),Z}a.convertPublicKeyToX25519=Ee;function Ar(D){const $=(0,i.hash)(D.subarray(0,32));$[0]&=248,$[31]&=127,$[31]|=64;const O=new Uint8Array($.subarray(0,32));return(0,n.wipe)($),O}a.convertSecretKeyToX25519=Ar})(Fc);const Dw="EdDSA",Fw="JWT",mf=".",wf="base64url",qw="utf8",jw="utf8",Lw=":",Mw="did",zw="key",al="base58btc",Uw="z",Hw="K36",kw=32;function Io(a){return Ao(Nc(ki(a),qw),wf)}function bf(a){const t=Nc(Hw,al),i=Uw+Ao(Am([t,a]),al);return[Mw,zw,i].join(Lw)}function Bw(a){return Ao(a,wf)}function Kw(a){return Nc([Io(a.header),Io(a.payload)].join(mf),jw)}function Vw(a){return[Io(a.header),Io(a.payload),Bw(a.signature)].join(mf)}function cl(a=sf.randomBytes(kw)){return Fc.generateKeyPairFromSeed(a)}async function Gw(a,t,i,n,o=te.fromMiliseconds(Date.now())){const h={alg:Dw,typ:Fw},p=bf(n.publicKey),y=o+i,m={iss:p,sub:a,aud:t,iat:o,exp:y},g=Kw({header:h,payload:m}),E=Fc.sign(n.secretKey,g);return Vw({header:h,payload:m,signature:E})}const Ww="PARSE_ERROR",Jw="INVALID_REQUEST",Qw="METHOD_NOT_FOUND",Yw="INVALID_PARAMS",_f="INTERNAL_ERROR",qc="SERVER_ERROR",Zw=[-32700,-32600,-32601,-32602,-32603],Ys={[Ww]:{code:-32700,message:"Parse error"},[Jw]:{code:-32600,message:"Invalid Request"},[Qw]:{code:-32601,message:"Method not found"},[Yw]:{code:-32602,message:"Invalid params"},[_f]:{code:-32603,message:"Internal error"},[qc]:{code:-32e3,message:"Server error"}},Ef=qc;function Xw(a){return Zw.includes(a)}function ul(a){return Object.keys(Ys).includes(a)?Ys[a]:Ys[Ef]}function eb(a){const t=Object.values(Ys).find(i=>i.code===a);return t||Ys[Ef]}function If(a,t,i){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${t}`):a}var xf={},si={},hl;function tb(){if(hl)return si;hl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowserCryptoAvailable=si.getSubtleCrypto=si.getBrowerCrypto=void 0;function a(){return(jr===null||jr===void 0?void 0:jr.crypto)||(jr===null||jr===void 0?void 0:jr.msCrypto)||{}}si.getBrowerCrypto=a;function t(){const n=a();return n.subtle||n.webkitSubtle}si.getSubtleCrypto=t;function i(){return!!a()&&!!t()}return si.isBrowserCryptoAvailable=i,si}var ni={},ll;function rb(){if(ll)return ni;ll=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowser=ni.isNode=ni.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ni.isReactNative=a;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ni.isNode=t;function i(){return!a()&&!t()}return ni.isBrowser=i,ni}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=tn;t.__exportStar(tb(),a),t.__exportStar(rb(),a)})(xf);function jc(a=3){const t=Date.now()*Math.pow(10,a),i=Math.floor(Math.random()*Math.pow(10,a));return t+i}function Pf(a=6){return BigInt(jc(a))}function ws(a,t,i){return{id:i||jc(),jsonrpc:"2.0",method:a,params:t}}function To(a,t){return{id:a,jsonrpc:"2.0",result:t}}function $o(a,t,i){return{id:a,jsonrpc:"2.0",error:ib(t,i)}}function ib(a,t){return typeof a>"u"?ul(_f):(typeof a=="string"&&(a=Object.assign(Object.assign({},ul(qc)),{message:a})),typeof t<"u"&&(a.data=t),Xw(a.code)&&(a=eb(a.code)),a)}class sb{}class nb extends sb{constructor(){super()}}class ob extends nb{constructor(t){super()}}const ab="^https?:",cb="^wss?:";function ub(a){const t=a.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Sf(a,t){const i=ub(a);return typeof i>"u"?!1:new RegExp(t).test(i)}function fl(a){return Sf(a,ab)}function pl(a){return Sf(a,cb)}function hb(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Af(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Lc(a){return Af(a)&&"method"in a}function No(a){return Af(a)&&(ci(a)||qr(a))}function ci(a){return"result"in a}function qr(a){return"error"in a}class ui extends ob{constructor(t){super(t),this.events=new Sr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async request(t,i){return this.requestStrict(ws(t.method,t.params||[],t.id||Pf().toString()),i)}async requestStrict(t,i){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${t.id}`,h=>{qr(h)?o(h.error):n(h.result)});try{await this.connection.send(t,i)}catch(h){o(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),No(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const lb=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),fb=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",dl=a=>a.split("?")[0],gl=10,pb=lb();let db=class{constructor(t){if(this.url=t,this.events=new Sr.EventEmitter,this.registering=!1,!pl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ki(t))}catch(i){this.onError(t.id,i)}}register(t=this.url){if(!pl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((i,n)=>{const o=new URLSearchParams(t).get("origin"),h=xf.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!hb(t)},p=new pb(t,[],h);fb()?p.onerror=y=>{const m=y;n(this.emitError(m.error))}:p.on("error",y=>{n(this.emitError(y))}),p.onopen=()=>{this.onOpen(p),i(p)}})}onOpen(t){t.onmessage=i=>this.onPayload(i),t.onclose=i=>this.onClose(i),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const i=typeof t.data=="string"?sn(t.data):t.data;this.events.emit("payload",i)}onError(t,i){const n=this.parseError(i),o=n.message||n.toString(),h=$o(t,o);this.events.emit("payload",h)}parseError(t,i=this.url){return If(t,dl(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>gl&&this.events.setMaxListeners(gl)}emitError(t){const i=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${dl(this.url)}`));return this.events.emit("register_error",i),i}};var xo={exports:{}};xo.exports;(function(a,t){var i=200,n="__lodash_hash_undefined__",o=1,h=2,p=9007199254740991,y="[object Arguments]",m="[object Array]",g="[object AsyncFunction]",E="[object Boolean]",R="[object Date]",N="[object Error]",q="[object Function]",C="[object GeneratorFunction]",Y="[object Map]",re="[object Number]",oe="[object Null]",ce="[object Object]",ae="[object Promise]",ee="[object Proxy]",he="[object RegExp]",pe="[object Set]",Q="[object String]",ve="[object Symbol]",wt="[object Undefined]",st="[object WeakMap]",ke="[object ArrayBuffer]",jt="[object DataView]",Lt="[object Float32Array]",b="[object Float64Array]",S="[object Int8Array]",J="[object Int16Array]",le="[object Int32Array]",H="[object Uint8Array]",U="[object Uint8ClampedArray]",k="[object Uint16Array]",B="[object Uint32Array]",Xe=/[\\^$.*+?()[\]{}|]/g,nt=/^\[object .+?Constructor\]$/,Ai=/^(?:0|[1-9]\d*)$/,Ee={};Ee[Lt]=Ee[b]=Ee[S]=Ee[J]=Ee[le]=Ee[H]=Ee[U]=Ee[k]=Ee[B]=!0,Ee[y]=Ee[m]=Ee[ke]=Ee[E]=Ee[jt]=Ee[R]=Ee[N]=Ee[q]=Ee[Y]=Ee[re]=Ee[ce]=Ee[he]=Ee[pe]=Ee[Q]=Ee[st]=!1;var Ar=typeof jr=="object"&&jr&&jr.Object===Object&&jr,D=typeof self=="object"&&self&&self.Object===Object&&self,$=Ar||D||Function("return this")(),O=t&&!t.nodeType&&t,u=O&&!0&&a&&!a.nodeType&&a,I=u&&u.exports===O,Z=I&&Ar.process,ue=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),me=ue&&ue.isTypedArray;function Ae(v,x){for(var M=-1,V=v==null?0:v.length,Me=0,de=[];++M<V;){var Ge=v[M];x(Ge,M,v)&&(de[Me++]=Ge)}return de}function Oe(v,x){for(var M=-1,V=x.length,Me=v.length;++M<V;)v[Me+M]=x[M];return v}function Ie(v,x){for(var M=-1,V=v==null?0:v.length;++M<V;)if(x(v[M],M,v))return!0;return!1}function bt(v,x){for(var M=-1,V=Array(v);++M<v;)V[M]=x(M);return V}function dt(v){return function(x){return v(x)}}function et(v,x){return v.has(x)}function Te(v,x){return v==null?void 0:v[x]}function Be(v){var x=-1,M=Array(v.size);return v.forEach(function(V,Me){M[++x]=[Me,V]}),M}function Ke(v,x){return function(M){return v(x(M))}}function tt(v){var x=-1,M=Array(v.size);return v.forEach(function(V){M[++x]=V}),M}var Fe=Array.prototype,Ve=Function.prototype,Re=Object.prototype,je=$["__core-js_shared__"],ot=Ve.toString,Ne=Re.hasOwnProperty,_t=function(){var v=/[^.]+$/.exec(je&&je.keys&&je.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Ct=Re.toString,Mt=RegExp("^"+ot.call(Ne).replace(Xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zt=I?$.Buffer:void 0,Nt=$.Symbol,Gt=$.Uint8Array,Xt=Re.propertyIsEnumerable,Lr=Fe.splice,Wt=Nt?Nt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,li=zt?zt.isBuffer:void 0,Ri=Ke(Object.keys,Object),at=hr($,"DataView"),Je=hr($,"Map"),ct=hr($,"Promise"),ut=hr($,"Set"),rt=hr($,"WeakMap"),Qe=hr(Object,"create"),Et=Wr(at),It=Wr(Je),ht=Wr(ct),xt=Wr(ut),lt=Wr(rt),gt=Nt?Nt.prototype:void 0,ft=gt?gt.valueOf:void 0;function He(v){var x=-1,M=v==null?0:v.length;for(this.clear();++x<M;){var V=v[x];this.set(V[0],V[1])}}function Pt(){this.__data__=Qe?Qe(null):{},this.size=0}function St(v){var x=this.has(v)&&delete this.__data__[v];return this.size-=x?1:0,x}function qo(v){var x=this.__data__;if(Qe){var M=x[v];return M===n?void 0:M}return Ne.call(x,v)?x[v]:void 0}function jo(v){var x=this.__data__;return Qe?x[v]!==void 0:Ne.call(x,v)}function Lo(v,x){var M=this.__data__;return this.size+=this.has(v)?0:1,M[v]=Qe&&x===void 0?n:x,this}He.prototype.clear=Pt,He.prototype.delete=St,He.prototype.get=qo,He.prototype.has=jo,He.prototype.set=Lo;function yr(v){var x=-1,M=v==null?0:v.length;for(this.clear();++x<M;){var V=v[x];this.set(V[0],V[1])}}function Mo(){this.__data__=[],this.size=0}function zo(v){var x=this.__data__,M=Oi(x,v);if(M<0)return!1;var V=x.length-1;return M==V?x.pop():Lr.call(x,M,1),--this.size,!0}function Uo(v){var x=this.__data__,M=Oi(x,v);return M<0?void 0:x[M][1]}function Ho(v){return Oi(this.__data__,v)>-1}function ko(v,x){var M=this.__data__,V=Oi(M,v);return V<0?(++this.size,M.push([v,x])):M[V][1]=x,this}yr.prototype.clear=Mo,yr.prototype.delete=zo,yr.prototype.get=Uo,yr.prototype.has=Ho,yr.prototype.set=ko;function Gr(v){var x=-1,M=v==null?0:v.length;for(this.clear();++x<M;){var V=v[x];this.set(V[0],V[1])}}function Gi(){this.size=0,this.__data__={hash:new He,map:new(Je||yr),string:new He}}function Bo(v){var x=fi(this,v).delete(v);return this.size-=x?1:0,x}function Wi(v){return fi(this,v).get(v)}function Ko(v){return fi(this,v).has(v)}function Vo(v,x){var M=fi(this,v),V=M.size;return M.set(v,x),this.size+=M.size==V?0:1,this}Gr.prototype.clear=Gi,Gr.prototype.delete=Bo,Gr.prototype.get=Wi,Gr.prototype.has=Ko,Gr.prototype.set=Vo;function Ji(v){var x=-1,M=v==null?0:v.length;for(this.__data__=new Gr;++x<M;)this.add(v[x])}function an(v){return this.__data__.set(v,n),this}function cn(v){return this.__data__.has(v)}Ji.prototype.add=Ji.prototype.push=an,Ji.prototype.has=cn;function Rr(v){var x=this.__data__=new yr(v);this.size=x.size}function Go(){this.__data__=new yr,this.size=0}function Wo(v){var x=this.__data__,M=x.delete(v);return this.size=x.size,M}function Jo(v){return this.__data__.get(v)}function Qo(v){return this.__data__.has(v)}function un(v,x){var M=this.__data__;if(M instanceof yr){var V=M.__data__;if(!Je||V.length<i-1)return V.push([v,x]),this.size=++M.size,this;M=this.__data__=new Gr(V)}return M.set(v,x),this.size=M.size,this}Rr.prototype.clear=Go,Rr.prototype.delete=Wo,Rr.prototype.get=Jo,Rr.prototype.has=Qo,Rr.prototype.set=un;function hn(v,x){var M=Zi(v),V=!M&&En(v),Me=!M&&!V&&xs(v),de=!M&&!V&&!Me&&Pn(v),Ge=M||V||Me||de,At=Ge?bt(v.length,String):[],Pe=At.length;for(var ze in v)(x||Ne.call(v,ze))&&!(Ge&&(ze=="length"||Me&&(ze=="offset"||ze=="parent")||de&&(ze=="buffer"||ze=="byteLength"||ze=="byteOffset")||vn(ze,Pe)))&&At.push(ze);return At}function Oi(v,x){for(var M=v.length;M--;)if(_n(v[M][0],x))return M;return-1}function Es(v,x,M){var V=x(v);return Zi(v)?V:Oe(V,M(v))}function Ci(v){return v==null?v===void 0?wt:oe:Wt&&Wt in Object(v)?gn(v):Xo(v)}function Is(v){return $i(v)&&Ci(v)==y}function Ti(v,x,M,V,Me){return v===x?!0:v==null||x==null||!$i(v)&&!$i(x)?v!==v&&x!==x:ln(v,x,M,V,Ti,Me)}function ln(v,x,M,V,Me,de){var Ge=Zi(v),At=Zi(x),Pe=Ge?m:Mr(v),ze=At?m:Mr(x);Pe=Pe==y?ce:Pe,ze=ze==y?ce:ze;var yt=Pe==ce,er=ze==ce,Rt=Pe==ze;if(Rt&&xs(v)){if(!xs(x))return!1;Ge=!0,yt=!1}if(Rt&&!yt)return de||(de=new Rr),Ge||Pn(v)?Qi(v,x,M,V,Me,de):Zo(v,x,Pe,M,V,Me,de);if(!(M&o)){var We=yt&&Ne.call(v,"__wrapped__"),Jt=er&&Ne.call(x,"__wrapped__");if(We||Jt){var Or=We?v.value():v,vr=Jt?x.value():x;return de||(de=new Rr),Me(Or,vr,M,V,de)}}return Rt?(de||(de=new Rr),dn(v,x,M,V,Me,de)):!1}function Yo(v){if(!xn(v)||wn(v))return!1;var x=Xi(v)?Mt:nt;return x.test(Wr(v))}function fn(v){return $i(v)&&In(v.length)&&!!Ee[Ci(v)]}function pn(v){if(!bn(v))return Ri(v);var x=[];for(var M in Object(v))Ne.call(v,M)&&M!="constructor"&&x.push(M);return x}function Qi(v,x,M,V,Me,de){var Ge=M&o,At=v.length,Pe=x.length;if(At!=Pe&&!(Ge&&Pe>At))return!1;var ze=de.get(v);if(ze&&de.get(x))return ze==x;var yt=-1,er=!0,Rt=M&h?new Ji:void 0;for(de.set(v,x),de.set(x,v);++yt<At;){var We=v[yt],Jt=x[yt];if(V)var Or=Ge?V(Jt,We,yt,x,v,de):V(We,Jt,yt,v,x,de);if(Or!==void 0){if(Or)continue;er=!1;break}if(Rt){if(!Ie(x,function(vr,zr){if(!et(Rt,zr)&&(We===vr||Me(We,vr,M,V,de)))return Rt.push(zr)})){er=!1;break}}else if(!(We===Jt||Me(We,Jt,M,V,de))){er=!1;break}}return de.delete(v),de.delete(x),er}function Zo(v,x,M,V,Me,de,Ge){switch(M){case jt:if(v.byteLength!=x.byteLength||v.byteOffset!=x.byteOffset)return!1;v=v.buffer,x=x.buffer;case ke:return!(v.byteLength!=x.byteLength||!de(new Gt(v),new Gt(x)));case E:case R:case re:return _n(+v,+x);case N:return v.name==x.name&&v.message==x.message;case he:case Q:return v==x+"";case Y:var At=Be;case pe:var Pe=V&o;if(At||(At=tt),v.size!=x.size&&!Pe)return!1;var ze=Ge.get(v);if(ze)return ze==x;V|=h,Ge.set(v,x);var yt=Qi(At(v),At(x),V,Me,de,Ge);return Ge.delete(v),yt;case ve:if(ft)return ft.call(v)==ft.call(x)}return!1}function dn(v,x,M,V,Me,de){var Ge=M&o,At=Yi(v),Pe=At.length,ze=Yi(x),yt=ze.length;if(Pe!=yt&&!Ge)return!1;for(var er=Pe;er--;){var Rt=At[er];if(!(Ge?Rt in x:Ne.call(x,Rt)))return!1}var We=de.get(v);if(We&&de.get(x))return We==x;var Jt=!0;de.set(v,x),de.set(x,v);for(var Or=Ge;++er<Pe;){Rt=At[er];var vr=v[Rt],zr=x[Rt];if(V)var Ps=Ge?V(zr,vr,Rt,x,v,de):V(vr,zr,Rt,v,x,de);if(!(Ps===void 0?vr===zr||Me(vr,zr,M,V,de):Ps)){Jt=!1;break}Or||(Or=Rt=="constructor")}if(Jt&&!Or){var Ni=v.constructor,Dt=x.constructor;Ni!=Dt&&"constructor"in v&&"constructor"in x&&!(typeof Ni=="function"&&Ni instanceof Ni&&typeof Dt=="function"&&Dt instanceof Dt)&&(Jt=!1)}return de.delete(v),de.delete(x),Jt}function Yi(v){return Es(v,ra,yn)}function fi(v,x){var M=v.__data__;return mn(x)?M[typeof x=="string"?"string":"hash"]:M.map}function hr(v,x){var M=Te(v,x);return Yo(M)?M:void 0}function gn(v){var x=Ne.call(v,Wt),M=v[Wt];try{v[Wt]=void 0;var V=!0}catch{}var Me=Ct.call(v);return V&&(x?v[Wt]=M:delete v[Wt]),Me}var yn=Vr?function(v){return v==null?[]:(v=Object(v),Ae(Vr(v),function(x){return Xt.call(v,x)}))}:Le,Mr=Ci;(at&&Mr(new at(new ArrayBuffer(1)))!=jt||Je&&Mr(new Je)!=Y||ct&&Mr(ct.resolve())!=ae||ut&&Mr(new ut)!=pe||rt&&Mr(new rt)!=st)&&(Mr=function(v){var x=Ci(v),M=x==ce?v.constructor:void 0,V=M?Wr(M):"";if(V)switch(V){case Et:return jt;case It:return Y;case ht:return ae;case xt:return pe;case lt:return st}return x});function vn(v,x){return x=x??p,!!x&&(typeof v=="number"||Ai.test(v))&&v>-1&&v%1==0&&v<x}function mn(v){var x=typeof v;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?v!=="__proto__":v===null}function wn(v){return!!_t&&_t in v}function bn(v){var x=v&&v.constructor,M=typeof x=="function"&&x.prototype||Re;return v===M}function Xo(v){return Ct.call(v)}function Wr(v){if(v!=null){try{return ot.call(v)}catch{}try{return v+""}catch{}}return""}function _n(v,x){return v===x||v!==v&&x!==x}var En=Is(function(){return arguments}())?Is:function(v){return $i(v)&&Ne.call(v,"callee")&&!Xt.call(v,"callee")},Zi=Array.isArray;function ea(v){return v!=null&&In(v.length)&&!Xi(v)}var xs=li||qe;function ta(v,x){return Ti(v,x)}function Xi(v){if(!xn(v))return!1;var x=Ci(v);return x==q||x==C||x==g||x==ee}function In(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=p}function xn(v){var x=typeof v;return v!=null&&(x=="object"||x=="function")}function $i(v){return v!=null&&typeof v=="object"}var Pn=me?dt(me):fn;function ra(v){return ea(v)?hn(v):pn(v)}function Le(){return[]}function qe(){return!1}a.exports=ta})(xo,xo.exports);var gb=xo.exports;const yb=So(gb);function vb(a,t){return t=t||{},new Promise(function(i,n){var o=new XMLHttpRequest,h=[],p=[],y={},m=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:m,headers:{keys:function(){return h},entries:function(){return p},get:function(E){return y[E.toLowerCase()]},has:function(E){return E.toLowerCase()in y}}}};for(var g in o.open(t.method||"get",a,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(E,R,N){h.push(R=R.toLowerCase()),p.push([R,N]),y[R]=y[R]?y[R]+","+N:N}),i(m())},o.onerror=n,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(g,t.headers[g]);o.send(t.body||null)})}const mb=Object.freeze(Object.defineProperty({__proto__:null,default:vb},Symbol.toStringTag,{value:"Module"})),yl=tf(mb);var wb=self.fetch||(self.fetch=yl.default||yl);const bb=So(wb);function _b(a,t){if(a.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),n=0;n<i.length;n++)i[n]=255;for(var o=0;o<a.length;o++){var h=a.charAt(o),p=h.charCodeAt(0);if(i[p]!==255)throw new TypeError(h+" is ambiguous");i[p]=o}var y=a.length,m=a.charAt(0),g=Math.log(y)/Math.log(256),E=Math.log(256)/Math.log(y);function R(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var Y=0,re=0,oe=0,ce=C.length;oe!==ce&&C[oe]===0;)oe++,Y++;for(var ae=(ce-oe)*E+1>>>0,ee=new Uint8Array(ae);oe!==ce;){for(var he=C[oe],pe=0,Q=ae-1;(he!==0||pe<re)&&Q!==-1;Q--,pe++)he+=256*ee[Q]>>>0,ee[Q]=he%y>>>0,he=he/y>>>0;if(he!==0)throw new Error("Non-zero carry");re=pe,oe++}for(var ve=ae-re;ve!==ae&&ee[ve]===0;)ve++;for(var wt=m.repeat(Y);ve<ae;++ve)wt+=a.charAt(ee[ve]);return wt}function N(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var Y=0;if(C[Y]!==" "){for(var re=0,oe=0;C[Y]===m;)re++,Y++;for(var ce=(C.length-Y)*g+1>>>0,ae=new Uint8Array(ce);C[Y];){var ee=i[C.charCodeAt(Y)];if(ee===255)return;for(var he=0,pe=ce-1;(ee!==0||he<oe)&&pe!==-1;pe--,he++)ee+=y*ae[pe]>>>0,ae[pe]=ee%256>>>0,ee=ee/256>>>0;if(ee!==0)throw new Error("Non-zero carry");oe=he,Y++}if(C[Y]!==" "){for(var Q=ce-oe;Q!==ce&&ae[Q]===0;)Q++;for(var ve=new Uint8Array(re+(ce-Q)),wt=re;Q!==ce;)ve[wt++]=ae[Q++];return ve}}}function q(C){var Y=N(C);if(Y)return Y;throw new Error(`Non-${t} character`)}return{encode:R,decodeUnsafe:N,decode:q}}var Eb=_b,Ib=Eb;const Rf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},xb=a=>new TextEncoder().encode(a),Pb=a=>new TextDecoder().decode(a);class Sb{constructor(t,i,n){this.name=t,this.prefix=i,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Ab{constructor(t,i,n){if(this.name=t,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Of(this,t)}}class Rb{constructor(t){this.decoders=t}or(t){return Of(this,t)}decode(t){const i=t[0],n=this.decoders[i];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Of=(a,t)=>new Rb({...a.decoders||{[a.prefix]:a},...t.decoders||{[t.prefix]:t}});class Ob{constructor(t,i,n,o){this.name=t,this.prefix=i,this.baseEncode=n,this.baseDecode=o,this.encoder=new Sb(t,i,n),this.decoder=new Ab(t,i,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Do=({name:a,prefix:t,encode:i,decode:n})=>new Ob(a,t,i,n),on=({prefix:a,name:t,alphabet:i})=>{const{encode:n,decode:o}=Ib(i,t);return Do({prefix:a,name:t,encode:n,decode:h=>Rf(o(h))})},Cb=(a,t,i,n)=>{const o={};for(let E=0;E<t.length;++E)o[t[E]]=E;let h=a.length;for(;a[h-1]==="=";)--h;const p=new Uint8Array(h*i/8|0);let y=0,m=0,g=0;for(let E=0;E<h;++E){const R=o[a[E]];if(R===void 0)throw new SyntaxError(`Non-${n} character`);m=m<<i|R,y+=i,y>=8&&(y-=8,p[g++]=255&m>>y)}if(y>=i||255&m<<8-y)throw new SyntaxError("Unexpected end of data");return p},Tb=(a,t,i)=>{const n=t[t.length-1]==="=",o=(1<<i)-1;let h="",p=0,y=0;for(let m=0;m<a.length;++m)for(y=y<<8|a[m],p+=8;p>i;)p-=i,h+=t[o&y>>p];if(p&&(h+=t[o&y<<i-p]),n)for(;h.length*i&7;)h+="=";return h},Ht=({name:a,prefix:t,bitsPerChar:i,alphabet:n})=>Do({prefix:t,name:a,encode(o){return Tb(o,n,i)},decode(o){return Cb(o,n,i,a)}}),$b=Do({prefix:"\0",name:"identity",encode:a=>Pb(a),decode:a=>xb(a)});var Nb=Object.freeze({__proto__:null,identity:$b});const Db=Ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Fb=Object.freeze({__proto__:null,base2:Db});const qb=Ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var jb=Object.freeze({__proto__:null,base8:qb});const Lb=on({prefix:"9",name:"base10",alphabet:"0123456789"});var Mb=Object.freeze({__proto__:null,base10:Lb});const zb=Ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ub=Ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Hb=Object.freeze({__proto__:null,base16:zb,base16upper:Ub});const kb=Ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Bb=Ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Kb=Ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Vb=Ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Gb=Ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Wb=Ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Jb=Ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Qb=Ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Yb=Ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Zb=Object.freeze({__proto__:null,base32:kb,base32upper:Bb,base32pad:Kb,base32padupper:Vb,base32hex:Gb,base32hexupper:Wb,base32hexpad:Jb,base32hexpadupper:Qb,base32z:Yb});const Xb=on({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),e_=on({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var t_=Object.freeze({__proto__:null,base36:Xb,base36upper:e_});const r_=on({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),i_=on({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var s_=Object.freeze({__proto__:null,base58btc:r_,base58flickr:i_});const n_=Ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),o_=Ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),a_=Ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),c_=Ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var u_=Object.freeze({__proto__:null,base64:n_,base64pad:o_,base64url:a_,base64urlpad:c_});const Cf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),h_=Cf.reduce((a,t,i)=>(a[i]=t,a),[]),l_=Cf.reduce((a,t,i)=>(a[t.codePointAt(0)]=i,a),[]);function f_(a){return a.reduce((t,i)=>(t+=h_[i],t),"")}function p_(a){const t=[];for(const i of a){const n=l_[i.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${i}`);t.push(n)}return new Uint8Array(t)}const d_=Do({prefix:"🚀",name:"base256emoji",encode:f_,decode:p_});var g_=Object.freeze({__proto__:null,base256emoji:d_}),y_=Tf,vl=128,v_=127,m_=~v_,w_=Math.pow(2,31);function Tf(a,t,i){t=t||[],i=i||0;for(var n=i;a>=w_;)t[i++]=a&255|vl,a/=128;for(;a&m_;)t[i++]=a&255|vl,a>>>=7;return t[i]=a|0,Tf.bytes=i-n+1,t}var b_=Sc,__=128,ml=127;function Sc(a,n){var i=0,n=n||0,o=0,h=n,p,y=a.length;do{if(h>=y)throw Sc.bytes=0,new RangeError("Could not decode varint");p=a[h++],i+=o<28?(p&ml)<<o:(p&ml)*Math.pow(2,o),o+=7}while(p>=__);return Sc.bytes=h-n,i}var E_=Math.pow(2,7),I_=Math.pow(2,14),x_=Math.pow(2,21),P_=Math.pow(2,28),S_=Math.pow(2,35),A_=Math.pow(2,42),R_=Math.pow(2,49),O_=Math.pow(2,56),C_=Math.pow(2,63),T_=function(a){return a<E_?1:a<I_?2:a<x_?3:a<P_?4:a<S_?5:a<A_?6:a<R_?7:a<O_?8:a<C_?9:10},$_={encode:y_,decode:b_,encodingLength:T_},$f=$_;const wl=(a,t,i=0)=>($f.encode(a,t,i),t),bl=a=>$f.encodingLength(a),Ac=(a,t)=>{const i=t.byteLength,n=bl(a),o=n+bl(i),h=new Uint8Array(o+i);return wl(a,h,0),wl(i,h,n),h.set(t,o),new N_(a,i,t,h)};class N_{constructor(t,i,n,o){this.code=t,this.size=i,this.digest=n,this.bytes=o}}const Nf=({name:a,code:t,encode:i})=>new D_(a,t,i);class D_{constructor(t,i,n){this.name=t,this.code=i,this.encode=n}digest(t){if(t instanceof Uint8Array){const i=this.encode(t);return i instanceof Uint8Array?Ac(this.code,i):i.then(n=>Ac(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Df=a=>async t=>new Uint8Array(await crypto.subtle.digest(a,t)),F_=Nf({name:"sha2-256",code:18,encode:Df("SHA-256")}),q_=Nf({name:"sha2-512",code:19,encode:Df("SHA-512")});var j_=Object.freeze({__proto__:null,sha256:F_,sha512:q_});const Ff=0,L_="identity",qf=Rf,M_=a=>Ac(Ff,qf(a)),z_={code:Ff,name:L_,encode:qf,digest:M_};var U_=Object.freeze({__proto__:null,identity:z_});new TextEncoder,new TextDecoder;const _l={...Nb,...Fb,...jb,...Mb,...Hb,...Zb,...t_,...s_,...u_,...g_};({...j_,...U_});function jf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function H_(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?jf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Lf(a,t,i,n){return{name:a,prefix:t,encoder:{name:a,prefix:t,encode:i},decoder:{decode:n}}}const El=Lf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),pc=Lf("ascii","a",a=>{let t="a";for(let i=0;i<a.length;i++)t+=String.fromCharCode(a[i]);return t},a=>{a=a.substring(1);const t=H_(a.length);for(let i=0;i<a.length;i++)t[i]=a.charCodeAt(i);return t}),k_={utf8:El,"utf-8":El,hex:_l.base16,latin1:pc,ascii:pc,binary:pc,..._l};function B_(a,t="utf8"){const i=k_[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?jf(globalThis.Buffer.from(a,"utf-8")):i.decoder.decode(`${i.prefix}${a}`)}const Mf="wc",K_=2,Mc="core",xi=`${Mf}@2:${Mc}:`,V_={name:Mc,logger:"error"},G_={database:":memory:"},W_="crypto",Il="client_ed25519_seed",J_=te.ONE_DAY,Q_="keychain",Y_="0.3",Z_="messages",X_="0.3",eE=te.SIX_HOURS,tE="publisher",zf="irn",rE="error",Uf="wss://relay.walletconnect.com",xl="wss://relay.walletconnect.org",iE="relayer",Vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},sE="_subscription",oi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},nE=te.ONE_SECOND,oE="2.11.0",aE=1e4,cE="0.3",uE="WALLETCONNECT_CLIENT_ID",Dr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},hE="subscription",lE="0.3",fE=te.FIVE_SECONDS*1e3,pE="pairing",dE="0.3",ks={wc_pairingDelete:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:te.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:te.ONE_DAY,prompt:!1,tag:0},res:{ttl:te.ONE_DAY,prompt:!1,tag:0}}},Js={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Br={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},gE="history",yE="0.3",vE="expirer",Pr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},mE="0.3",dc="verify-api",vs="https://verify.walletconnect.com",Rc="https://verify.walletconnect.org",wE=[vs,Rc],bE="echo",_E="https://echo.walletconnect.com";class EE{constructor(t,i){this.core=t,this.logger=i,this.keychain=new Map,this.name=Q_,this.version=Y_,this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:h}=G("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=ur(i,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,cf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?uf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class IE{constructor(t,i,n){this.core=t,this.logger=i,this.name=W_,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=cl(o);return bf(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Cm();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),p=cl(h),y=Ec();return await Gw(y,o,J_,p)},this.generateSharedKey=(o,h,p)=>{this.isInitialized();const y=this.getPrivateKey(o),m=Tm(y,h);return this.setSymKey(m,p)},this.setSymKey=async(o,h)=>{this.isInitialized();const p=h||$m(o);return await this.keychain.set(p,o),p},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,p)=>{this.isInitialized();const y=Nm(p),m=ki(h);if(kh(y)){const N=y.senderPublicKey,q=y.receiverPublicKey;o=await this.generateSharedKey(N,q)}const g=this.getSymKey(o),{type:E,senderPublicKey:R}=y;return Dm({type:E,symKey:g,message:m,senderPublicKey:R})},this.decode=async(o,h,p)=>{this.isInitialized();const y=Fm(h,p);if(kh(y)){const m=y.receiverPublicKey,g=y.senderPublicKey;o=await this.generateSharedKey(m,g)}try{const m=this.getSymKey(o),g=qm({symKey:m,encoded:h});return sn(g)}catch(m){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(m)}},this.getPayloadType=o=>{const h=Bh(o);return jm(h.type)},this.getPayloadSenderPublicKey=o=>{const h=Bh(o);return h.senderPublicKey?Ao(h.senderPublicKey,Lm):void 0},this.core=t,this.logger=ur(i,this.name),this.keychain=n||new EE(this.core,this.logger)}get context(){return cr(this.logger)}async setPrivateKey(t,i){return await this.keychain.set(t,i),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Il)}catch{t=Ec(),await this.keychain.set(Il,t)}return B_(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class xE extends xw{constructor(t,i){super(t,i),this.logger=t,this.core=i,this.messages=new Map,this.name=Z_,this.version=X_,this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const h=ms(o);let p=this.messages.get(n);return typeof p>"u"&&(p={}),typeof p[h]<"u"||(p[h]=o,this.messages.set(n,p),await this.persist()),h},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const h=this.get(n),p=ms(o);return typeof h[p]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=ur(t,this.name),this.core=i}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,cf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?uf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class PE extends Pw{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.events=new Sr.EventEmitter,this.name=tE,this.queue=new Map,this.publishTimeout=te.toMiliseconds(te.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,h)=>{var p;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}});try{const y=(h==null?void 0:h.ttl)||eE,m=Ic(h),g=(h==null?void 0:h.prompt)||!1,E=(h==null?void 0:h.tag)||0,R=(h==null?void 0:h.id)||Pf().toString(),N={topic:n,message:o,opts:{ttl:y,relay:m,prompt:g,tag:E,id:R}},q=setTimeout(()=>this.queue.set(R,N),this.publishTimeout);try{await await Zs(this.rpcPublish(n,o,y,m,g,E,R),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(R),this.relayer.events.emit(Vt.publish,N)}catch(C){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(p=h==null?void 0:h.internal)!=null&&p.throwOnFailedPublish)throw this.removeRequestFromQueue(R),C;return}finally{clearTimeout(q)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}})}catch(y){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(y),y}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=t,this.logger=ur(i,this.name),this.registerEventListeners()}get context(){return cr(this.logger)}rpcPublish(t,i,n,o,h,p,y){var m,g,E,R;const N={method:wo(o.protocol).publish,params:{topic:t,message:i,ttl:n,prompt:h,tag:p},id:y};return Ii((m=N.params)==null?void 0:m.prompt)&&((g=N.params)==null||delete g.prompt),Ii((E=N.params)==null?void 0:E.tag)&&((R=N.params)==null||delete R.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:N}),this.relayer.request(N)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:i,message:n,opts:o}=t;await this.publish(i,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(_s.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Vt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class SE{constructor(){this.map=new Map,this.set=(t,i)=>{const n=this.get(t);this.exists(t,i)||this.map.set(t,[...n,i])},this.get=t=>this.map.get(t)||[],this.exists=(t,i)=>this.get(t).includes(i),this.delete=(t,i)=>{if(typeof i>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,i))return;const o=n.filter(h=>h!==i);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var AE=Object.defineProperty,RE=Object.defineProperties,OE=Object.getOwnPropertyDescriptors,Pl=Object.getOwnPropertySymbols,CE=Object.prototype.hasOwnProperty,TE=Object.prototype.propertyIsEnumerable,Sl=(a,t,i)=>t in a?AE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Bs=(a,t)=>{for(var i in t||(t={}))CE.call(t,i)&&Sl(a,i,t[i]);if(Pl)for(var i of Pl(t))TE.call(t,i)&&Sl(a,i,t[i]);return a},gc=(a,t)=>RE(a,OE(t));class $E extends Rw{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.subscriptions=new Map,this.topicMap=new SE,this.events=new Sr.EventEmitter,this.name=hE,this.version=lE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=xi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const h=Ic(o),p={topic:n,relay:h};this.pending.set(n,p);const y=await this.rpcSubscribe(n,h);return this.onSubscribe(y,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),y}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,h)=>{const p=new te.Watch;p.start(this.pendingSubscriptionWatchLabel);const y=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(y),p.stop(this.pendingSubscriptionWatchLabel),o(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=fE&&(clearInterval(y),p.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=ur(i,this.name),this.clientId=""}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,i){let n=!1;try{n=this.getSubscription(t).topic===i}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,i){const n=this.topicMap.get(t);await Promise.all(n.map(async o=>await this.unsubscribeById(t,o,i)))}async unsubscribeById(t,i,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:n}});try{const o=Ic(n);await this.rpcUnsubscribe(t,i,o);const h=Kt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,i){const n={method:wo(i.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Zs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Vt.connection_stalled)}return ms(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const i=t[0].relay,n={method:wo(i.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Zs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Vt.connection_stalled)}}rpcUnsubscribe(t,i,n){const o={method:wo(n.protocol).unsubscribe,params:{topic:t,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,i){this.setSubscription(t,gc(Bs({},i),{id:t})),this.pending.delete(i.topic)}onBatchSubscribe(t){t.length&&t.forEach(i=>{this.setSubscription(i.id,Bs({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(t,i,n){this.events.removeAllListeners(i),this.hasSubscription(i,t)&&this.deleteSubscription(i,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,i){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:i}),this.addSubscription(t,i))}addSubscription(t,i){this.subscriptions.set(t,Bs({},i)),this.topicMap.set(i.topic,t),this.events.emit(Dr.created,i)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const i=this.subscriptions.get(t);if(!i){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return i}deleteSubscription(t,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:i});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(Dr.deleted,gc(Bs({},n),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Dr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<t;i++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Dr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:i}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const i=await this.rpcBatchSubscribe(t);bs(i)&&this.onBatchSubscribe(i.map((n,o)=>gc(Bs({},t[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(i=>{t.push(i)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(_s.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Vt.connect,async()=>{await this.onConnect()}),this.relayer.on(Vt.disconnect,()=>{this.onDisconnect()}),this.events.on(Dr.created,async t=>{const i=Dr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()}),this.events.on(Dr.deleted,async t=>{const i=Dr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),t())},this.pollingInterval)})}}var NE=Object.defineProperty,Al=Object.getOwnPropertySymbols,DE=Object.prototype.hasOwnProperty,FE=Object.prototype.propertyIsEnumerable,Rl=(a,t,i)=>t in a?NE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,qE=(a,t)=>{for(var i in t||(t={}))DE.call(t,i)&&Rl(a,i,t[i]);if(Al)for(var i of Al(t))FE.call(t,i)&&Rl(a,i,t[i]);return a};class jE extends Sw{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Sr.EventEmitter,this.name=iE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=i=>{this.onProviderPayload(i)},this.onConnectHandler=()=>{this.events.emit(Vt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=i=>{this.logger.error(i),this.events.emit(Vt.error,i),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(oi.payload,this.onPayloadHandler),this.provider.on(oi.connect,this.onConnectHandler),this.provider.on(oi.disconnect,this.onDisconnectHandler),this.provider.on(oi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?ur(t.logger,this.name):Oo(Co({level:t.logger||rE})),this.messages=new xE(this.logger,t.core),this.subscriber=new $E(this,this.logger),this.publisher=new PE(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Uf,this.projectId=t.projectId,this.bundleId=Mm(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${xl}...`),await this.restartTransport(xl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},aE)}get context(){return cr(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,i,n){this.isInitialized(),await this.publisher.publish(t,i,n),await this.recordMessageEvent({topic:t,message:i,publishedAt:Date.now()})}async subscribe(t,i){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(o)return o;let h;const p=y=>{y.topic===t&&(this.subscriber.off(Dr.created,p),h())};return await Promise.all([new Promise(y=>{h=y,this.subscriber.on(Dr.created,p)}),new Promise(async y=>{o=await this.subscriber.subscribe(t,i),y()})]),o}async unsubscribe(t,i){this.isInitialized(),await this.subscriber.unsubscribe(t,i)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Zs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(i=>{if(!this.initialized)return i();this.subscriber.once(Dr.resubscribed,()=>{i()})}),new Promise(async(i,n)=>{try{await Zs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}i()})])}catch(i){this.logger.error(i);const n=i;if(!this.isConnectionStalled(n.message))throw i;this.provider.events.emit(oi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Kh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(i=>t.includes(i))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ui(new db(zm({sdkVersion:oE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:i,message:n}=t;await this.messages.set(i,n)}async shouldIgnoreMessageEvent(t){const{topic:i,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(i))return this.logger.debug(`Ignoring message for non-subscribed topic ${i}`),!0;const o=this.messages.has(i,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Lc(t)){if(!t.method.endsWith(sE))return;const i=t.params,{topic:n,message:o,publishedAt:h}=i.data,p={topic:n,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(qE({type:"event",event:i.id},p)),this.events.emit(i.id,p),await this.acknowledgePayload(t),await this.onMessageEvent(p)}else No(t)&&this.events.emit(Vt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Vt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const i=To(t.id,!0);await this.provider.connection.send(i)}unregisterProviderListeners(){this.provider.off(oi.payload,this.onPayloadHandler),this.provider.off(oi.connect,this.onConnectHandler),this.provider.off(oi.disconnect,this.onDisconnectHandler),this.provider.off(oi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Vt.connection_stalled,()=>{this.restartTransport().catch(i=>this.logger.error(i))});let t=await Kh();Um(async i=>{this.initialized&&t!==i&&(t=i,i?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Vt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},te.toMiliseconds(nE)))}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var LE=Object.defineProperty,Ol=Object.getOwnPropertySymbols,ME=Object.prototype.hasOwnProperty,zE=Object.prototype.propertyIsEnumerable,Cl=(a,t,i)=>t in a?LE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Tl=(a,t)=>{for(var i in t||(t={}))ME.call(t,i)&&Cl(a,i,t[i]);if(Ol)for(var i of Ol(t))zE.call(t,i)&&Cl(a,i,t[i]);return a};class Fo extends Aw{constructor(t,i,n,o=xi,h=void 0){super(t,i,n,o),this.core=t,this.logger=i,this.name=n,this.map=new Map,this.version=cE,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!Ii(p)?this.map.set(this.getKey(p),p):Rm(p)?this.map.set(p.id,p):Om(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,y)=>{this.isInitialized(),this.map.has(p)?await this.update(p,y):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:y}),this.map.set(p,y),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(y=>Object.keys(p).every(m=>yb(y[m],p[m]))):this.values),this.update=async(p,y)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:y});const m=Tl(Tl({},this.getData(p)),y);this.map.set(p,m),await this.persist()},this.delete=async(p,y)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:y}),this.map.delete(p),await this.persist())},this.logger=ur(i,this.name),this.storagePrefix=o,this.getKey=h}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const i=this.map.get(t);if(!i){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:i}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class UE{constructor(t,i){this.core=t,this.logger=i,this.name=pE,this.version=dE,this.events=new Dc,this.initialized=!1,this.storagePrefix=xi,this.ignoredPayloadTypes=[nf],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Ec(),o=await this.core.crypto.setSymKey(n),h=Fr(te.FIVE_MINUTES),p={protocol:zf},y={topic:o,expiry:h,relay:p,active:!1},m=Hm({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:p});return await this.pairings.set(o,y),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:m}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:h,relay:p}=Vh(n.uri);let y;if(this.pairings.keys.includes(o)&&(y=this.pairings.get(o),y.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const m=Fr(te.FIVE_MINUTES),g={topic:o,relay:p,expiry:m,active:!1};return await this.pairings.set(o,g),this.core.expirer.set(o,m),n.activatePairing&&await this.activate({topic:o}),this.events.emit(Js.create,g),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:p})),g},this.activate=async({topic:n})=>{this.isInitialized();const o=Fr(te.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:p,resolve:y,reject:m}=gs();this.events.once(Ot("pairing_ping",h),({error:g})=>{g?m(g):y()}),await p()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Kt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,h)=>{const p=ws(o,h),y=await this.core.crypto.encode(n,p),m=ks[o].req;return this.core.history.set(n,p),this.core.relayer.publish(n,y,m),p.id},this.sendResult=async(n,o,h)=>{const p=To(n,h),y=await this.core.crypto.encode(o,p),m=await this.core.history.get(o,n),g=ks[m.request.method].res;await this.core.relayer.publish(o,y,g),await this.core.history.resolve(p)},this.sendError=async(n,o,h)=>{const p=$o(n,h),y=await this.core.crypto.encode(o,p),m=await this.core.history.get(o,n),g=ks[m.request.method]?ks[m.request.method].res:ks.unregistered_method.res;await this.core.relayer.publish(o,y,g),await this.core.history.resolve(p)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Kt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>Ei(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:h}=n;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:h}=n,p=(await this.core.history.get(o,h.id)).request.method;switch(p){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(n,o)=>{const{id:h}=o;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit(Js.ping,{id:h,topic:n})}catch(p){await this.sendError(h,n,p),this.logger.error(p)}},this.onPairingPingResponse=(n,o)=>{const{id:h}=o;setTimeout(()=>{ci(o)?this.events.emit(Ot("pairing_ping",h),{}):qr(o)&&this.events.emit(Ot("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Js.delete,{id:h,topic:n})}catch(p){await this.sendError(h,n,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:h,method:p}=o;try{if(this.registeredMethods.includes(p))return;const y=Kt("WC_METHOD_UNSUPPORTED",p);await this.sendError(h,n,y),this.logger.error(y)}catch(y){await this.sendError(h,n,y),this.logger.error(y)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Kt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var o;if(!ar(n)){const{message:p}=G("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(p)}if(!km(n.uri)){const{message:p}=G("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(p)}const h=Vh(n.uri);if(!((o=h==null?void 0:h.relay)!=null&&o.protocol)){const{message:p}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(p)}if(!(h!=null&&h.symKey)){const{message:p}=G("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(p)}},this.isValidPing=async n=>{if(!ar(n)){const{message:h}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ar(n)){const{message:h}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!ys(n,!1)){const{message:o}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(Ei(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=G("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=t,this.logger=ur(i,this.name),this.pairings=new Fo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return cr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Vt.message,async t=>{const{topic:i,message:n}=t;if(!this.pairings.keys.includes(i)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(i,n);try{Lc(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):No(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Pr.expired,async t=>{const{topic:i}=of(t.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit(Js.expire,{topic:i}))})}}class HE extends Iw{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.records=new Map,this.events=new Sr.EventEmitter,this.name=gE,this.version=yE,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:h}),this.records.has(o.id))return;const p={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:h,expiry:Fr(te.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(Br.created,p)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=qr(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Br.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===n){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(Br.deleted,h)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=ur(i,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const n={topic:i.topic,request:ws(i.request.method,i.request.params,i.id),chainId:i.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const i=this.records.get(t);if(!i){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Br.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:i}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Br.created,t=>{const i=Br.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(Br.updated,t=>{const i=Br.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(Br.deleted,t=>{const i=Br.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.core.heartbeat.on(_s.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{te.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class kE extends Ow{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.expirations=new Map,this.events=new Sr.EventEmitter,this.name=vE,this.version=mE,this.cached=[],this.initialized=!1,this.storagePrefix=xi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const h=this.formatTarget(n),p={target:h,expiry:o};this.expirations.set(h,p),this.checkExpiry(h,p),this.events.emit(Pr.created,{target:h,expiration:p})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Pr.deleted,{target:o,expiration:h})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=ur(i,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Bm(t);if(typeof t=="number")return Km(t);const{message:i}=G("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(i)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Pr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:i}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const i=this.expirations.get(t);if(!i){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return i}checkExpiry(t,i){const{expiry:n}=i;te.toMiliseconds(n)-Date.now()<=0&&this.expire(t,i)}expire(t,i){this.expirations.delete(t),this.events.emit(Pr.expired,{target:t,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,i)=>this.checkExpiry(i,t))}registerEventListeners(){this.core.heartbeat.on(_s.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Pr.created,t=>{const i=Pr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Pr.expired,t=>{const i=Pr.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Pr.deleted,t=>{const i=Pr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class BE extends Cw{constructor(t,i){super(t,i),this.projectId=t,this.logger=i,this.name=dc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||Vm()||!af())return;const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Rc;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let h;try{h=await this.fetchAttestation(n.attestationId,o)}catch(p){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.info(p),h=await this.fetchAttestation(n.attestationId,Rc)}return h},this.fetchAttestation=async(n,o)=>{this.logger.info(`resolving attestation: ${n} from url: ${o}`);const h=this.startAbortTimer(te.ONE_SECOND*2),p=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(h),p.status===200?await p.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(h=>{if(document.getElementById(dc))return h();window.addEventListener("message",o);const p=document.createElement("iframe");p.id=dc,p.src=`${this.verifyUrl}/${this.projectId}`,p.style.display="none",document.body.append(p),this.iframe=p,n=h}),new Promise((h,p)=>setTimeout(()=>{window.removeEventListener("message",o),p("verify iframe load timeout")},te.toMiliseconds(te.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let o=n||vs;return wE.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${vs}`),o=vs),o},this.logger=ur(i,this.name),this.verifyUrl=vs,this.abortController=new AbortController,this.isDevEnv=Gm()&&{}.IS_VITEST}get context(){return cr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),te.toMiliseconds(t))}}class KE extends Tw{constructor(t,i){super(t,i),this.projectId=t,this.logger=i,this.context=bE,this.registerDeviceToken=async n=>{const{clientId:o,token:h,notificationType:p,enableEncrypted:y=!1}=n,m=`${_E}/${this.projectId}/clients`;await bb(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:p,token:h,always_raw:y})})},this.logger=ur(i,this.context)}}var VE=Object.defineProperty,$l=Object.getOwnPropertySymbols,GE=Object.prototype.hasOwnProperty,WE=Object.prototype.propertyIsEnumerable,Nl=(a,t,i)=>t in a?VE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Dl=(a,t)=>{for(var i in t||(t={}))GE.call(t,i)&&Nl(a,i,t[i]);if($l)for(var i of $l(t))WE.call(t,i)&&Nl(a,i,t[i]);return a};class zc extends Ew{constructor(t){super(t),this.protocol=Mf,this.version=K_,this.name=Mc,this.events=new Sr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Uf,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Oo(Co({level:(t==null?void 0:t.logger)||V_.logger}));this.logger=ur(i,this.name),this.heartbeat=new _s.HeartBeat,this.crypto=new IE(this,this.logger,t==null?void 0:t.keychain),this.history=new HE(this,this.logger),this.expirer=new kE(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new K1(Dl(Dl({},G_),t==null?void 0:t.storageOptions)),this.relayer=new jE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new UE(this,this.logger),this.verify=new BE(this.projectId||"",this.logger),this.echoClient=new KE(this.projectId||"",this.logger)}static async init(t){const i=new zc(t);await i.initialize();const n=await i.crypto.getClientId();return await i.storage.setItem(uE,n),i}get context(){return cr(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const JE=zc,Hf="wc",kf=2,Bf="client",Uc=`${Hf}@${kf}:${Bf}:`,yc={name:Bf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Fl="WALLETCONNECT_DEEPLINK_CHOICE",QE="proposal",Kf="Proposal expired",YE="session",yo=te.SEVEN_DAYS,ZE="engine",Ks={wc_sessionPropose:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1104},res:{ttl:te.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1106},res:{ttl:te.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1112},res:{ttl:te.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1115}}},vc={min:te.FIVE_MINUTES,max:te.SEVEN_DAYS},ai={idle:"IDLE",active:"ACTIVE"},XE="request",eI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var tI=Object.defineProperty,rI=Object.defineProperties,iI=Object.getOwnPropertyDescriptors,ql=Object.getOwnPropertySymbols,sI=Object.prototype.hasOwnProperty,nI=Object.prototype.propertyIsEnumerable,jl=(a,t,i)=>t in a?tI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,nr=(a,t)=>{for(var i in t||(t={}))sI.call(t,i)&&jl(a,i,t[i]);if(ql)for(var i of ql(t))nI.call(t,i)&&jl(a,i,t[i]);return a},Vs=(a,t)=>rI(a,iI(t));class oI extends Nw{constructor(t){super(t),this.name=ZE,this.events=new Dc,this.initialized=!1,this.ignoredPayloadTypes=[nf],this.requestQueue={state:ai.idle,queue:[]},this.sessionRequestQueue={state:ai.idle,queue:[]},this.requestQueueDelay=te.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Ks)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},te.toMiliseconds(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();const n=Vs(nr({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:p,sessionProperties:y,relays:m}=n;let g=o,E,R=!1;if(g&&(R=this.client.core.pairing.pairings.get(g).active),!g||!R){const{topic:ae,uri:ee}=await this.client.core.pairing.create();g=ae,E=ee}const N=await this.client.core.crypto.generateKeyPair(),q=nr({requiredNamespaces:h,optionalNamespaces:p,relays:m??[{protocol:zf}],proposer:{publicKey:N,metadata:this.client.metadata}},y&&{sessionProperties:y}),{reject:C,resolve:Y,done:re}=gs(te.FIVE_MINUTES,Kf);if(this.events.once(Ot("session_connect"),async({error:ae,session:ee})=>{if(ae)C(ae);else if(ee){ee.self.publicKey=N;const he=Vs(nr({},ee),{requiredNamespaces:ee.requiredNamespaces,optionalNamespaces:ee.optionalNamespaces});await this.client.session.set(ee.topic,he),await this.setExpiry(ee.topic,ee.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:ee.peer.metadata}),Y(he)}}),!g){const{message:ae}=G("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(ae)}const oe=await this.sendRequest({topic:g,method:"wc_sessionPropose",params:q}),ce=Fr(te.FIVE_MINUTES);return await this.setProposal(oe,nr({id:oe,expiry:ce},q)),{uri:E,approval:re}},this.pair=async i=>(await this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{await this.isInitialized(),await this.isValidApprove(i);const{id:n,relayProtocol:o,namespaces:h,sessionProperties:p}=i,y=this.client.proposal.get(n);let{pairingTopic:m,proposer:g,requiredNamespaces:E,optionalNamespaces:R}=y;m=m||"",bo(E)||(E=Jm(h,"approve()"));const N=await this.client.core.crypto.generateKeyPair(),q=g.publicKey,C=await this.client.core.crypto.generateSharedKey(N,q);m&&n&&(await this.client.core.pairing.updateMetadata({topic:m,metadata:g.metadata}),await this.sendResult({id:n,topic:m,result:{relay:{protocol:o??"irn"},responderPublicKey:N}}),await this.client.proposal.delete(n,Kt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:m}));const Y=nr({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:E,optionalNamespaces:R,pairingTopic:m,controller:{publicKey:N,metadata:this.client.metadata},expiry:Fr(yo)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(C),await this.sendRequest({topic:C,method:"wc_sessionSettle",params:Y,throwOnFailedPublish:!0});const re=Vs(nr({},Y),{topic:C,pairingTopic:m,acknowledged:!1,self:Y.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:N});return await this.client.session.set(C,re),await this.setExpiry(C,Fr(yo)),{topic:C,acknowledged:()=>new Promise(oe=>setTimeout(()=>oe(this.client.session.get(C)),500))}},this.reject=async i=>{await this.isInitialized(),await this.isValidReject(i);const{id:n,reason:o}=i,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,o),await this.client.proposal.delete(n,Kt("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized(),await this.isValidUpdate(i);const{topic:n,namespaces:o}=i,h=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:p,resolve:y,reject:m}=gs();return this.events.once(Ot("session_update",h),({error:g})=>{g?m(g):y()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:p}},this.extend=async i=>{await this.isInitialized(),await this.isValidExtend(i);const{topic:n}=i,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:h,resolve:p,reject:y}=gs();return this.events.once(Ot("session_extend",o),({error:m})=>{m?y(m):p()}),await this.setExpiry(n,Fr(yo)),{acknowledged:h}},this.request=async i=>{await this.isInitialized(),await this.isValidRequest(i);const{chainId:n,request:o,topic:h,expiry:p}=i,y=jc(),{done:m,resolve:g,reject:E}=gs(p,"Request expired. Please try again.");return this.events.once(Ot("session_request",y),({error:R,result:N})=>{R?E(R):g(N)}),await Promise.all([new Promise(async R=>{await this.sendRequest({clientRpcId:y,topic:h,method:"wc_sessionRequest",params:{request:o,chainId:n},expiry:p,throwOnFailedPublish:!0}).catch(N=>E(N)),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:n,id:y}),R()}),new Promise(async R=>{const N=await Qm(this.client.core.storage,Fl);Ym({id:y,topic:h,wcDeepLink:N}),R()}),m()]).then(R=>R[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);const{topic:n,response:o}=i,{id:h}=o;ci(o)?await this.sendResult({id:h,topic:n,result:o.result,throwOnFailedPublish:!0}):qr(o)&&await this.sendError(h,n,o.error),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:h,resolve:p,reject:y}=gs();this.events.once(Ot("session_ping",o),({error:m})=>{m?y(m):p()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);const{topic:n,event:o,chainId:h}=i;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:h}})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Kt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(n=>Zm(n,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const n=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var p,y;return((p=h.peerMetadata)==null?void 0:p.url)&&((y=h.peerMetadata)==null?void 0:y.url)===i.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(i,n)=>{const{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,Kt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),n||this.client.core.expirer.del(i),this.client.core.storage.removeItem(Fl).catch(h=>this.client.logger.warn(h)),this.getPendingSessionRequests().forEach(h=>{h.topic===i&&this.deletePendingSessionRequest(h.id,Kt("USER_DISCONNECTED"))})},this.deleteProposal=async(i,n)=>{await Promise.all([this.client.proposal.delete(i,Kt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,n),o?Promise.resolve():this.client.core.expirer.del(i)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==i),o&&(this.sessionRequestQueue.state=ai.idle)},this.setExpiry=async(i,n)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:n}),this.client.core.expirer.set(i,n)},this.setProposal=async(i,n)=>{await this.client.proposal.set(i,n),this.client.core.expirer.set(i,n.expiry)},this.setPendingSessionRequest=async i=>{const n=Ks.wc_sessionRequest.req.ttl,{id:o,topic:h,params:p,verifyContext:y}=i;await this.client.pendingRequest.set(o,{id:o,topic:h,params:p,verifyContext:y}),n&&this.client.core.expirer.set(o,Fr(n))},this.sendRequest=async i=>{const{topic:n,method:o,params:h,expiry:p,relayRpcId:y,clientRpcId:m,throwOnFailedPublish:g}=i,E=ws(o,h,m);if(af()&&eI.includes(o)){const q=ms(JSON.stringify(E));this.client.core.verify.register({attestationId:q})}const R=await this.client.core.crypto.encode(n,E),N=Ks[o].req;return p&&(N.ttl=p),y&&(N.id=y),this.client.core.history.set(n,E),g?(N.internal=Vs(nr({},N.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,R,N)):this.client.core.relayer.publish(n,R,N).catch(q=>this.client.logger.error(q)),E.id},this.sendResult=async i=>{const{id:n,topic:o,result:h,throwOnFailedPublish:p}=i,y=To(n,h),m=await this.client.core.crypto.encode(o,y),g=await this.client.core.history.get(o,n),E=Ks[g.request.method].res;p?(E.internal=Vs(nr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,m,E)):this.client.core.relayer.publish(o,m,E).catch(R=>this.client.logger.error(R)),await this.client.core.history.resolve(y)},this.sendError=async(i,n,o)=>{const h=$o(i,o),p=await this.client.core.crypto.encode(n,h),y=await this.client.core.history.get(n,i),m=Ks[y.request.method].res;this.client.core.relayer.publish(n,p,m),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],n=[];this.client.session.getAll().forEach(o=>{Ei(o.expiry)&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ei(o.expiry)&&n.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ai.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ai.active;const i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ai.idle},this.processRequest=i=>{const{topic:n,payload:o}=i,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:o}=i,h=(await this.client.core.history.get(n,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:n}=i,{message:o}=G("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,n)=>{const{params:o,id:h}=n;try{this.isValidConnect(nr({},n.params));const p=Fr(te.FIVE_MINUTES),y=nr({id:h,pairingTopic:i,expiry:p},o);await this.setProposal(h,y);const m=ms(JSON.stringify(n)),g=await this.getVerifyContext(m,y.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:y,verifyContext:g})}catch(p){await this.sendError(h,i,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(i,n)=>{const{id:o}=n;if(ci(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const p=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const y=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:y});const m=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:m});const g=await this.client.core.crypto.generateSharedKey(y,m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const E=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:i})}else qr(n)&&(await this.client.proposal.delete(o,Kt("USER_DISCONNECTED")),this.events.emit(Ot("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:p,controller:y,expiry:m,namespaces:g,requiredNamespaces:E,optionalNamespaces:R,sessionProperties:N,pairingTopic:q}=n.params,C=nr({topic:i,relay:p,expiry:m,namespaces:g,acknowledged:!0,pairingTopic:q,requiredNamespaces:E,optionalNamespaces:R,controller:y.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:y.publicKey,metadata:y.metadata}},N&&{sessionProperties:N});await this.sendResult({id:n.id,topic:i,result:!0}),this.events.emit(Ot("session_connect"),{session:C}),this.cleanupDuplicatePairings(C)}catch(p){await this.sendError(o,i,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(i,n)=>{const{id:o}=n;ci(n)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(Ot("session_approve",o),{})):qr(n)&&(await this.client.session.delete(i,Kt("USER_DISCONNECTED")),this.events.emit(Ot("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(i,n)=>{const{params:o,id:h}=n;try{const p=`${i}_session_update`,y=lo.get(p);if(y&&this.isRequestOutOfSync(y,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(nr({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult({id:h,topic:i,result:!0}),this.client.events.emit("session_update",{id:h,topic:i,params:o}),lo.set(p,h)}catch(p){await this.sendError(h,i,p),this.client.logger.error(p)}},this.isRequestOutOfSync=(i,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,n)=>{const{id:o}=n;ci(n)?this.events.emit(Ot("session_update",o),{}):qr(n)&&this.events.emit(Ot("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(i,n)=>{const{id:o}=n;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Fr(yo)),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_extend",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,n)=>{const{id:o}=n;ci(n)?this.events.emit(Ot("session_extend",o),{}):qr(n)&&this.events.emit(Ot("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(i,n)=>{const{id:o}=n;try{this.isValidPing({topic:i}),await this.sendResult({id:o,topic:i,result:!0}),this.client.events.emit("session_ping",{id:o,topic:i})}catch(h){await this.sendError(o,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,n)=>{const{id:o}=n;setTimeout(()=>{ci(n)?this.events.emit(Ot("session_ping",o),{}):qr(n)&&this.events.emit(Ot("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(i,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:i,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Vt.publish,async()=>{h(await this.deleteSession(i))})}),this.sendResult({id:o,topic:i,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,n)=>{const{id:o,params:h}=n;try{this.isValidRequest(nr({topic:i},h));const p=ms(JSON.stringify(ws("wc_sessionRequest",h,o))),y=this.client.session.get(i),m=await this.getVerifyContext(p,y.peer.metadata),g={id:o,topic:i,params:h,verifyContext:m};await this.setPendingSessionRequest(g),this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue()}catch(p){await this.sendError(o,i,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(i,n)=>{const{id:o}=n;ci(n)?this.events.emit(Ot("session_request",o),{result:n.result}):qr(n)&&this.events.emit(Ot("session_request",o),{error:n.error})},this.onSessionEventRequest=async(i,n)=>{const{id:o,params:h}=n;try{const p=`${i}_session_event_${h.event.name}`,y=lo.get(p);if(y&&this.isRequestOutOfSync(y,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(nr({topic:i},h)),this.client.events.emit("session_event",{id:o,topic:i,params:h}),lo.set(p,o)}catch(p){await this.sendError(o,i,p),this.client.logger.error(p)}},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ai.idle,this.processSessionRequestQueue()},te.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ai.active){this.client.logger.info("session request queue is already active.");return}const i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ai.active,this.client.events.emit("session_request",i)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=i=>{if(i.active)return;const n=this.client.proposal.getAll().find(o=>o.pairingTopic===i.topic);n&&this.onSessionProposeRequest(i.topic,ws("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async i=>{if(!ar(i)){const{message:m}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(m)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:p,relays:y}=i;if(Ii(n)||await this.isValidPairingTopic(n),!Xm(y,!0)){const{message:m}=G("MISSING_OR_INVALID",`connect() relays: ${y}`);throw new Error(m)}!Ii(o)&&bo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Ii(h)&&bo(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),Ii(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(i,n)=>{const o=e1(i,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!ar(i))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:n,namespaces:o,relayProtocol:h,sessionProperties:p}=i;await this.isValidProposalId(n);const y=this.client.proposal.get(n),m=oc(o,"approve()");if(m)throw new Error(m.message);const g=Gh(y.requiredNamespaces,o,"approve()");if(g)throw new Error(g.message);if(!ys(h,!0)){const{message:E}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(E)}Ii(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async i=>{if(!ar(i)){const{message:h}=G("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:n,reason:o}=i;if(await this.isValidProposalId(n),!t1(o)){const{message:h}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!ar(i)){const{message:g}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(g)}const{relay:n,controller:o,namespaces:h,expiry:p}=i;if(!r1(n)){const{message:g}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const y=i1(o,"onSessionSettleRequest()");if(y)throw new Error(y.message);const m=oc(h,"onSessionSettleRequest()");if(m)throw new Error(m.message);if(Ei(p)){const{message:g}=G("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async i=>{if(!ar(i)){const{message:m}=G("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(m)}const{topic:n,namespaces:o}=i;await this.isValidSessionTopic(n);const h=this.client.session.get(n),p=oc(o,"update()");if(p)throw new Error(p.message);const y=Gh(h.requiredNamespaces,o,"update()");if(y)throw new Error(y.message)},this.isValidExtend=async i=>{if(!ar(i)){const{message:o}=G("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionTopic(n)},this.isValidRequest=async i=>{if(!ar(i)){const{message:m}=G("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(m)}const{topic:n,request:o,chainId:h,expiry:p}=i;await this.isValidSessionTopic(n);const{namespaces:y}=this.client.session.get(n);if(!Wh(y,h)){const{message:m}=G("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(m)}if(!s1(o)){const{message:m}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(m)}if(!n1(y,h,o.method)){const{message:m}=G("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(m)}if(p&&!o1(p,vc)){const{message:m}=G("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${vc.min} and ${vc.max}`);throw new Error(m)}},this.isValidRespond=async i=>{var n;if(!ar(i)){const{message:p}=G("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(p)}const{topic:o,response:h}=i;try{await this.isValidSessionTopic(o)}catch(p){throw(n=i==null?void 0:i.response)!=null&&n.id&&this.cleanupAfterResponse(i),p}if(!a1(h)){const{message:p}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(h)}`);throw new Error(p)}},this.isValidPing=async i=>{if(!ar(i)){const{message:o}=G("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async i=>{if(!ar(i)){const{message:y}=G("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(y)}const{topic:n,event:o,chainId:h}=i;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!Wh(p,h)){const{message:y}=G("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(y)}if(!c1(o)){const{message:y}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(y)}if(!u1(p,h,o.name)){const{message:y}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(y)}},this.isValidDisconnect=async i=>{if(!ar(i)){const{message:o}=G("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(i,n)=>{const o={verified:{verifyUrl:n.verifyUrl||vs,validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:n.verifyUrl});h&&(o.verified.origin=h.origin,o.verified.isScam=h.isScam,o.verified.validation=h.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,n)=>{Object.values(i).forEach(o=>{if(!ys(o,!1)){const{message:h}=G("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Vt.message,async t=>{const{topic:i,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(i,n);try{Lc(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):No(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Pr.expired,async t=>{const{topic:i,id:n}=of(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,G("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Js.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!ys(t,!1)){const{message:i}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:i}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(i)}if(Ei(this.client.core.pairing.pairings.get(t).expiry)){const{message:i}=G("EXPIRED",`pairing topic: ${t}`);throw new Error(i)}}async isValidSessionTopic(t){if(!ys(t,!1)){const{message:i}=G("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(i)}if(!this.client.session.keys.includes(t)){const{message:i}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(i)}if(Ei(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:i}=G("EXPIRED",`session topic: ${t}`);throw new Error(i)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(ys(t,!1)){const{message:i}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(i)}else{const{message:i}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(i)}}async isValidProposalId(t){if(!h1(t)){const{message:i}=G("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(i)}if(!this.client.proposal.keys.includes(t)){const{message:i}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(i)}if(Ei(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:i}=G("EXPIRED",`proposal id: ${t}`);throw new Error(i)}}}class aI extends Fo{constructor(t,i){super(t,i,QE,Uc),this.core=t,this.logger=i}}class cI extends Fo{constructor(t,i){super(t,i,YE,Uc),this.core=t,this.logger=i}}class uI extends Fo{constructor(t,i){super(t,i,XE,Uc,n=>n.id),this.core=t,this.logger=i}}let hI=class Vf extends $w{constructor(t){super(t),this.protocol=Hf,this.version=kf,this.name=yc.name,this.events=new Sr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||yc.name,this.metadata=(t==null?void 0:t.metadata)||Wm();const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Oo(Co({level:(t==null?void 0:t.logger)||yc.logger}));this.core=(t==null?void 0:t.core)||new JE(t),this.logger=ur(i,this.name),this.session=new cI(this.core,this.logger),this.proposal=new aI(this.core,this.logger),this.pendingRequest=new uI(this.core,this.logger),this.engine=new oI(this)}static async init(t){const i=new Vf(t);return await i.initialize(),i}get context(){return cr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Oc={exports:{}};(function(a,t){var i=typeof self<"u"?self:jr,n=function(){function h(){this.fetch=!1,this.DOMException=i.DOMException}return h.prototype=i,new h}();(function(h){(function(p){var y={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function m(b){return b&&DataView.prototype.isPrototypeOf(b)}if(y.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(b){return b&&g.indexOf(Object.prototype.toString.call(b))>-1};function R(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function N(b){return typeof b!="string"&&(b=String(b)),b}function q(b){var S={next:function(){var J=b.shift();return{done:J===void 0,value:J}}};return y.iterable&&(S[Symbol.iterator]=function(){return S}),S}function C(b){this.map={},b instanceof C?b.forEach(function(S,J){this.append(J,S)},this):Array.isArray(b)?b.forEach(function(S){this.append(S[0],S[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(S){this.append(S,b[S])},this)}C.prototype.append=function(b,S){b=R(b),S=N(S);var J=this.map[b];this.map[b]=J?J+", "+S:S},C.prototype.delete=function(b){delete this.map[R(b)]},C.prototype.get=function(b){return b=R(b),this.has(b)?this.map[b]:null},C.prototype.has=function(b){return this.map.hasOwnProperty(R(b))},C.prototype.set=function(b,S){this.map[R(b)]=N(S)},C.prototype.forEach=function(b,S){for(var J in this.map)this.map.hasOwnProperty(J)&&b.call(S,this.map[J],J,this)},C.prototype.keys=function(){var b=[];return this.forEach(function(S,J){b.push(J)}),q(b)},C.prototype.values=function(){var b=[];return this.forEach(function(S){b.push(S)}),q(b)},C.prototype.entries=function(){var b=[];return this.forEach(function(S,J){b.push([J,S])}),q(b)},y.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function Y(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function re(b){return new Promise(function(S,J){b.onload=function(){S(b.result)},b.onerror=function(){J(b.error)}})}function oe(b){var S=new FileReader,J=re(S);return S.readAsArrayBuffer(b),J}function ce(b){var S=new FileReader,J=re(S);return S.readAsText(b),J}function ae(b){for(var S=new Uint8Array(b),J=new Array(S.length),le=0;le<S.length;le++)J[le]=String.fromCharCode(S[le]);return J.join("")}function ee(b){if(b.slice)return b.slice(0);var S=new Uint8Array(b.byteLength);return S.set(new Uint8Array(b)),S.buffer}function he(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:y.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:y.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():y.arrayBuffer&&y.blob&&m(b)?(this._bodyArrayBuffer=ee(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||E(b))?this._bodyArrayBuffer=ee(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var b=Y(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(oe)}),this.text=function(){var b=Y(this);if(b)return b;if(this._bodyBlob)return ce(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ae(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(wt)}),this.json=function(){return this.text().then(JSON.parse)},this}var pe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Q(b){var S=b.toUpperCase();return pe.indexOf(S)>-1?S:b}function ve(b,S){S=S||{};var J=S.body;if(b instanceof ve){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,S.headers||(this.headers=new C(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!J&&b._bodyInit!=null&&(J=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=S.credentials||this.credentials||"same-origin",(S.headers||!this.headers)&&(this.headers=new C(S.headers)),this.method=Q(S.method||this.method||"GET"),this.mode=S.mode||this.mode||null,this.signal=S.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&J)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(J)}ve.prototype.clone=function(){return new ve(this,{body:this._bodyInit})};function wt(b){var S=new FormData;return b.trim().split("&").forEach(function(J){if(J){var le=J.split("="),H=le.shift().replace(/\+/g," "),U=le.join("=").replace(/\+/g," ");S.append(decodeURIComponent(H),decodeURIComponent(U))}}),S}function st(b){var S=new C,J=b.replace(/\r?\n[\t ]+/g," ");return J.split(/\r?\n/).forEach(function(le){var H=le.split(":"),U=H.shift().trim();if(U){var k=H.join(":").trim();S.append(U,k)}}),S}he.call(ve.prototype);function ke(b,S){S||(S={}),this.type="default",this.status=S.status===void 0?200:S.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in S?S.statusText:"OK",this.headers=new C(S.headers),this.url=S.url||"",this._initBody(b)}he.call(ke.prototype),ke.prototype.clone=function(){return new ke(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},ke.error=function(){var b=new ke(null,{status:0,statusText:""});return b.type="error",b};var jt=[301,302,303,307,308];ke.redirect=function(b,S){if(jt.indexOf(S)===-1)throw new RangeError("Invalid status code");return new ke(null,{status:S,headers:{location:b}})},p.DOMException=h.DOMException;try{new p.DOMException}catch{p.DOMException=function(S,J){this.message=S,this.name=J;var le=Error(S);this.stack=le.stack},p.DOMException.prototype=Object.create(Error.prototype),p.DOMException.prototype.constructor=p.DOMException}function Lt(b,S){return new Promise(function(J,le){var H=new ve(b,S);if(H.signal&&H.signal.aborted)return le(new p.DOMException("Aborted","AbortError"));var U=new XMLHttpRequest;function k(){U.abort()}U.onload=function(){var B={status:U.status,statusText:U.statusText,headers:st(U.getAllResponseHeaders()||"")};B.url="responseURL"in U?U.responseURL:B.headers.get("X-Request-URL");var Xe="response"in U?U.response:U.responseText;J(new ke(Xe,B))},U.onerror=function(){le(new TypeError("Network request failed"))},U.ontimeout=function(){le(new TypeError("Network request failed"))},U.onabort=function(){le(new p.DOMException("Aborted","AbortError"))},U.open(H.method,H.url,!0),H.credentials==="include"?U.withCredentials=!0:H.credentials==="omit"&&(U.withCredentials=!1),"responseType"in U&&y.blob&&(U.responseType="blob"),H.headers.forEach(function(B,Xe){U.setRequestHeader(Xe,B)}),H.signal&&(H.signal.addEventListener("abort",k),U.onreadystatechange=function(){U.readyState===4&&H.signal.removeEventListener("abort",k)}),U.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return Lt.polyfill=!0,h.fetch||(h.fetch=Lt,h.Headers=C,h.Request=ve,h.Response=ke),p.Headers=C,p.Request=ve,p.Response=ke,p.fetch=Lt,Object.defineProperty(p,"__esModule",{value:!0}),p})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,a.exports=t})(Oc,Oc.exports);var lI=Oc.exports;const Ll=So(lI);var fI=Object.defineProperty,pI=Object.defineProperties,dI=Object.getOwnPropertyDescriptors,Ml=Object.getOwnPropertySymbols,gI=Object.prototype.hasOwnProperty,yI=Object.prototype.propertyIsEnumerable,zl=(a,t,i)=>t in a?fI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Ul=(a,t)=>{for(var i in t||(t={}))gI.call(t,i)&&zl(a,i,t[i]);if(Ml)for(var i of Ml(t))yI.call(t,i)&&zl(a,i,t[i]);return a},Hl=(a,t)=>pI(a,dI(t));const vI={Accept:"application/json","Content-Type":"application/json"},mI="POST",kl={headers:vI,method:mI},Bl=10;let Si=class{constructor(t,i=!1){if(this.url=t,this.disableProviderPing=i,this.events=new Sr.EventEmitter,this.isAvailable=!1,this.registering=!1,!fl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const i=ki(t),n=await(await Ll(this.url,Hl(Ul({},kl),{body:i}))).json();this.onPayload({data:n})}catch(i){this.onError(t.id,i)}}async register(t=this.url){if(!fl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const i=ki({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ll(t,Hl(Ul({},kl),{body:i}))}this.onOpen()}catch(i){const n=this.parseError(i);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const i=typeof t.data=="string"?sn(t.data):t.data;this.events.emit("payload",i)}onError(t,i){const n=this.parseError(i),o=n.message||n.toString(),h=$o(t,o);this.events.emit("payload",h)}parseError(t,i=this.url){return If(t,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Bl&&this.events.setMaxListeners(Bl)}};const Kl="error",wI="wss://relay.walletconnect.com",bI="wc",_I="universal_provider",Vl=`${bI}@2:${_I}:`,EI="https://rpc.walletconnect.com/v1/",hi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Gs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Cc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,t){(function(){var i,n="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",y="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",g=500,E="__lodash_placeholder__",R=1,N=2,q=4,C=1,Y=2,re=1,oe=2,ce=4,ae=8,ee=16,he=32,pe=64,Q=128,ve=256,wt=512,st=30,ke="...",jt=800,Lt=16,b=1,S=2,J=3,le=1/0,H=9007199254740991,U=17976931348623157e292,k=0/0,B=4294967295,Xe=B-1,nt=B>>>1,Ai=[["ary",Q],["bind",re],["bindKey",oe],["curry",ae],["curryRight",ee],["flip",wt],["partial",he],["partialRight",pe],["rearg",ve]],Ee="[object Arguments]",Ar="[object Array]",D="[object AsyncFunction]",$="[object Boolean]",O="[object Date]",u="[object DOMException]",I="[object Error]",Z="[object Function]",ue="[object GeneratorFunction]",me="[object Map]",Ae="[object Number]",Oe="[object Null]",Ie="[object Object]",bt="[object Promise]",dt="[object Proxy]",et="[object RegExp]",Te="[object Set]",Be="[object String]",Ke="[object Symbol]",tt="[object Undefined]",Fe="[object WeakMap]",Ve="[object WeakSet]",Re="[object ArrayBuffer]",je="[object DataView]",ot="[object Float32Array]",Ne="[object Float64Array]",_t="[object Int8Array]",Ct="[object Int16Array]",Mt="[object Int32Array]",zt="[object Uint8Array]",Nt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",Xt="[object Uint32Array]",Lr=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,li=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,at=RegExp(li.source),Je=RegExp(Ri.source),ct=/<%-([\s\S]+?)%>/g,ut=/<%([\s\S]+?)%>/g,rt=/<%=([\s\S]+?)%>/g,Qe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Et=/^\w*$/,It=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ht=/[\\^$.*+?()[\]{}|]/g,xt=RegExp(ht.source),lt=/^\s+/,gt=/\s/,ft=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,He=/\{\n\/\* \[wrapped with (.+)\] \*/,Pt=/,? & /,St=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,qo=/[()=,{}\[\]\/\s]/,jo=/\\(\\)?/g,Lo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Mo=/^[-+]0x[0-9a-f]+$/i,zo=/^0b[01]+$/i,Uo=/^\[object .+?Constructor\]$/,Ho=/^0o[0-7]+$/i,ko=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Gi=/($^)/,Bo=/['\n\r\u2028\u2029\\]/g,Wi="\\ud800-\\udfff",Ko="\\u0300-\\u036f",Vo="\\ufe20-\\ufe2f",Ji="\\u20d0-\\u20ff",an=Ko+Vo+Ji,cn="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Go="\\xac\\xb1\\xd7\\xf7",Wo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Jo="\\u2000-\\u206f",Qo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",un="A-Z\\xc0-\\xd6\\xd8-\\xde",hn="\\ufe0e\\ufe0f",Oi=Go+Wo+Jo+Qo,Es="['’]",Ci="["+Wi+"]",Is="["+Oi+"]",Ti="["+an+"]",ln="\\d+",Yo="["+cn+"]",fn="["+Rr+"]",pn="[^"+Wi+Oi+ln+cn+Rr+un+"]",Qi="\\ud83c[\\udffb-\\udfff]",Zo="(?:"+Ti+"|"+Qi+")",dn="[^"+Wi+"]",Yi="(?:\\ud83c[\\udde6-\\uddff]){2}",fi="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+un+"]",gn="\\u200d",yn="(?:"+fn+"|"+pn+")",Mr="(?:"+hr+"|"+pn+")",vn="(?:"+Es+"(?:d|ll|m|re|s|t|ve))?",mn="(?:"+Es+"(?:D|LL|M|RE|S|T|VE))?",wn=Zo+"?",bn="["+hn+"]?",Xo="(?:"+gn+"(?:"+[dn,Yi,fi].join("|")+")"+bn+wn+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_n="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",En=bn+wn+Xo,Zi="(?:"+[Yo,Yi,fi].join("|")+")"+En,ea="(?:"+[dn+Ti+"?",Ti,Yi,fi,Ci].join("|")+")",xs=RegExp(Es,"g"),ta=RegExp(Ti,"g"),Xi=RegExp(Qi+"(?="+Qi+")|"+ea+En,"g"),In=RegExp([hr+"?"+fn+"+"+vn+"(?="+[Is,hr,"$"].join("|")+")",Mr+"+"+mn+"(?="+[Is,hr+yn,"$"].join("|")+")",hr+"?"+yn+"+"+vn,hr+"+"+mn,_n,Wr,ln,Zi].join("|"),"g"),xn=RegExp("["+gn+Wi+an+hn+"]"),$i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Pn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ra=-1,Le={};Le[ot]=Le[Ne]=Le[_t]=Le[Ct]=Le[Mt]=Le[zt]=Le[Nt]=Le[Gt]=Le[Xt]=!0,Le[Ee]=Le[Ar]=Le[Re]=Le[$]=Le[je]=Le[O]=Le[I]=Le[Z]=Le[me]=Le[Ae]=Le[Ie]=Le[et]=Le[Te]=Le[Be]=Le[Fe]=!1;var qe={};qe[Ee]=qe[Ar]=qe[Re]=qe[je]=qe[$]=qe[O]=qe[ot]=qe[Ne]=qe[_t]=qe[Ct]=qe[Mt]=qe[me]=qe[Ae]=qe[Ie]=qe[et]=qe[Te]=qe[Be]=qe[Ke]=qe[zt]=qe[Nt]=qe[Gt]=qe[Xt]=!0,qe[I]=qe[Z]=qe[Fe]=!1;var v={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},M={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},V={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Me=parseFloat,de=parseInt,Ge=typeof Gs=="object"&&Gs&&Gs.Object===Object&&Gs,At=typeof self=="object"&&self&&self.Object===Object&&self,Pe=Ge||At||Function("return this")(),ze=t&&!t.nodeType&&t,yt=ze&&!0&&a&&!a.nodeType&&a,er=yt&&yt.exports===ze,Rt=er&&Ge.process,We=function(){try{var P=yt&&yt.require&&yt.require("util").types;return P||Rt&&Rt.binding&&Rt.binding("util")}catch{}}(),Jt=We&&We.isArrayBuffer,Or=We&&We.isDate,vr=We&&We.isMap,zr=We&&We.isRegExp,Ps=We&&We.isSet,Ni=We&&We.isTypedArray;function Dt(P,F,T){switch(T.length){case 0:return P.call(F);case 1:return P.call(F,T[0]);case 2:return P.call(F,T[0],T[1]);case 3:return P.call(F,T[0],T[1],T[2])}return P.apply(F,T)}function Jf(P,F,T,W){for(var fe=-1,Ce=P==null?0:P.length;++fe<Ce;){var Tt=P[fe];F(W,Tt,T(Tt),P)}return W}function mr(P,F){for(var T=-1,W=P==null?0:P.length;++T<W&&F(P[T],T,P)!==!1;);return P}function Qf(P,F){for(var T=P==null?0:P.length;T--&&F(P[T],T,P)!==!1;);return P}function Bc(P,F){for(var T=-1,W=P==null?0:P.length;++T<W;)if(!F(P[T],T,P))return!1;return!0}function pi(P,F){for(var T=-1,W=P==null?0:P.length,fe=0,Ce=[];++T<W;){var Tt=P[T];F(Tt,T,P)&&(Ce[fe++]=Tt)}return Ce}function Sn(P,F){var T=P==null?0:P.length;return!!T&&es(P,F,0)>-1}function ia(P,F,T){for(var W=-1,fe=P==null?0:P.length;++W<fe;)if(T(F,P[W]))return!0;return!1}function Ye(P,F){for(var T=-1,W=P==null?0:P.length,fe=Array(W);++T<W;)fe[T]=F(P[T],T,P);return fe}function di(P,F){for(var T=-1,W=F.length,fe=P.length;++T<W;)P[fe+T]=F[T];return P}function sa(P,F,T,W){var fe=-1,Ce=P==null?0:P.length;for(W&&Ce&&(T=P[++fe]);++fe<Ce;)T=F(T,P[fe],fe,P);return T}function Yf(P,F,T,W){var fe=P==null?0:P.length;for(W&&fe&&(T=P[--fe]);fe--;)T=F(T,P[fe],fe,P);return T}function na(P,F){for(var T=-1,W=P==null?0:P.length;++T<W;)if(F(P[T],T,P))return!0;return!1}var Zf=oa("length");function Xf(P){return P.split("")}function ep(P){return P.match(St)||[]}function Kc(P,F,T){var W;return T(P,function(fe,Ce,Tt){if(F(fe,Ce,Tt))return W=Ce,!1}),W}function An(P,F,T,W){for(var fe=P.length,Ce=T+(W?1:-1);W?Ce--:++Ce<fe;)if(F(P[Ce],Ce,P))return Ce;return-1}function es(P,F,T){return F===F?fp(P,F,T):An(P,Vc,T)}function tp(P,F,T,W){for(var fe=T-1,Ce=P.length;++fe<Ce;)if(W(P[fe],F))return fe;return-1}function Vc(P){return P!==P}function Gc(P,F){var T=P==null?0:P.length;return T?ca(P,F)/T:k}function oa(P){return function(F){return F==null?i:F[P]}}function aa(P){return function(F){return P==null?i:P[F]}}function Wc(P,F,T,W,fe){return fe(P,function(Ce,Tt,Ue){T=W?(W=!1,Ce):F(T,Ce,Tt,Ue)}),T}function rp(P,F){var T=P.length;for(P.sort(F);T--;)P[T]=P[T].value;return P}function ca(P,F){for(var T,W=-1,fe=P.length;++W<fe;){var Ce=F(P[W]);Ce!==i&&(T=T===i?Ce:T+Ce)}return T}function ua(P,F){for(var T=-1,W=Array(P);++T<P;)W[T]=F(T);return W}function ip(P,F){return Ye(F,function(T){return[T,P[T]]})}function Jc(P){return P&&P.slice(0,Xc(P)+1).replace(lt,"")}function lr(P){return function(F){return P(F)}}function ha(P,F){return Ye(F,function(T){return P[T]})}function Ss(P,F){return P.has(F)}function Qc(P,F){for(var T=-1,W=P.length;++T<W&&es(F,P[T],0)>-1;);return T}function Yc(P,F){for(var T=P.length;T--&&es(F,P[T],0)>-1;);return T}function sp(P,F){for(var T=P.length,W=0;T--;)P[T]===F&&++W;return W}var np=aa(v),op=aa(x);function ap(P){return"\\"+V[P]}function cp(P,F){return P==null?i:P[F]}function ts(P){return xn.test(P)}function up(P){return $i.test(P)}function hp(P){for(var F,T=[];!(F=P.next()).done;)T.push(F.value);return T}function la(P){var F=-1,T=Array(P.size);return P.forEach(function(W,fe){T[++F]=[fe,W]}),T}function Zc(P,F){return function(T){return P(F(T))}}function gi(P,F){for(var T=-1,W=P.length,fe=0,Ce=[];++T<W;){var Tt=P[T];(Tt===F||Tt===E)&&(P[T]=E,Ce[fe++]=T)}return Ce}function Rn(P){var F=-1,T=Array(P.size);return P.forEach(function(W){T[++F]=W}),T}function lp(P){var F=-1,T=Array(P.size);return P.forEach(function(W){T[++F]=[W,W]}),T}function fp(P,F,T){for(var W=T-1,fe=P.length;++W<fe;)if(P[W]===F)return W;return-1}function pp(P,F,T){for(var W=T+1;W--;)if(P[W]===F)return W;return W}function rs(P){return ts(P)?gp(P):Zf(P)}function Cr(P){return ts(P)?yp(P):Xf(P)}function Xc(P){for(var F=P.length;F--&&gt.test(P.charAt(F)););return F}var dp=aa(M);function gp(P){for(var F=Xi.lastIndex=0;Xi.test(P);)++F;return F}function yp(P){return P.match(Xi)||[]}function vp(P){return P.match(In)||[]}var mp=function P(F){F=F==null?Pe:is.defaults(Pe.Object(),F,is.pick(Pe,Pn));var T=F.Array,W=F.Date,fe=F.Error,Ce=F.Function,Tt=F.Math,Ue=F.Object,fa=F.RegExp,wp=F.String,wr=F.TypeError,On=T.prototype,bp=Ce.prototype,ss=Ue.prototype,Cn=F["__core-js_shared__"],Tn=bp.toString,De=ss.hasOwnProperty,_p=0,eu=function(){var e=/[^.]+$/.exec(Cn&&Cn.keys&&Cn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),$n=ss.toString,Ep=Tn.call(Ue),Ip=Pe._,xp=fa("^"+Tn.call(De).replace(ht,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Nn=er?F.Buffer:i,yi=F.Symbol,Dn=F.Uint8Array,tu=Nn?Nn.allocUnsafe:i,Fn=Zc(Ue.getPrototypeOf,Ue),ru=Ue.create,iu=ss.propertyIsEnumerable,qn=On.splice,su=yi?yi.isConcatSpreadable:i,As=yi?yi.iterator:i,Di=yi?yi.toStringTag:i,jn=function(){try{var e=Mi(Ue,"defineProperty");return e({},"",{}),e}catch{}}(),Pp=F.clearTimeout!==Pe.clearTimeout&&F.clearTimeout,Sp=W&&W.now!==Pe.Date.now&&W.now,Ap=F.setTimeout!==Pe.setTimeout&&F.setTimeout,Ln=Tt.ceil,Mn=Tt.floor,pa=Ue.getOwnPropertySymbols,Rp=Nn?Nn.isBuffer:i,nu=F.isFinite,Op=On.join,Cp=Zc(Ue.keys,Ue),$t=Tt.max,kt=Tt.min,Tp=W.now,$p=F.parseInt,ou=Tt.random,Np=On.reverse,da=Mi(F,"DataView"),Rs=Mi(F,"Map"),ga=Mi(F,"Promise"),ns=Mi(F,"Set"),Os=Mi(F,"WeakMap"),Cs=Mi(Ue,"create"),zn=Os&&new Os,os={},Dp=zi(da),Fp=zi(Rs),qp=zi(ga),jp=zi(ns),Lp=zi(Os),Un=yi?yi.prototype:i,Ts=Un?Un.valueOf:i,au=Un?Un.toString:i;function f(e){if(pt(e)&&!ge(e)&&!(e instanceof xe)){if(e instanceof br)return e;if(De.call(e,"__wrapped__"))return ch(e)}return new br(e)}var as=function(){function e(){}return function(r){if(!it(r))return{};if(ru)return ru(r);e.prototype=r;var s=new e;return e.prototype=i,s}}();function Hn(){}function br(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=i}f.templateSettings={escape:ct,evaluate:ut,interpolate:rt,variable:"",imports:{_:f}},f.prototype=Hn.prototype,f.prototype.constructor=f,br.prototype=as(Hn.prototype),br.prototype.constructor=br;function xe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=B,this.__views__=[]}function Mp(){var e=new xe(this.__wrapped__);return e.__actions__=tr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=tr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=tr(this.__views__),e}function zp(){if(this.__filtered__){var e=new xe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Up(){var e=this.__wrapped__.value(),r=this.__dir__,s=ge(e),c=r<0,l=s?e.length:0,d=Xd(0,l,this.__views__),w=d.start,_=d.end,A=_-w,j=c?_:w-1,L=this.__iteratees__,z=L.length,K=0,X=kt(A,this.__takeCount__);if(!s||!c&&l==A&&X==A)return Tu(e,this.__actions__);var se=[];e:for(;A--&&K<X;){j+=r;for(var we=-1,ne=e[j];++we<z;){var _e=L[we],Se=_e.iteratee,dr=_e.type,Zt=Se(ne);if(dr==S)ne=Zt;else if(!Zt){if(dr==b)continue e;break e}}se[K++]=ne}return se}xe.prototype=as(Hn.prototype),xe.prototype.constructor=xe;function Fi(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function Hp(){this.__data__=Cs?Cs(null):{},this.size=0}function kp(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}function Bp(e){var r=this.__data__;if(Cs){var s=r[e];return s===m?i:s}return De.call(r,e)?r[e]:i}function Kp(e){var r=this.__data__;return Cs?r[e]!==i:De.call(r,e)}function Vp(e,r){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Cs&&r===i?m:r,this}Fi.prototype.clear=Hp,Fi.prototype.delete=kp,Fi.prototype.get=Bp,Fi.prototype.has=Kp,Fi.prototype.set=Vp;function Jr(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function Gp(){this.__data__=[],this.size=0}function Wp(e){var r=this.__data__,s=kn(r,e);if(s<0)return!1;var c=r.length-1;return s==c?r.pop():qn.call(r,s,1),--this.size,!0}function Jp(e){var r=this.__data__,s=kn(r,e);return s<0?i:r[s][1]}function Qp(e){return kn(this.__data__,e)>-1}function Yp(e,r){var s=this.__data__,c=kn(s,e);return c<0?(++this.size,s.push([e,r])):s[c][1]=r,this}Jr.prototype.clear=Gp,Jr.prototype.delete=Wp,Jr.prototype.get=Jp,Jr.prototype.has=Qp,Jr.prototype.set=Yp;function Qr(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function Zp(){this.size=0,this.__data__={hash:new Fi,map:new(Rs||Jr),string:new Fi}}function Xp(e){var r=to(this,e).delete(e);return this.size-=r?1:0,r}function ed(e){return to(this,e).get(e)}function td(e){return to(this,e).has(e)}function rd(e,r){var s=to(this,e),c=s.size;return s.set(e,r),this.size+=s.size==c?0:1,this}Qr.prototype.clear=Zp,Qr.prototype.delete=Xp,Qr.prototype.get=ed,Qr.prototype.has=td,Qr.prototype.set=rd;function qi(e){var r=-1,s=e==null?0:e.length;for(this.__data__=new Qr;++r<s;)this.add(e[r])}function id(e){return this.__data__.set(e,m),this}function sd(e){return this.__data__.has(e)}qi.prototype.add=qi.prototype.push=id,qi.prototype.has=sd;function Tr(e){var r=this.__data__=new Jr(e);this.size=r.size}function nd(){this.__data__=new Jr,this.size=0}function od(e){var r=this.__data__,s=r.delete(e);return this.size=r.size,s}function ad(e){return this.__data__.get(e)}function cd(e){return this.__data__.has(e)}function ud(e,r){var s=this.__data__;if(s instanceof Jr){var c=s.__data__;if(!Rs||c.length<o-1)return c.push([e,r]),this.size=++s.size,this;s=this.__data__=new Qr(c)}return s.set(e,r),this.size=s.size,this}Tr.prototype.clear=nd,Tr.prototype.delete=od,Tr.prototype.get=ad,Tr.prototype.has=cd,Tr.prototype.set=ud;function cu(e,r){var s=ge(e),c=!s&&Ui(e),l=!s&&!c&&_i(e),d=!s&&!c&&!l&&ls(e),w=s||c||l||d,_=w?ua(e.length,wp):[],A=_.length;for(var j in e)(r||De.call(e,j))&&!(w&&(j=="length"||l&&(j=="offset"||j=="parent")||d&&(j=="buffer"||j=="byteLength"||j=="byteOffset")||ei(j,A)))&&_.push(j);return _}function uu(e){var r=e.length;return r?e[Sa(0,r-1)]:i}function hd(e,r){return ro(tr(e),ji(r,0,e.length))}function ld(e){return ro(tr(e))}function ya(e,r,s){(s!==i&&!$r(e[r],s)||s===i&&!(r in e))&&Yr(e,r,s)}function $s(e,r,s){var c=e[r];(!(De.call(e,r)&&$r(c,s))||s===i&&!(r in e))&&Yr(e,r,s)}function kn(e,r){for(var s=e.length;s--;)if($r(e[s][0],r))return s;return-1}function fd(e,r,s,c){return vi(e,function(l,d,w){r(c,l,s(l),w)}),c}function hu(e,r){return e&&Hr(r,Ft(r),e)}function pd(e,r){return e&&Hr(r,ir(r),e)}function Yr(e,r,s){r=="__proto__"&&jn?jn(e,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[r]=s}function va(e,r){for(var s=-1,c=r.length,l=T(c),d=e==null;++s<c;)l[s]=d?i:Ya(e,r[s]);return l}function ji(e,r,s){return e===e&&(s!==i&&(e=e<=s?e:s),r!==i&&(e=e>=r?e:r)),e}function _r(e,r,s,c,l,d){var w,_=r&R,A=r&N,j=r&q;if(s&&(w=l?s(e,c,l,d):s(e)),w!==i)return w;if(!it(e))return e;var L=ge(e);if(L){if(w=tg(e),!_)return tr(e,w)}else{var z=Bt(e),K=z==Z||z==ue;if(_i(e))return Du(e,_);if(z==Ie||z==Ee||K&&!l){if(w=A||K?{}:Xu(e),!_)return A?Bd(e,pd(w,e)):kd(e,hu(w,e))}else{if(!qe[z])return l?e:{};w=rg(e,z,_)}}d||(d=new Tr);var X=d.get(e);if(X)return X;d.set(e,w),Rh(e)?e.forEach(function(ne){w.add(_r(ne,r,s,ne,e,d))}):Sh(e)&&e.forEach(function(ne,_e){w.set(_e,_r(ne,r,s,_e,e,d))});var se=j?A?ja:qa:A?ir:Ft,we=L?i:se(e);return mr(we||e,function(ne,_e){we&&(_e=ne,ne=e[_e]),$s(w,_e,_r(ne,r,s,_e,e,d))}),w}function dd(e){var r=Ft(e);return function(s){return lu(s,e,r)}}function lu(e,r,s){var c=s.length;if(e==null)return!c;for(e=Ue(e);c--;){var l=s[c],d=r[l],w=e[l];if(w===i&&!(l in e)||!d(w))return!1}return!0}function fu(e,r,s){if(typeof e!="function")throw new wr(p);return Ms(function(){e.apply(i,s)},r)}function Ns(e,r,s,c){var l=-1,d=Sn,w=!0,_=e.length,A=[],j=r.length;if(!_)return A;s&&(r=Ye(r,lr(s))),c?(d=ia,w=!1):r.length>=o&&(d=Ss,w=!1,r=new qi(r));e:for(;++l<_;){var L=e[l],z=s==null?L:s(L);if(L=c||L!==0?L:0,w&&z===z){for(var K=j;K--;)if(r[K]===z)continue e;A.push(L)}else d(r,z,c)||A.push(L)}return A}var vi=Mu(Ur),pu=Mu(wa,!0);function gd(e,r){var s=!0;return vi(e,function(c,l,d){return s=!!r(c,l,d),s}),s}function Bn(e,r,s){for(var c=-1,l=e.length;++c<l;){var d=e[c],w=r(d);if(w!=null&&(_===i?w===w&&!pr(w):s(w,_)))var _=w,A=d}return A}function yd(e,r,s,c){var l=e.length;for(s=ye(s),s<0&&(s=-s>l?0:l+s),c=c===i||c>l?l:ye(c),c<0&&(c+=l),c=s>c?0:Ch(c);s<c;)e[s++]=r;return e}function du(e,r){var s=[];return vi(e,function(c,l,d){r(c,l,d)&&s.push(c)}),s}function Ut(e,r,s,c,l){var d=-1,w=e.length;for(s||(s=sg),l||(l=[]);++d<w;){var _=e[d];r>0&&s(_)?r>1?Ut(_,r-1,s,c,l):di(l,_):c||(l[l.length]=_)}return l}var ma=zu(),gu=zu(!0);function Ur(e,r){return e&&ma(e,r,Ft)}function wa(e,r){return e&&gu(e,r,Ft)}function Kn(e,r){return pi(r,function(s){return ti(e[s])})}function Li(e,r){r=wi(r,e);for(var s=0,c=r.length;e!=null&&s<c;)e=e[kr(r[s++])];return s&&s==c?e:i}function yu(e,r,s){var c=r(e);return ge(e)?c:di(c,s(e))}function Qt(e){return e==null?e===i?tt:Oe:Di&&Di in Ue(e)?Zd(e):lg(e)}function ba(e,r){return e>r}function vd(e,r){return e!=null&&De.call(e,r)}function md(e,r){return e!=null&&r in Ue(e)}function wd(e,r,s){return e>=kt(r,s)&&e<$t(r,s)}function _a(e,r,s){for(var c=s?ia:Sn,l=e[0].length,d=e.length,w=d,_=T(d),A=1/0,j=[];w--;){var L=e[w];w&&r&&(L=Ye(L,lr(r))),A=kt(L.length,A),_[w]=!s&&(r||l>=120&&L.length>=120)?new qi(w&&L):i}L=e[0];var z=-1,K=_[0];e:for(;++z<l&&j.length<A;){var X=L[z],se=r?r(X):X;if(X=s||X!==0?X:0,!(K?Ss(K,se):c(j,se,s))){for(w=d;--w;){var we=_[w];if(!(we?Ss(we,se):c(e[w],se,s)))continue e}K&&K.push(se),j.push(X)}}return j}function bd(e,r,s,c){return Ur(e,function(l,d,w){r(c,s(l),d,w)}),c}function Ds(e,r,s){r=wi(r,e),e=ih(e,r);var c=e==null?e:e[kr(Ir(r))];return c==null?i:Dt(c,e,s)}function vu(e){return pt(e)&&Qt(e)==Ee}function _d(e){return pt(e)&&Qt(e)==Re}function Ed(e){return pt(e)&&Qt(e)==O}function Fs(e,r,s,c,l){return e===r?!0:e==null||r==null||!pt(e)&&!pt(r)?e!==e&&r!==r:Id(e,r,s,c,Fs,l)}function Id(e,r,s,c,l,d){var w=ge(e),_=ge(r),A=w?Ar:Bt(e),j=_?Ar:Bt(r);A=A==Ee?Ie:A,j=j==Ee?Ie:j;var L=A==Ie,z=j==Ie,K=A==j;if(K&&_i(e)){if(!_i(r))return!1;w=!0,L=!1}if(K&&!L)return d||(d=new Tr),w||ls(e)?Qu(e,r,s,c,l,d):Qd(e,r,A,s,c,l,d);if(!(s&C)){var X=L&&De.call(e,"__wrapped__"),se=z&&De.call(r,"__wrapped__");if(X||se){var we=X?e.value():e,ne=se?r.value():r;return d||(d=new Tr),l(we,ne,s,c,d)}}return K?(d||(d=new Tr),Yd(e,r,s,c,l,d)):!1}function xd(e){return pt(e)&&Bt(e)==me}function Ea(e,r,s,c){var l=s.length,d=l,w=!c;if(e==null)return!d;for(e=Ue(e);l--;){var _=s[l];if(w&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++l<d;){_=s[l];var A=_[0],j=e[A],L=_[1];if(w&&_[2]){if(j===i&&!(A in e))return!1}else{var z=new Tr;if(c)var K=c(j,L,A,e,r,z);if(!(K===i?Fs(L,j,C|Y,c,z):K))return!1}}return!0}function mu(e){if(!it(e)||og(e))return!1;var r=ti(e)?xp:Uo;return r.test(zi(e))}function Pd(e){return pt(e)&&Qt(e)==et}function Sd(e){return pt(e)&&Bt(e)==Te}function Ad(e){return pt(e)&&co(e.length)&&!!Le[Qt(e)]}function wu(e){return typeof e=="function"?e:e==null?sr:typeof e=="object"?ge(e)?Eu(e[0],e[1]):_u(e):Uh(e)}function Ia(e){if(!Ls(e))return Cp(e);var r=[];for(var s in Ue(e))De.call(e,s)&&s!="constructor"&&r.push(s);return r}function Rd(e){if(!it(e))return hg(e);var r=Ls(e),s=[];for(var c in e)c=="constructor"&&(r||!De.call(e,c))||s.push(c);return s}function xa(e,r){return e<r}function bu(e,r){var s=-1,c=rr(e)?T(e.length):[];return vi(e,function(l,d,w){c[++s]=r(l,d,w)}),c}function _u(e){var r=Ma(e);return r.length==1&&r[0][2]?th(r[0][0],r[0][1]):function(s){return s===e||Ea(s,e,r)}}function Eu(e,r){return Ua(e)&&eh(r)?th(kr(e),r):function(s){var c=Ya(s,e);return c===i&&c===r?Za(s,e):Fs(r,c,C|Y)}}function Vn(e,r,s,c,l){e!==r&&ma(r,function(d,w){if(l||(l=new Tr),it(d))Od(e,r,w,s,Vn,c,l);else{var _=c?c(ka(e,w),d,w+"",e,r,l):i;_===i&&(_=d),ya(e,w,_)}},ir)}function Od(e,r,s,c,l,d,w){var _=ka(e,s),A=ka(r,s),j=w.get(A);if(j){ya(e,s,j);return}var L=d?d(_,A,s+"",e,r,w):i,z=L===i;if(z){var K=ge(A),X=!K&&_i(A),se=!K&&!X&&ls(A);L=A,K||X||se?ge(_)?L=_:vt(_)?L=tr(_):X?(z=!1,L=Du(A,!0)):se?(z=!1,L=Fu(A,!0)):L=[]:zs(A)||Ui(A)?(L=_,Ui(_)?L=Th(_):(!it(_)||ti(_))&&(L=Xu(A))):z=!1}z&&(w.set(A,L),l(L,A,c,d,w),w.delete(A)),ya(e,s,L)}function Iu(e,r){var s=e.length;if(s)return r+=r<0?s:0,ei(r,s)?e[r]:i}function xu(e,r,s){r.length?r=Ye(r,function(d){return ge(d)?function(w){return Li(w,d.length===1?d[0]:d)}:d}):r=[sr];var c=-1;r=Ye(r,lr(ie()));var l=bu(e,function(d,w,_){var A=Ye(r,function(j){return j(d)});return{criteria:A,index:++c,value:d}});return rp(l,function(d,w){return Hd(d,w,s)})}function Cd(e,r){return Pu(e,r,function(s,c){return Za(e,c)})}function Pu(e,r,s){for(var c=-1,l=r.length,d={};++c<l;){var w=r[c],_=Li(e,w);s(_,w)&&qs(d,wi(w,e),_)}return d}function Td(e){return function(r){return Li(r,e)}}function Pa(e,r,s,c){var l=c?tp:es,d=-1,w=r.length,_=e;for(e===r&&(r=tr(r)),s&&(_=Ye(e,lr(s)));++d<w;)for(var A=0,j=r[d],L=s?s(j):j;(A=l(_,L,A,c))>-1;)_!==e&&qn.call(_,A,1),qn.call(e,A,1);return e}function Su(e,r){for(var s=e?r.length:0,c=s-1;s--;){var l=r[s];if(s==c||l!==d){var d=l;ei(l)?qn.call(e,l,1):Oa(e,l)}}return e}function Sa(e,r){return e+Mn(ou()*(r-e+1))}function $d(e,r,s,c){for(var l=-1,d=$t(Ln((r-e)/(s||1)),0),w=T(d);d--;)w[c?d:++l]=e,e+=s;return w}function Aa(e,r){var s="";if(!e||r<1||r>H)return s;do r%2&&(s+=e),r=Mn(r/2),r&&(e+=e);while(r);return s}function be(e,r){return Ba(rh(e,r,sr),e+"")}function Nd(e){return uu(fs(e))}function Dd(e,r){var s=fs(e);return ro(s,ji(r,0,s.length))}function qs(e,r,s,c){if(!it(e))return e;r=wi(r,e);for(var l=-1,d=r.length,w=d-1,_=e;_!=null&&++l<d;){var A=kr(r[l]),j=s;if(A==="__proto__"||A==="constructor"||A==="prototype")return e;if(l!=w){var L=_[A];j=c?c(L,A,_):i,j===i&&(j=it(L)?L:ei(r[l+1])?[]:{})}$s(_,A,j),_=_[A]}return e}var Au=zn?function(e,r){return zn.set(e,r),e}:sr,Fd=jn?function(e,r){return jn(e,"toString",{configurable:!0,enumerable:!1,value:ec(r),writable:!0})}:sr;function qd(e){return ro(fs(e))}function Er(e,r,s){var c=-1,l=e.length;r<0&&(r=-r>l?0:l+r),s=s>l?l:s,s<0&&(s+=l),l=r>s?0:s-r>>>0,r>>>=0;for(var d=T(l);++c<l;)d[c]=e[c+r];return d}function jd(e,r){var s;return vi(e,function(c,l,d){return s=r(c,l,d),!s}),!!s}function Gn(e,r,s){var c=0,l=e==null?c:e.length;if(typeof r=="number"&&r===r&&l<=nt){for(;c<l;){var d=c+l>>>1,w=e[d];w!==null&&!pr(w)&&(s?w<=r:w<r)?c=d+1:l=d}return l}return Ra(e,r,sr,s)}function Ra(e,r,s,c){var l=0,d=e==null?0:e.length;if(d===0)return 0;r=s(r);for(var w=r!==r,_=r===null,A=pr(r),j=r===i;l<d;){var L=Mn((l+d)/2),z=s(e[L]),K=z!==i,X=z===null,se=z===z,we=pr(z);if(w)var ne=c||se;else j?ne=se&&(c||K):_?ne=se&&K&&(c||!X):A?ne=se&&K&&!X&&(c||!we):X||we?ne=!1:ne=c?z<=r:z<r;ne?l=L+1:d=L}return kt(d,Xe)}function Ru(e,r){for(var s=-1,c=e.length,l=0,d=[];++s<c;){var w=e[s],_=r?r(w):w;if(!s||!$r(_,A)){var A=_;d[l++]=w===0?0:w}}return d}function Ou(e){return typeof e=="number"?e:pr(e)?k:+e}function fr(e){if(typeof e=="string")return e;if(ge(e))return Ye(e,fr)+"";if(pr(e))return au?au.call(e):"";var r=e+"";return r=="0"&&1/e==-le?"-0":r}function mi(e,r,s){var c=-1,l=Sn,d=e.length,w=!0,_=[],A=_;if(s)w=!1,l=ia;else if(d>=o){var j=r?null:Wd(e);if(j)return Rn(j);w=!1,l=Ss,A=new qi}else A=r?[]:_;e:for(;++c<d;){var L=e[c],z=r?r(L):L;if(L=s||L!==0?L:0,w&&z===z){for(var K=A.length;K--;)if(A[K]===z)continue e;r&&A.push(z),_.push(L)}else l(A,z,s)||(A!==_&&A.push(z),_.push(L))}return _}function Oa(e,r){return r=wi(r,e),e=ih(e,r),e==null||delete e[kr(Ir(r))]}function Cu(e,r,s,c){return qs(e,r,s(Li(e,r)),c)}function Wn(e,r,s,c){for(var l=e.length,d=c?l:-1;(c?d--:++d<l)&&r(e[d],d,e););return s?Er(e,c?0:d,c?d+1:l):Er(e,c?d+1:0,c?l:d)}function Tu(e,r){var s=e;return s instanceof xe&&(s=s.value()),sa(r,function(c,l){return l.func.apply(l.thisArg,di([c],l.args))},s)}function Ca(e,r,s){var c=e.length;if(c<2)return c?mi(e[0]):[];for(var l=-1,d=T(c);++l<c;)for(var w=e[l],_=-1;++_<c;)_!=l&&(d[l]=Ns(d[l]||w,e[_],r,s));return mi(Ut(d,1),r,s)}function $u(e,r,s){for(var c=-1,l=e.length,d=r.length,w={};++c<l;){var _=c<d?r[c]:i;s(w,e[c],_)}return w}function Ta(e){return vt(e)?e:[]}function $a(e){return typeof e=="function"?e:sr}function wi(e,r){return ge(e)?e:Ua(e,r)?[e]:ah($e(e))}var Ld=be;function bi(e,r,s){var c=e.length;return s=s===i?c:s,!r&&s>=c?e:Er(e,r,s)}var Nu=Pp||function(e){return Pe.clearTimeout(e)};function Du(e,r){if(r)return e.slice();var s=e.length,c=tu?tu(s):new e.constructor(s);return e.copy(c),c}function Na(e){var r=new e.constructor(e.byteLength);return new Dn(r).set(new Dn(e)),r}function Md(e,r){var s=r?Na(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function zd(e){var r=new e.constructor(e.source,yr.exec(e));return r.lastIndex=e.lastIndex,r}function Ud(e){return Ts?Ue(Ts.call(e)):{}}function Fu(e,r){var s=r?Na(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function qu(e,r){if(e!==r){var s=e!==i,c=e===null,l=e===e,d=pr(e),w=r!==i,_=r===null,A=r===r,j=pr(r);if(!_&&!j&&!d&&e>r||d&&w&&A&&!_&&!j||c&&w&&A||!s&&A||!l)return 1;if(!c&&!d&&!j&&e<r||j&&s&&l&&!c&&!d||_&&s&&l||!w&&l||!A)return-1}return 0}function Hd(e,r,s){for(var c=-1,l=e.criteria,d=r.criteria,w=l.length,_=s.length;++c<w;){var A=qu(l[c],d[c]);if(A){if(c>=_)return A;var j=s[c];return A*(j=="desc"?-1:1)}}return e.index-r.index}function ju(e,r,s,c){for(var l=-1,d=e.length,w=s.length,_=-1,A=r.length,j=$t(d-w,0),L=T(A+j),z=!c;++_<A;)L[_]=r[_];for(;++l<w;)(z||l<d)&&(L[s[l]]=e[l]);for(;j--;)L[_++]=e[l++];return L}function Lu(e,r,s,c){for(var l=-1,d=e.length,w=-1,_=s.length,A=-1,j=r.length,L=$t(d-_,0),z=T(L+j),K=!c;++l<L;)z[l]=e[l];for(var X=l;++A<j;)z[X+A]=r[A];for(;++w<_;)(K||l<d)&&(z[X+s[w]]=e[l++]);return z}function tr(e,r){var s=-1,c=e.length;for(r||(r=T(c));++s<c;)r[s]=e[s];return r}function Hr(e,r,s,c){var l=!s;s||(s={});for(var d=-1,w=r.length;++d<w;){var _=r[d],A=c?c(s[_],e[_],_,s,e):i;A===i&&(A=e[_]),l?Yr(s,_,A):$s(s,_,A)}return s}function kd(e,r){return Hr(e,za(e),r)}function Bd(e,r){return Hr(e,Yu(e),r)}function Jn(e,r){return function(s,c){var l=ge(s)?Jf:fd,d=r?r():{};return l(s,e,ie(c,2),d)}}function cs(e){return be(function(r,s){var c=-1,l=s.length,d=l>1?s[l-1]:i,w=l>2?s[2]:i;for(d=e.length>3&&typeof d=="function"?(l--,d):i,w&&Yt(s[0],s[1],w)&&(d=l<3?i:d,l=1),r=Ue(r);++c<l;){var _=s[c];_&&e(r,_,c,d)}return r})}function Mu(e,r){return function(s,c){if(s==null)return s;if(!rr(s))return e(s,c);for(var l=s.length,d=r?l:-1,w=Ue(s);(r?d--:++d<l)&&c(w[d],d,w)!==!1;);return s}}function zu(e){return function(r,s,c){for(var l=-1,d=Ue(r),w=c(r),_=w.length;_--;){var A=w[e?_:++l];if(s(d[A],A,d)===!1)break}return r}}function Kd(e,r,s){var c=r&re,l=js(e);function d(){var w=this&&this!==Pe&&this instanceof d?l:e;return w.apply(c?s:this,arguments)}return d}function Uu(e){return function(r){r=$e(r);var s=ts(r)?Cr(r):i,c=s?s[0]:r.charAt(0),l=s?bi(s,1).join(""):r.slice(1);return c[e]()+l}}function us(e){return function(r){return sa(Mh(Lh(r).replace(xs,"")),e,"")}}function js(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var s=as(e.prototype),c=e.apply(s,r);return it(c)?c:s}}function Vd(e,r,s){var c=js(e);function l(){for(var d=arguments.length,w=T(d),_=d,A=hs(l);_--;)w[_]=arguments[_];var j=d<3&&w[0]!==A&&w[d-1]!==A?[]:gi(w,A);if(d-=j.length,d<s)return Vu(e,r,Qn,l.placeholder,i,w,j,i,i,s-d);var L=this&&this!==Pe&&this instanceof l?c:e;return Dt(L,this,w)}return l}function Hu(e){return function(r,s,c){var l=Ue(r);if(!rr(r)){var d=ie(s,3);r=Ft(r),s=function(_){return d(l[_],_,l)}}var w=e(r,s,c);return w>-1?l[d?r[w]:w]:i}}function ku(e){return Xr(function(r){var s=r.length,c=s,l=br.prototype.thru;for(e&&r.reverse();c--;){var d=r[c];if(typeof d!="function")throw new wr(p);if(l&&!w&&eo(d)=="wrapper")var w=new br([],!0)}for(c=w?c:s;++c<s;){d=r[c];var _=eo(d),A=_=="wrapper"?La(d):i;A&&Ha(A[0])&&A[1]==(Q|ae|he|ve)&&!A[4].length&&A[9]==1?w=w[eo(A[0])].apply(w,A[3]):w=d.length==1&&Ha(d)?w[_]():w.thru(d)}return function(){var j=arguments,L=j[0];if(w&&j.length==1&&ge(L))return w.plant(L).value();for(var z=0,K=s?r[z].apply(this,j):L;++z<s;)K=r[z].call(this,K);return K}})}function Qn(e,r,s,c,l,d,w,_,A,j){var L=r&Q,z=r&re,K=r&oe,X=r&(ae|ee),se=r&wt,we=K?i:js(e);function ne(){for(var _e=arguments.length,Se=T(_e),dr=_e;dr--;)Se[dr]=arguments[dr];if(X)var Zt=hs(ne),gr=sp(Se,Zt);if(c&&(Se=ju(Se,c,l,X)),d&&(Se=Lu(Se,d,w,X)),_e-=gr,X&&_e<j){var mt=gi(Se,Zt);return Vu(e,r,Qn,ne.placeholder,s,Se,mt,_,A,j-_e)}var Nr=z?s:this,ii=K?Nr[e]:e;return _e=Se.length,_?Se=fg(Se,_):se&&_e>1&&Se.reverse(),L&&A<_e&&(Se.length=A),this&&this!==Pe&&this instanceof ne&&(ii=we||js(ii)),ii.apply(Nr,Se)}return ne}function Bu(e,r){return function(s,c){return bd(s,e,r(c),{})}}function Yn(e,r){return function(s,c){var l;if(s===i&&c===i)return r;if(s!==i&&(l=s),c!==i){if(l===i)return c;typeof s=="string"||typeof c=="string"?(s=fr(s),c=fr(c)):(s=Ou(s),c=Ou(c)),l=e(s,c)}return l}}function Da(e){return Xr(function(r){return r=Ye(r,lr(ie())),be(function(s){var c=this;return e(r,function(l){return Dt(l,c,s)})})})}function Zn(e,r){r=r===i?" ":fr(r);var s=r.length;if(s<2)return s?Aa(r,e):r;var c=Aa(r,Ln(e/rs(r)));return ts(r)?bi(Cr(c),0,e).join(""):c.slice(0,e)}function Gd(e,r,s,c){var l=r&re,d=js(e);function w(){for(var _=-1,A=arguments.length,j=-1,L=c.length,z=T(L+A),K=this&&this!==Pe&&this instanceof w?d:e;++j<L;)z[j]=c[j];for(;A--;)z[j++]=arguments[++_];return Dt(K,l?s:this,z)}return w}function Ku(e){return function(r,s,c){return c&&typeof c!="number"&&Yt(r,s,c)&&(s=c=i),r=ri(r),s===i?(s=r,r=0):s=ri(s),c=c===i?r<s?1:-1:ri(c),$d(r,s,c,e)}}function Xn(e){return function(r,s){return typeof r=="string"&&typeof s=="string"||(r=xr(r),s=xr(s)),e(r,s)}}function Vu(e,r,s,c,l,d,w,_,A,j){var L=r&ae,z=L?w:i,K=L?i:w,X=L?d:i,se=L?i:d;r|=L?he:pe,r&=~(L?pe:he),r&ce||(r&=~(re|oe));var we=[e,r,l,X,z,se,K,_,A,j],ne=s.apply(i,we);return Ha(e)&&sh(ne,we),ne.placeholder=c,nh(ne,e,r)}function Fa(e){var r=Tt[e];return function(s,c){if(s=xr(s),c=c==null?0:kt(ye(c),292),c&&nu(s)){var l=($e(s)+"e").split("e"),d=r(l[0]+"e"+(+l[1]+c));return l=($e(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return r(s)}}var Wd=ns&&1/Rn(new ns([,-0]))[1]==le?function(e){return new ns(e)}:ic;function Gu(e){return function(r){var s=Bt(r);return s==me?la(r):s==Te?lp(r):ip(r,e(r))}}function Zr(e,r,s,c,l,d,w,_){var A=r&oe;if(!A&&typeof e!="function")throw new wr(p);var j=c?c.length:0;if(j||(r&=~(he|pe),c=l=i),w=w===i?w:$t(ye(w),0),_=_===i?_:ye(_),j-=l?l.length:0,r&pe){var L=c,z=l;c=l=i}var K=A?i:La(e),X=[e,r,s,c,l,L,z,d,w,_];if(K&&ug(X,K),e=X[0],r=X[1],s=X[2],c=X[3],l=X[4],_=X[9]=X[9]===i?A?0:e.length:$t(X[9]-j,0),!_&&r&(ae|ee)&&(r&=~(ae|ee)),!r||r==re)var se=Kd(e,r,s);else r==ae||r==ee?se=Vd(e,r,_):(r==he||r==(re|he))&&!l.length?se=Gd(e,r,s,c):se=Qn.apply(i,X);var we=K?Au:sh;return nh(we(se,X),e,r)}function Wu(e,r,s,c){return e===i||$r(e,ss[s])&&!De.call(c,s)?r:e}function Ju(e,r,s,c,l,d){return it(e)&&it(r)&&(d.set(r,e),Vn(e,r,i,Ju,d),d.delete(r)),e}function Jd(e){return zs(e)?i:e}function Qu(e,r,s,c,l,d){var w=s&C,_=e.length,A=r.length;if(_!=A&&!(w&&A>_))return!1;var j=d.get(e),L=d.get(r);if(j&&L)return j==r&&L==e;var z=-1,K=!0,X=s&Y?new qi:i;for(d.set(e,r),d.set(r,e);++z<_;){var se=e[z],we=r[z];if(c)var ne=w?c(we,se,z,r,e,d):c(se,we,z,e,r,d);if(ne!==i){if(ne)continue;K=!1;break}if(X){if(!na(r,function(_e,Se){if(!Ss(X,Se)&&(se===_e||l(se,_e,s,c,d)))return X.push(Se)})){K=!1;break}}else if(!(se===we||l(se,we,s,c,d))){K=!1;break}}return d.delete(e),d.delete(r),K}function Qd(e,r,s,c,l,d,w){switch(s){case je:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case Re:return!(e.byteLength!=r.byteLength||!d(new Dn(e),new Dn(r)));case $:case O:case Ae:return $r(+e,+r);case I:return e.name==r.name&&e.message==r.message;case et:case Be:return e==r+"";case me:var _=la;case Te:var A=c&C;if(_||(_=Rn),e.size!=r.size&&!A)return!1;var j=w.get(e);if(j)return j==r;c|=Y,w.set(e,r);var L=Qu(_(e),_(r),c,l,d,w);return w.delete(e),L;case Ke:if(Ts)return Ts.call(e)==Ts.call(r)}return!1}function Yd(e,r,s,c,l,d){var w=s&C,_=qa(e),A=_.length,j=qa(r),L=j.length;if(A!=L&&!w)return!1;for(var z=A;z--;){var K=_[z];if(!(w?K in r:De.call(r,K)))return!1}var X=d.get(e),se=d.get(r);if(X&&se)return X==r&&se==e;var we=!0;d.set(e,r),d.set(r,e);for(var ne=w;++z<A;){K=_[z];var _e=e[K],Se=r[K];if(c)var dr=w?c(Se,_e,K,r,e,d):c(_e,Se,K,e,r,d);if(!(dr===i?_e===Se||l(_e,Se,s,c,d):dr)){we=!1;break}ne||(ne=K=="constructor")}if(we&&!ne){var Zt=e.constructor,gr=r.constructor;Zt!=gr&&"constructor"in e&&"constructor"in r&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof gr=="function"&&gr instanceof gr)&&(we=!1)}return d.delete(e),d.delete(r),we}function Xr(e){return Ba(rh(e,i,lh),e+"")}function qa(e){return yu(e,Ft,za)}function ja(e){return yu(e,ir,Yu)}var La=zn?function(e){return zn.get(e)}:ic;function eo(e){for(var r=e.name+"",s=os[r],c=De.call(os,r)?s.length:0;c--;){var l=s[c],d=l.func;if(d==null||d==e)return l.name}return r}function hs(e){var r=De.call(f,"placeholder")?f:e;return r.placeholder}function ie(){var e=f.iteratee||tc;return e=e===tc?wu:e,arguments.length?e(arguments[0],arguments[1]):e}function to(e,r){var s=e.__data__;return ng(r)?s[typeof r=="string"?"string":"hash"]:s.map}function Ma(e){for(var r=Ft(e),s=r.length;s--;){var c=r[s],l=e[c];r[s]=[c,l,eh(l)]}return r}function Mi(e,r){var s=cp(e,r);return mu(s)?s:i}function Zd(e){var r=De.call(e,Di),s=e[Di];try{e[Di]=i;var c=!0}catch{}var l=$n.call(e);return c&&(r?e[Di]=s:delete e[Di]),l}var za=pa?function(e){return e==null?[]:(e=Ue(e),pi(pa(e),function(r){return iu.call(e,r)}))}:sc,Yu=pa?function(e){for(var r=[];e;)di(r,za(e)),e=Fn(e);return r}:sc,Bt=Qt;(da&&Bt(new da(new ArrayBuffer(1)))!=je||Rs&&Bt(new Rs)!=me||ga&&Bt(ga.resolve())!=bt||ns&&Bt(new ns)!=Te||Os&&Bt(new Os)!=Fe)&&(Bt=function(e){var r=Qt(e),s=r==Ie?e.constructor:i,c=s?zi(s):"";if(c)switch(c){case Dp:return je;case Fp:return me;case qp:return bt;case jp:return Te;case Lp:return Fe}return r});function Xd(e,r,s){for(var c=-1,l=s.length;++c<l;){var d=s[c],w=d.size;switch(d.type){case"drop":e+=w;break;case"dropRight":r-=w;break;case"take":r=kt(r,e+w);break;case"takeRight":e=$t(e,r-w);break}}return{start:e,end:r}}function eg(e){var r=e.match(He);return r?r[1].split(Pt):[]}function Zu(e,r,s){r=wi(r,e);for(var c=-1,l=r.length,d=!1;++c<l;){var w=kr(r[c]);if(!(d=e!=null&&s(e,w)))break;e=e[w]}return d||++c!=l?d:(l=e==null?0:e.length,!!l&&co(l)&&ei(w,l)&&(ge(e)||Ui(e)))}function tg(e){var r=e.length,s=new e.constructor(r);return r&&typeof e[0]=="string"&&De.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Xu(e){return typeof e.constructor=="function"&&!Ls(e)?as(Fn(e)):{}}function rg(e,r,s){var c=e.constructor;switch(r){case Re:return Na(e);case $:case O:return new c(+e);case je:return Md(e,s);case ot:case Ne:case _t:case Ct:case Mt:case zt:case Nt:case Gt:case Xt:return Fu(e,s);case me:return new c;case Ae:case Be:return new c(e);case et:return zd(e);case Te:return new c;case Ke:return Ud(e)}}function ig(e,r){var s=r.length;if(!s)return e;var c=s-1;return r[c]=(s>1?"& ":"")+r[c],r=r.join(s>2?", ":" "),e.replace(ft,`{
/* [wrapped with `+r+`] */
`)}function sg(e){return ge(e)||Ui(e)||!!(su&&e&&e[su])}function ei(e,r){var s=typeof e;return r=r??H,!!r&&(s=="number"||s!="symbol"&&ko.test(e))&&e>-1&&e%1==0&&e<r}function Yt(e,r,s){if(!it(s))return!1;var c=typeof r;return(c=="number"?rr(s)&&ei(r,s.length):c=="string"&&r in s)?$r(s[r],e):!1}function Ua(e,r){if(ge(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||pr(e)?!0:Et.test(e)||!Qe.test(e)||r!=null&&e in Ue(r)}function ng(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function Ha(e){var r=eo(e),s=f[r];if(typeof s!="function"||!(r in xe.prototype))return!1;if(e===s)return!0;var c=La(s);return!!c&&e===c[0]}function og(e){return!!eu&&eu in e}var ag=Cn?ti:nc;function Ls(e){var r=e&&e.constructor,s=typeof r=="function"&&r.prototype||ss;return e===s}function eh(e){return e===e&&!it(e)}function th(e,r){return function(s){return s==null?!1:s[e]===r&&(r!==i||e in Ue(s))}}function cg(e){var r=oo(e,function(c){return s.size===g&&s.clear(),c}),s=r.cache;return r}function ug(e,r){var s=e[1],c=r[1],l=s|c,d=l<(re|oe|Q),w=c==Q&&s==ae||c==Q&&s==ve&&e[7].length<=r[8]||c==(Q|ve)&&r[7].length<=r[8]&&s==ae;if(!(d||w))return e;c&re&&(e[2]=r[2],l|=s&re?0:ce);var _=r[3];if(_){var A=e[3];e[3]=A?ju(A,_,r[4]):_,e[4]=A?gi(e[3],E):r[4]}return _=r[5],_&&(A=e[5],e[5]=A?Lu(A,_,r[6]):_,e[6]=A?gi(e[5],E):r[6]),_=r[7],_&&(e[7]=_),c&Q&&(e[8]=e[8]==null?r[8]:kt(e[8],r[8])),e[9]==null&&(e[9]=r[9]),e[0]=r[0],e[1]=l,e}function hg(e){var r=[];if(e!=null)for(var s in Ue(e))r.push(s);return r}function lg(e){return $n.call(e)}function rh(e,r,s){return r=$t(r===i?e.length-1:r,0),function(){for(var c=arguments,l=-1,d=$t(c.length-r,0),w=T(d);++l<d;)w[l]=c[r+l];l=-1;for(var _=T(r+1);++l<r;)_[l]=c[l];return _[r]=s(w),Dt(e,this,_)}}function ih(e,r){return r.length<2?e:Li(e,Er(r,0,-1))}function fg(e,r){for(var s=e.length,c=kt(r.length,s),l=tr(e);c--;){var d=r[c];e[c]=ei(d,s)?l[d]:i}return e}function ka(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var sh=oh(Au),Ms=Ap||function(e,r){return Pe.setTimeout(e,r)},Ba=oh(Fd);function nh(e,r,s){var c=r+"";return Ba(e,ig(c,pg(eg(c),s)))}function oh(e){var r=0,s=0;return function(){var c=Tp(),l=Lt-(c-s);if(s=c,l>0){if(++r>=jt)return arguments[0]}else r=0;return e.apply(i,arguments)}}function ro(e,r){var s=-1,c=e.length,l=c-1;for(r=r===i?c:r;++s<r;){var d=Sa(s,l),w=e[d];e[d]=e[s],e[s]=w}return e.length=r,e}var ah=cg(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(It,function(s,c,l,d){r.push(l?d.replace(jo,"$1"):c||s)}),r});function kr(e){if(typeof e=="string"||pr(e))return e;var r=e+"";return r=="0"&&1/e==-le?"-0":r}function zi(e){if(e!=null){try{return Tn.call(e)}catch{}try{return e+""}catch{}}return""}function pg(e,r){return mr(Ai,function(s){var c="_."+s[0];r&s[1]&&!Sn(e,c)&&e.push(c)}),e.sort()}function ch(e){if(e instanceof xe)return e.clone();var r=new br(e.__wrapped__,e.__chain__);return r.__actions__=tr(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function dg(e,r,s){(s?Yt(e,r,s):r===i)?r=1:r=$t(ye(r),0);var c=e==null?0:e.length;if(!c||r<1)return[];for(var l=0,d=0,w=T(Ln(c/r));l<c;)w[d++]=Er(e,l,l+=r);return w}function gg(e){for(var r=-1,s=e==null?0:e.length,c=0,l=[];++r<s;){var d=e[r];d&&(l[c++]=d)}return l}function yg(){var e=arguments.length;if(!e)return[];for(var r=T(e-1),s=arguments[0],c=e;c--;)r[c-1]=arguments[c];return di(ge(s)?tr(s):[s],Ut(r,1))}var vg=be(function(e,r){return vt(e)?Ns(e,Ut(r,1,vt,!0)):[]}),mg=be(function(e,r){var s=Ir(r);return vt(s)&&(s=i),vt(e)?Ns(e,Ut(r,1,vt,!0),ie(s,2)):[]}),wg=be(function(e,r){var s=Ir(r);return vt(s)&&(s=i),vt(e)?Ns(e,Ut(r,1,vt,!0),i,s):[]});function bg(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:ye(r),Er(e,r<0?0:r,c)):[]}function _g(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:ye(r),r=c-r,Er(e,0,r<0?0:r)):[]}function Eg(e,r){return e&&e.length?Wn(e,ie(r,3),!0,!0):[]}function Ig(e,r){return e&&e.length?Wn(e,ie(r,3),!0):[]}function xg(e,r,s,c){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Yt(e,r,s)&&(s=0,c=l),yd(e,r,s,c)):[]}function uh(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var l=s==null?0:ye(s);return l<0&&(l=$t(c+l,0)),An(e,ie(r,3),l)}function hh(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return s!==i&&(l=ye(s),l=s<0?$t(c+l,0):kt(l,c-1)),An(e,ie(r,3),l,!0)}function lh(e){var r=e==null?0:e.length;return r?Ut(e,1):[]}function Pg(e){var r=e==null?0:e.length;return r?Ut(e,le):[]}function Sg(e,r){var s=e==null?0:e.length;return s?(r=r===i?1:ye(r),Ut(e,r)):[]}function Ag(e){for(var r=-1,s=e==null?0:e.length,c={};++r<s;){var l=e[r];c[l[0]]=l[1]}return c}function fh(e){return e&&e.length?e[0]:i}function Rg(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var l=s==null?0:ye(s);return l<0&&(l=$t(c+l,0)),es(e,r,l)}function Og(e){var r=e==null?0:e.length;return r?Er(e,0,-1):[]}var Cg=be(function(e){var r=Ye(e,Ta);return r.length&&r[0]===e[0]?_a(r):[]}),Tg=be(function(e){var r=Ir(e),s=Ye(e,Ta);return r===Ir(s)?r=i:s.pop(),s.length&&s[0]===e[0]?_a(s,ie(r,2)):[]}),$g=be(function(e){var r=Ir(e),s=Ye(e,Ta);return r=typeof r=="function"?r:i,r&&s.pop(),s.length&&s[0]===e[0]?_a(s,i,r):[]});function Ng(e,r){return e==null?"":Op.call(e,r)}function Ir(e){var r=e==null?0:e.length;return r?e[r-1]:i}function Dg(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var l=c;return s!==i&&(l=ye(s),l=l<0?$t(c+l,0):kt(l,c-1)),r===r?pp(e,r,l):An(e,Vc,l,!0)}function Fg(e,r){return e&&e.length?Iu(e,ye(r)):i}var qg=be(ph);function ph(e,r){return e&&e.length&&r&&r.length?Pa(e,r):e}function jg(e,r,s){return e&&e.length&&r&&r.length?Pa(e,r,ie(s,2)):e}function Lg(e,r,s){return e&&e.length&&r&&r.length?Pa(e,r,i,s):e}var Mg=Xr(function(e,r){var s=e==null?0:e.length,c=va(e,r);return Su(e,Ye(r,function(l){return ei(l,s)?+l:l}).sort(qu)),c});function zg(e,r){var s=[];if(!(e&&e.length))return s;var c=-1,l=[],d=e.length;for(r=ie(r,3);++c<d;){var w=e[c];r(w,c,e)&&(s.push(w),l.push(c))}return Su(e,l),s}function Ka(e){return e==null?e:Np.call(e)}function Ug(e,r,s){var c=e==null?0:e.length;return c?(s&&typeof s!="number"&&Yt(e,r,s)?(r=0,s=c):(r=r==null?0:ye(r),s=s===i?c:ye(s)),Er(e,r,s)):[]}function Hg(e,r){return Gn(e,r)}function kg(e,r,s){return Ra(e,r,ie(s,2))}function Bg(e,r){var s=e==null?0:e.length;if(s){var c=Gn(e,r);if(c<s&&$r(e[c],r))return c}return-1}function Kg(e,r){return Gn(e,r,!0)}function Vg(e,r,s){return Ra(e,r,ie(s,2),!0)}function Gg(e,r){var s=e==null?0:e.length;if(s){var c=Gn(e,r,!0)-1;if($r(e[c],r))return c}return-1}function Wg(e){return e&&e.length?Ru(e):[]}function Jg(e,r){return e&&e.length?Ru(e,ie(r,2)):[]}function Qg(e){var r=e==null?0:e.length;return r?Er(e,1,r):[]}function Yg(e,r,s){return e&&e.length?(r=s||r===i?1:ye(r),Er(e,0,r<0?0:r)):[]}function Zg(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:ye(r),r=c-r,Er(e,r<0?0:r,c)):[]}function Xg(e,r){return e&&e.length?Wn(e,ie(r,3),!1,!0):[]}function ey(e,r){return e&&e.length?Wn(e,ie(r,3)):[]}var ty=be(function(e){return mi(Ut(e,1,vt,!0))}),ry=be(function(e){var r=Ir(e);return vt(r)&&(r=i),mi(Ut(e,1,vt,!0),ie(r,2))}),iy=be(function(e){var r=Ir(e);return r=typeof r=="function"?r:i,mi(Ut(e,1,vt,!0),i,r)});function sy(e){return e&&e.length?mi(e):[]}function ny(e,r){return e&&e.length?mi(e,ie(r,2)):[]}function oy(e,r){return r=typeof r=="function"?r:i,e&&e.length?mi(e,i,r):[]}function Va(e){if(!(e&&e.length))return[];var r=0;return e=pi(e,function(s){if(vt(s))return r=$t(s.length,r),!0}),ua(r,function(s){return Ye(e,oa(s))})}function dh(e,r){if(!(e&&e.length))return[];var s=Va(e);return r==null?s:Ye(s,function(c){return Dt(r,i,c)})}var ay=be(function(e,r){return vt(e)?Ns(e,r):[]}),cy=be(function(e){return Ca(pi(e,vt))}),uy=be(function(e){var r=Ir(e);return vt(r)&&(r=i),Ca(pi(e,vt),ie(r,2))}),hy=be(function(e){var r=Ir(e);return r=typeof r=="function"?r:i,Ca(pi(e,vt),i,r)}),ly=be(Va);function fy(e,r){return $u(e||[],r||[],$s)}function py(e,r){return $u(e||[],r||[],qs)}var dy=be(function(e){var r=e.length,s=r>1?e[r-1]:i;return s=typeof s=="function"?(e.pop(),s):i,dh(e,s)});function gh(e){var r=f(e);return r.__chain__=!0,r}function gy(e,r){return r(e),e}function io(e,r){return r(e)}var yy=Xr(function(e){var r=e.length,s=r?e[0]:0,c=this.__wrapped__,l=function(d){return va(d,e)};return r>1||this.__actions__.length||!(c instanceof xe)||!ei(s)?this.thru(l):(c=c.slice(s,+s+(r?1:0)),c.__actions__.push({func:io,args:[l],thisArg:i}),new br(c,this.__chain__).thru(function(d){return r&&!d.length&&d.push(i),d}))});function vy(){return gh(this)}function my(){return new br(this.value(),this.__chain__)}function wy(){this.__values__===i&&(this.__values__=Oh(this.value()));var e=this.__index__>=this.__values__.length,r=e?i:this.__values__[this.__index__++];return{done:e,value:r}}function by(){return this}function _y(e){for(var r,s=this;s instanceof Hn;){var c=ch(s);c.__index__=0,c.__values__=i,r?l.__wrapped__=c:r=c;var l=c;s=s.__wrapped__}return l.__wrapped__=e,r}function Ey(){var e=this.__wrapped__;if(e instanceof xe){var r=e;return this.__actions__.length&&(r=new xe(this)),r=r.reverse(),r.__actions__.push({func:io,args:[Ka],thisArg:i}),new br(r,this.__chain__)}return this.thru(Ka)}function Iy(){return Tu(this.__wrapped__,this.__actions__)}var xy=Jn(function(e,r,s){De.call(e,s)?++e[s]:Yr(e,s,1)});function Py(e,r,s){var c=ge(e)?Bc:gd;return s&&Yt(e,r,s)&&(r=i),c(e,ie(r,3))}function Sy(e,r){var s=ge(e)?pi:du;return s(e,ie(r,3))}var Ay=Hu(uh),Ry=Hu(hh);function Oy(e,r){return Ut(so(e,r),1)}function Cy(e,r){return Ut(so(e,r),le)}function Ty(e,r,s){return s=s===i?1:ye(s),Ut(so(e,r),s)}function yh(e,r){var s=ge(e)?mr:vi;return s(e,ie(r,3))}function vh(e,r){var s=ge(e)?Qf:pu;return s(e,ie(r,3))}var $y=Jn(function(e,r,s){De.call(e,s)?e[s].push(r):Yr(e,s,[r])});function Ny(e,r,s,c){e=rr(e)?e:fs(e),s=s&&!c?ye(s):0;var l=e.length;return s<0&&(s=$t(l+s,0)),uo(e)?s<=l&&e.indexOf(r,s)>-1:!!l&&es(e,r,s)>-1}var Dy=be(function(e,r,s){var c=-1,l=typeof r=="function",d=rr(e)?T(e.length):[];return vi(e,function(w){d[++c]=l?Dt(r,w,s):Ds(w,r,s)}),d}),Fy=Jn(function(e,r,s){Yr(e,s,r)});function so(e,r){var s=ge(e)?Ye:bu;return s(e,ie(r,3))}function qy(e,r,s,c){return e==null?[]:(ge(r)||(r=r==null?[]:[r]),s=c?i:s,ge(s)||(s=s==null?[]:[s]),xu(e,r,s))}var jy=Jn(function(e,r,s){e[s?0:1].push(r)},function(){return[[],[]]});function Ly(e,r,s){var c=ge(e)?sa:Wc,l=arguments.length<3;return c(e,ie(r,4),s,l,vi)}function My(e,r,s){var c=ge(e)?Yf:Wc,l=arguments.length<3;return c(e,ie(r,4),s,l,pu)}function zy(e,r){var s=ge(e)?pi:du;return s(e,ao(ie(r,3)))}function Uy(e){var r=ge(e)?uu:Nd;return r(e)}function Hy(e,r,s){(s?Yt(e,r,s):r===i)?r=1:r=ye(r);var c=ge(e)?hd:Dd;return c(e,r)}function ky(e){var r=ge(e)?ld:qd;return r(e)}function By(e){if(e==null)return 0;if(rr(e))return uo(e)?rs(e):e.length;var r=Bt(e);return r==me||r==Te?e.size:Ia(e).length}function Ky(e,r,s){var c=ge(e)?na:jd;return s&&Yt(e,r,s)&&(r=i),c(e,ie(r,3))}var Vy=be(function(e,r){if(e==null)return[];var s=r.length;return s>1&&Yt(e,r[0],r[1])?r=[]:s>2&&Yt(r[0],r[1],r[2])&&(r=[r[0]]),xu(e,Ut(r,1),[])}),no=Sp||function(){return Pe.Date.now()};function Gy(e,r){if(typeof r!="function")throw new wr(p);return e=ye(e),function(){if(--e<1)return r.apply(this,arguments)}}function mh(e,r,s){return r=s?i:r,r=e&&r==null?e.length:r,Zr(e,Q,i,i,i,i,r)}function wh(e,r){var s;if(typeof r!="function")throw new wr(p);return e=ye(e),function(){return--e>0&&(s=r.apply(this,arguments)),e<=1&&(r=i),s}}var Ga=be(function(e,r,s){var c=re;if(s.length){var l=gi(s,hs(Ga));c|=he}return Zr(e,c,r,s,l)}),bh=be(function(e,r,s){var c=re|oe;if(s.length){var l=gi(s,hs(bh));c|=he}return Zr(r,c,e,s,l)});function _h(e,r,s){r=s?i:r;var c=Zr(e,ae,i,i,i,i,i,r);return c.placeholder=_h.placeholder,c}function Eh(e,r,s){r=s?i:r;var c=Zr(e,ee,i,i,i,i,i,r);return c.placeholder=Eh.placeholder,c}function Ih(e,r,s){var c,l,d,w,_,A,j=0,L=!1,z=!1,K=!0;if(typeof e!="function")throw new wr(p);r=xr(r)||0,it(s)&&(L=!!s.leading,z="maxWait"in s,d=z?$t(xr(s.maxWait)||0,r):d,K="trailing"in s?!!s.trailing:K);function X(mt){var Nr=c,ii=l;return c=l=i,j=mt,w=e.apply(ii,Nr),w}function se(mt){return j=mt,_=Ms(_e,r),L?X(mt):w}function we(mt){var Nr=mt-A,ii=mt-j,Hh=r-Nr;return z?kt(Hh,d-ii):Hh}function ne(mt){var Nr=mt-A,ii=mt-j;return A===i||Nr>=r||Nr<0||z&&ii>=d}function _e(){var mt=no();if(ne(mt))return Se(mt);_=Ms(_e,we(mt))}function Se(mt){return _=i,K&&c?X(mt):(c=l=i,w)}function dr(){_!==i&&Nu(_),j=0,c=A=l=_=i}function Zt(){return _===i?w:Se(no())}function gr(){var mt=no(),Nr=ne(mt);if(c=arguments,l=this,A=mt,Nr){if(_===i)return se(A);if(z)return Nu(_),_=Ms(_e,r),X(A)}return _===i&&(_=Ms(_e,r)),w}return gr.cancel=dr,gr.flush=Zt,gr}var Wy=be(function(e,r){return fu(e,1,r)}),Jy=be(function(e,r,s){return fu(e,xr(r)||0,s)});function Qy(e){return Zr(e,wt)}function oo(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new wr(p);var s=function(){var c=arguments,l=r?r.apply(this,c):c[0],d=s.cache;if(d.has(l))return d.get(l);var w=e.apply(this,c);return s.cache=d.set(l,w)||d,w};return s.cache=new(oo.Cache||Qr),s}oo.Cache=Qr;function ao(e){if(typeof e!="function")throw new wr(p);return function(){var r=arguments;switch(r.length){case 0:return!e.call(this);case 1:return!e.call(this,r[0]);case 2:return!e.call(this,r[0],r[1]);case 3:return!e.call(this,r[0],r[1],r[2])}return!e.apply(this,r)}}function Yy(e){return wh(2,e)}var Zy=Ld(function(e,r){r=r.length==1&&ge(r[0])?Ye(r[0],lr(ie())):Ye(Ut(r,1),lr(ie()));var s=r.length;return be(function(c){for(var l=-1,d=kt(c.length,s);++l<d;)c[l]=r[l].call(this,c[l]);return Dt(e,this,c)})}),Wa=be(function(e,r){var s=gi(r,hs(Wa));return Zr(e,he,i,r,s)}),xh=be(function(e,r){var s=gi(r,hs(xh));return Zr(e,pe,i,r,s)}),Xy=Xr(function(e,r){return Zr(e,ve,i,i,i,r)});function ev(e,r){if(typeof e!="function")throw new wr(p);return r=r===i?r:ye(r),be(e,r)}function tv(e,r){if(typeof e!="function")throw new wr(p);return r=r==null?0:$t(ye(r),0),be(function(s){var c=s[r],l=bi(s,0,r);return c&&di(l,c),Dt(e,this,l)})}function rv(e,r,s){var c=!0,l=!0;if(typeof e!="function")throw new wr(p);return it(s)&&(c="leading"in s?!!s.leading:c,l="trailing"in s?!!s.trailing:l),Ih(e,r,{leading:c,maxWait:r,trailing:l})}function iv(e){return mh(e,1)}function sv(e,r){return Wa($a(r),e)}function nv(){if(!arguments.length)return[];var e=arguments[0];return ge(e)?e:[e]}function ov(e){return _r(e,q)}function av(e,r){return r=typeof r=="function"?r:i,_r(e,q,r)}function cv(e){return _r(e,R|q)}function uv(e,r){return r=typeof r=="function"?r:i,_r(e,R|q,r)}function hv(e,r){return r==null||lu(e,r,Ft(r))}function $r(e,r){return e===r||e!==e&&r!==r}var lv=Xn(ba),fv=Xn(function(e,r){return e>=r}),Ui=vu(function(){return arguments}())?vu:function(e){return pt(e)&&De.call(e,"callee")&&!iu.call(e,"callee")},ge=T.isArray,pv=Jt?lr(Jt):_d;function rr(e){return e!=null&&co(e.length)&&!ti(e)}function vt(e){return pt(e)&&rr(e)}function dv(e){return e===!0||e===!1||pt(e)&&Qt(e)==$}var _i=Rp||nc,gv=Or?lr(Or):Ed;function yv(e){return pt(e)&&e.nodeType===1&&!zs(e)}function vv(e){if(e==null)return!0;if(rr(e)&&(ge(e)||typeof e=="string"||typeof e.splice=="function"||_i(e)||ls(e)||Ui(e)))return!e.length;var r=Bt(e);if(r==me||r==Te)return!e.size;if(Ls(e))return!Ia(e).length;for(var s in e)if(De.call(e,s))return!1;return!0}function mv(e,r){return Fs(e,r)}function wv(e,r,s){s=typeof s=="function"?s:i;var c=s?s(e,r):i;return c===i?Fs(e,r,i,s):!!c}function Ja(e){if(!pt(e))return!1;var r=Qt(e);return r==I||r==u||typeof e.message=="string"&&typeof e.name=="string"&&!zs(e)}function bv(e){return typeof e=="number"&&nu(e)}function ti(e){if(!it(e))return!1;var r=Qt(e);return r==Z||r==ue||r==D||r==dt}function Ph(e){return typeof e=="number"&&e==ye(e)}function co(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=H}function it(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function pt(e){return e!=null&&typeof e=="object"}var Sh=vr?lr(vr):xd;function _v(e,r){return e===r||Ea(e,r,Ma(r))}function Ev(e,r,s){return s=typeof s=="function"?s:i,Ea(e,r,Ma(r),s)}function Iv(e){return Ah(e)&&e!=+e}function xv(e){if(ag(e))throw new fe(h);return mu(e)}function Pv(e){return e===null}function Sv(e){return e==null}function Ah(e){return typeof e=="number"||pt(e)&&Qt(e)==Ae}function zs(e){if(!pt(e)||Qt(e)!=Ie)return!1;var r=Fn(e);if(r===null)return!0;var s=De.call(r,"constructor")&&r.constructor;return typeof s=="function"&&s instanceof s&&Tn.call(s)==Ep}var Qa=zr?lr(zr):Pd;function Av(e){return Ph(e)&&e>=-H&&e<=H}var Rh=Ps?lr(Ps):Sd;function uo(e){return typeof e=="string"||!ge(e)&&pt(e)&&Qt(e)==Be}function pr(e){return typeof e=="symbol"||pt(e)&&Qt(e)==Ke}var ls=Ni?lr(Ni):Ad;function Rv(e){return e===i}function Ov(e){return pt(e)&&Bt(e)==Fe}function Cv(e){return pt(e)&&Qt(e)==Ve}var Tv=Xn(xa),$v=Xn(function(e,r){return e<=r});function Oh(e){if(!e)return[];if(rr(e))return uo(e)?Cr(e):tr(e);if(As&&e[As])return hp(e[As]());var r=Bt(e),s=r==me?la:r==Te?Rn:fs;return s(e)}function ri(e){if(!e)return e===0?e:0;if(e=xr(e),e===le||e===-le){var r=e<0?-1:1;return r*U}return e===e?e:0}function ye(e){var r=ri(e),s=r%1;return r===r?s?r-s:r:0}function Ch(e){return e?ji(ye(e),0,B):0}function xr(e){if(typeof e=="number")return e;if(pr(e))return k;if(it(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=it(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=Jc(e);var s=zo.test(e);return s||Ho.test(e)?de(e.slice(2),s?2:8):Mo.test(e)?k:+e}function Th(e){return Hr(e,ir(e))}function Nv(e){return e?ji(ye(e),-H,H):e===0?e:0}function $e(e){return e==null?"":fr(e)}var Dv=cs(function(e,r){if(Ls(r)||rr(r)){Hr(r,Ft(r),e);return}for(var s in r)De.call(r,s)&&$s(e,s,r[s])}),$h=cs(function(e,r){Hr(r,ir(r),e)}),ho=cs(function(e,r,s,c){Hr(r,ir(r),e,c)}),Fv=cs(function(e,r,s,c){Hr(r,Ft(r),e,c)}),qv=Xr(va);function jv(e,r){var s=as(e);return r==null?s:hu(s,r)}var Lv=be(function(e,r){e=Ue(e);var s=-1,c=r.length,l=c>2?r[2]:i;for(l&&Yt(r[0],r[1],l)&&(c=1);++s<c;)for(var d=r[s],w=ir(d),_=-1,A=w.length;++_<A;){var j=w[_],L=e[j];(L===i||$r(L,ss[j])&&!De.call(e,j))&&(e[j]=d[j])}return e}),Mv=be(function(e){return e.push(i,Ju),Dt(Nh,i,e)});function zv(e,r){return Kc(e,ie(r,3),Ur)}function Uv(e,r){return Kc(e,ie(r,3),wa)}function Hv(e,r){return e==null?e:ma(e,ie(r,3),ir)}function kv(e,r){return e==null?e:gu(e,ie(r,3),ir)}function Bv(e,r){return e&&Ur(e,ie(r,3))}function Kv(e,r){return e&&wa(e,ie(r,3))}function Vv(e){return e==null?[]:Kn(e,Ft(e))}function Gv(e){return e==null?[]:Kn(e,ir(e))}function Ya(e,r,s){var c=e==null?i:Li(e,r);return c===i?s:c}function Wv(e,r){return e!=null&&Zu(e,r,vd)}function Za(e,r){return e!=null&&Zu(e,r,md)}var Jv=Bu(function(e,r,s){r!=null&&typeof r.toString!="function"&&(r=$n.call(r)),e[r]=s},ec(sr)),Qv=Bu(function(e,r,s){r!=null&&typeof r.toString!="function"&&(r=$n.call(r)),De.call(e,r)?e[r].push(s):e[r]=[s]},ie),Yv=be(Ds);function Ft(e){return rr(e)?cu(e):Ia(e)}function ir(e){return rr(e)?cu(e,!0):Rd(e)}function Zv(e,r){var s={};return r=ie(r,3),Ur(e,function(c,l,d){Yr(s,r(c,l,d),c)}),s}function Xv(e,r){var s={};return r=ie(r,3),Ur(e,function(c,l,d){Yr(s,l,r(c,l,d))}),s}var e0=cs(function(e,r,s){Vn(e,r,s)}),Nh=cs(function(e,r,s,c){Vn(e,r,s,c)}),t0=Xr(function(e,r){var s={};if(e==null)return s;var c=!1;r=Ye(r,function(d){return d=wi(d,e),c||(c=d.length>1),d}),Hr(e,ja(e),s),c&&(s=_r(s,R|N|q,Jd));for(var l=r.length;l--;)Oa(s,r[l]);return s});function r0(e,r){return Dh(e,ao(ie(r)))}var i0=Xr(function(e,r){return e==null?{}:Cd(e,r)});function Dh(e,r){if(e==null)return{};var s=Ye(ja(e),function(c){return[c]});return r=ie(r),Pu(e,s,function(c,l){return r(c,l[0])})}function s0(e,r,s){r=wi(r,e);var c=-1,l=r.length;for(l||(l=1,e=i);++c<l;){var d=e==null?i:e[kr(r[c])];d===i&&(c=l,d=s),e=ti(d)?d.call(e):d}return e}function n0(e,r,s){return e==null?e:qs(e,r,s)}function o0(e,r,s,c){return c=typeof c=="function"?c:i,e==null?e:qs(e,r,s,c)}var Fh=Gu(Ft),qh=Gu(ir);function a0(e,r,s){var c=ge(e),l=c||_i(e)||ls(e);if(r=ie(r,4),s==null){var d=e&&e.constructor;l?s=c?new d:[]:it(e)?s=ti(d)?as(Fn(e)):{}:s={}}return(l?mr:Ur)(e,function(w,_,A){return r(s,w,_,A)}),s}function c0(e,r){return e==null?!0:Oa(e,r)}function u0(e,r,s){return e==null?e:Cu(e,r,$a(s))}function h0(e,r,s,c){return c=typeof c=="function"?c:i,e==null?e:Cu(e,r,$a(s),c)}function fs(e){return e==null?[]:ha(e,Ft(e))}function l0(e){return e==null?[]:ha(e,ir(e))}function f0(e,r,s){return s===i&&(s=r,r=i),s!==i&&(s=xr(s),s=s===s?s:0),r!==i&&(r=xr(r),r=r===r?r:0),ji(xr(e),r,s)}function p0(e,r,s){return r=ri(r),s===i?(s=r,r=0):s=ri(s),e=xr(e),wd(e,r,s)}function d0(e,r,s){if(s&&typeof s!="boolean"&&Yt(e,r,s)&&(r=s=i),s===i&&(typeof r=="boolean"?(s=r,r=i):typeof e=="boolean"&&(s=e,e=i)),e===i&&r===i?(e=0,r=1):(e=ri(e),r===i?(r=e,e=0):r=ri(r)),e>r){var c=e;e=r,r=c}if(s||e%1||r%1){var l=ou();return kt(e+l*(r-e+Me("1e-"+((l+"").length-1))),r)}return Sa(e,r)}var g0=us(function(e,r,s){return r=r.toLowerCase(),e+(s?jh(r):r)});function jh(e){return Xa($e(e).toLowerCase())}function Lh(e){return e=$e(e),e&&e.replace(Gr,np).replace(ta,"")}function y0(e,r,s){e=$e(e),r=fr(r);var c=e.length;s=s===i?c:ji(ye(s),0,c);var l=s;return s-=r.length,s>=0&&e.slice(s,l)==r}function v0(e){return e=$e(e),e&&Je.test(e)?e.replace(Ri,op):e}function m0(e){return e=$e(e),e&&xt.test(e)?e.replace(ht,"\\$&"):e}var w0=us(function(e,r,s){return e+(s?"-":"")+r.toLowerCase()}),b0=us(function(e,r,s){return e+(s?" ":"")+r.toLowerCase()}),_0=Uu("toLowerCase");function E0(e,r,s){e=$e(e),r=ye(r);var c=r?rs(e):0;if(!r||c>=r)return e;var l=(r-c)/2;return Zn(Mn(l),s)+e+Zn(Ln(l),s)}function I0(e,r,s){e=$e(e),r=ye(r);var c=r?rs(e):0;return r&&c<r?e+Zn(r-c,s):e}function x0(e,r,s){e=$e(e),r=ye(r);var c=r?rs(e):0;return r&&c<r?Zn(r-c,s)+e:e}function P0(e,r,s){return s||r==null?r=0:r&&(r=+r),$p($e(e).replace(lt,""),r||0)}function S0(e,r,s){return(s?Yt(e,r,s):r===i)?r=1:r=ye(r),Aa($e(e),r)}function A0(){var e=arguments,r=$e(e[0]);return e.length<3?r:r.replace(e[1],e[2])}var R0=us(function(e,r,s){return e+(s?"_":"")+r.toLowerCase()});function O0(e,r,s){return s&&typeof s!="number"&&Yt(e,r,s)&&(r=s=i),s=s===i?B:s>>>0,s?(e=$e(e),e&&(typeof r=="string"||r!=null&&!Qa(r))&&(r=fr(r),!r&&ts(e))?bi(Cr(e),0,s):e.split(r,s)):[]}var C0=us(function(e,r,s){return e+(s?" ":"")+Xa(r)});function T0(e,r,s){return e=$e(e),s=s==null?0:ji(ye(s),0,e.length),r=fr(r),e.slice(s,s+r.length)==r}function $0(e,r,s){var c=f.templateSettings;s&&Yt(e,r,s)&&(r=i),e=$e(e),r=ho({},r,c,Wu);var l=ho({},r.imports,c.imports,Wu),d=Ft(l),w=ha(l,d),_,A,j=0,L=r.interpolate||Gi,z="__p += '",K=fa((r.escape||Gi).source+"|"+L.source+"|"+(L===rt?Lo:Gi).source+"|"+(r.evaluate||Gi).source+"|$","g"),X="//# sourceURL="+(De.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ra+"]")+`
`;e.replace(K,function(ne,_e,Se,dr,Zt,gr){return Se||(Se=dr),z+=e.slice(j,gr).replace(Bo,ap),_e&&(_=!0,z+=`' +
__e(`+_e+`) +
'`),Zt&&(A=!0,z+=`';
`+Zt+`;
__p += '`),Se&&(z+=`' +
((__t = (`+Se+`)) == null ? '' : __t) +
'`),j=gr+ne.length,ne}),z+=`';
`;var se=De.call(r,"variable")&&r.variable;if(!se)z=`with (obj) {
`+z+`
}
`;else if(qo.test(se))throw new fe(y);z=(A?z.replace(Lr,""):z).replace(Wt,"$1").replace(Vr,"$1;"),z="function("+(se||"obj")+`) {
`+(se?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(A?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+z+`return __p
}`;var we=zh(function(){return Ce(d,X+"return "+z).apply(i,w)});if(we.source=z,Ja(we))throw we;return we}function N0(e){return $e(e).toLowerCase()}function D0(e){return $e(e).toUpperCase()}function F0(e,r,s){if(e=$e(e),e&&(s||r===i))return Jc(e);if(!e||!(r=fr(r)))return e;var c=Cr(e),l=Cr(r),d=Qc(c,l),w=Yc(c,l)+1;return bi(c,d,w).join("")}function q0(e,r,s){if(e=$e(e),e&&(s||r===i))return e.slice(0,Xc(e)+1);if(!e||!(r=fr(r)))return e;var c=Cr(e),l=Yc(c,Cr(r))+1;return bi(c,0,l).join("")}function j0(e,r,s){if(e=$e(e),e&&(s||r===i))return e.replace(lt,"");if(!e||!(r=fr(r)))return e;var c=Cr(e),l=Qc(c,Cr(r));return bi(c,l).join("")}function L0(e,r){var s=st,c=ke;if(it(r)){var l="separator"in r?r.separator:l;s="length"in r?ye(r.length):s,c="omission"in r?fr(r.omission):c}e=$e(e);var d=e.length;if(ts(e)){var w=Cr(e);d=w.length}if(s>=d)return e;var _=s-rs(c);if(_<1)return c;var A=w?bi(w,0,_).join(""):e.slice(0,_);if(l===i)return A+c;if(w&&(_+=A.length-_),Qa(l)){if(e.slice(_).search(l)){var j,L=A;for(l.global||(l=fa(l.source,$e(yr.exec(l))+"g")),l.lastIndex=0;j=l.exec(L);)var z=j.index;A=A.slice(0,z===i?_:z)}}else if(e.indexOf(fr(l),_)!=_){var K=A.lastIndexOf(l);K>-1&&(A=A.slice(0,K))}return A+c}function M0(e){return e=$e(e),e&&at.test(e)?e.replace(li,dp):e}var z0=us(function(e,r,s){return e+(s?" ":"")+r.toUpperCase()}),Xa=Uu("toUpperCase");function Mh(e,r,s){return e=$e(e),r=s?i:r,r===i?up(e)?vp(e):ep(e):e.match(r)||[]}var zh=be(function(e,r){try{return Dt(e,i,r)}catch(s){return Ja(s)?s:new fe(s)}}),U0=Xr(function(e,r){return mr(r,function(s){s=kr(s),Yr(e,s,Ga(e[s],e))}),e});function H0(e){var r=e==null?0:e.length,s=ie();return e=r?Ye(e,function(c){if(typeof c[1]!="function")throw new wr(p);return[s(c[0]),c[1]]}):[],be(function(c){for(var l=-1;++l<r;){var d=e[l];if(Dt(d[0],this,c))return Dt(d[1],this,c)}})}function k0(e){return dd(_r(e,R))}function ec(e){return function(){return e}}function B0(e,r){return e==null||e!==e?r:e}var K0=ku(),V0=ku(!0);function sr(e){return e}function tc(e){return wu(typeof e=="function"?e:_r(e,R))}function G0(e){return _u(_r(e,R))}function W0(e,r){return Eu(e,_r(r,R))}var J0=be(function(e,r){return function(s){return Ds(s,e,r)}}),Q0=be(function(e,r){return function(s){return Ds(e,s,r)}});function rc(e,r,s){var c=Ft(r),l=Kn(r,c);s==null&&!(it(r)&&(l.length||!c.length))&&(s=r,r=e,e=this,l=Kn(r,Ft(r)));var d=!(it(s)&&"chain"in s)||!!s.chain,w=ti(e);return mr(l,function(_){var A=r[_];e[_]=A,w&&(e.prototype[_]=function(){var j=this.__chain__;if(d||j){var L=e(this.__wrapped__),z=L.__actions__=tr(this.__actions__);return z.push({func:A,args:arguments,thisArg:e}),L.__chain__=j,L}return A.apply(e,di([this.value()],arguments))})}),e}function Y0(){return Pe._===this&&(Pe._=Ip),this}function ic(){}function Z0(e){return e=ye(e),be(function(r){return Iu(r,e)})}var X0=Da(Ye),em=Da(Bc),tm=Da(na);function Uh(e){return Ua(e)?oa(kr(e)):Td(e)}function rm(e){return function(r){return e==null?i:Li(e,r)}}var im=Ku(),sm=Ku(!0);function sc(){return[]}function nc(){return!1}function nm(){return{}}function om(){return""}function am(){return!0}function cm(e,r){if(e=ye(e),e<1||e>H)return[];var s=B,c=kt(e,B);r=ie(r),e-=B;for(var l=ua(c,r);++s<e;)r(s);return l}function um(e){return ge(e)?Ye(e,kr):pr(e)?[e]:tr(ah($e(e)))}function hm(e){var r=++_p;return $e(e)+r}var lm=Yn(function(e,r){return e+r},0),fm=Fa("ceil"),pm=Yn(function(e,r){return e/r},1),dm=Fa("floor");function gm(e){return e&&e.length?Bn(e,sr,ba):i}function ym(e,r){return e&&e.length?Bn(e,ie(r,2),ba):i}function vm(e){return Gc(e,sr)}function mm(e,r){return Gc(e,ie(r,2))}function wm(e){return e&&e.length?Bn(e,sr,xa):i}function bm(e,r){return e&&e.length?Bn(e,ie(r,2),xa):i}var _m=Yn(function(e,r){return e*r},1),Em=Fa("round"),Im=Yn(function(e,r){return e-r},0);function xm(e){return e&&e.length?ca(e,sr):0}function Pm(e,r){return e&&e.length?ca(e,ie(r,2)):0}return f.after=Gy,f.ary=mh,f.assign=Dv,f.assignIn=$h,f.assignInWith=ho,f.assignWith=Fv,f.at=qv,f.before=wh,f.bind=Ga,f.bindAll=U0,f.bindKey=bh,f.castArray=nv,f.chain=gh,f.chunk=dg,f.compact=gg,f.concat=yg,f.cond=H0,f.conforms=k0,f.constant=ec,f.countBy=xy,f.create=jv,f.curry=_h,f.curryRight=Eh,f.debounce=Ih,f.defaults=Lv,f.defaultsDeep=Mv,f.defer=Wy,f.delay=Jy,f.difference=vg,f.differenceBy=mg,f.differenceWith=wg,f.drop=bg,f.dropRight=_g,f.dropRightWhile=Eg,f.dropWhile=Ig,f.fill=xg,f.filter=Sy,f.flatMap=Oy,f.flatMapDeep=Cy,f.flatMapDepth=Ty,f.flatten=lh,f.flattenDeep=Pg,f.flattenDepth=Sg,f.flip=Qy,f.flow=K0,f.flowRight=V0,f.fromPairs=Ag,f.functions=Vv,f.functionsIn=Gv,f.groupBy=$y,f.initial=Og,f.intersection=Cg,f.intersectionBy=Tg,f.intersectionWith=$g,f.invert=Jv,f.invertBy=Qv,f.invokeMap=Dy,f.iteratee=tc,f.keyBy=Fy,f.keys=Ft,f.keysIn=ir,f.map=so,f.mapKeys=Zv,f.mapValues=Xv,f.matches=G0,f.matchesProperty=W0,f.memoize=oo,f.merge=e0,f.mergeWith=Nh,f.method=J0,f.methodOf=Q0,f.mixin=rc,f.negate=ao,f.nthArg=Z0,f.omit=t0,f.omitBy=r0,f.once=Yy,f.orderBy=qy,f.over=X0,f.overArgs=Zy,f.overEvery=em,f.overSome=tm,f.partial=Wa,f.partialRight=xh,f.partition=jy,f.pick=i0,f.pickBy=Dh,f.property=Uh,f.propertyOf=rm,f.pull=qg,f.pullAll=ph,f.pullAllBy=jg,f.pullAllWith=Lg,f.pullAt=Mg,f.range=im,f.rangeRight=sm,f.rearg=Xy,f.reject=zy,f.remove=zg,f.rest=ev,f.reverse=Ka,f.sampleSize=Hy,f.set=n0,f.setWith=o0,f.shuffle=ky,f.slice=Ug,f.sortBy=Vy,f.sortedUniq=Wg,f.sortedUniqBy=Jg,f.split=O0,f.spread=tv,f.tail=Qg,f.take=Yg,f.takeRight=Zg,f.takeRightWhile=Xg,f.takeWhile=ey,f.tap=gy,f.throttle=rv,f.thru=io,f.toArray=Oh,f.toPairs=Fh,f.toPairsIn=qh,f.toPath=um,f.toPlainObject=Th,f.transform=a0,f.unary=iv,f.union=ty,f.unionBy=ry,f.unionWith=iy,f.uniq=sy,f.uniqBy=ny,f.uniqWith=oy,f.unset=c0,f.unzip=Va,f.unzipWith=dh,f.update=u0,f.updateWith=h0,f.values=fs,f.valuesIn=l0,f.without=ay,f.words=Mh,f.wrap=sv,f.xor=cy,f.xorBy=uy,f.xorWith=hy,f.zip=ly,f.zipObject=fy,f.zipObjectDeep=py,f.zipWith=dy,f.entries=Fh,f.entriesIn=qh,f.extend=$h,f.extendWith=ho,rc(f,f),f.add=lm,f.attempt=zh,f.camelCase=g0,f.capitalize=jh,f.ceil=fm,f.clamp=f0,f.clone=ov,f.cloneDeep=cv,f.cloneDeepWith=uv,f.cloneWith=av,f.conformsTo=hv,f.deburr=Lh,f.defaultTo=B0,f.divide=pm,f.endsWith=y0,f.eq=$r,f.escape=v0,f.escapeRegExp=m0,f.every=Py,f.find=Ay,f.findIndex=uh,f.findKey=zv,f.findLast=Ry,f.findLastIndex=hh,f.findLastKey=Uv,f.floor=dm,f.forEach=yh,f.forEachRight=vh,f.forIn=Hv,f.forInRight=kv,f.forOwn=Bv,f.forOwnRight=Kv,f.get=Ya,f.gt=lv,f.gte=fv,f.has=Wv,f.hasIn=Za,f.head=fh,f.identity=sr,f.includes=Ny,f.indexOf=Rg,f.inRange=p0,f.invoke=Yv,f.isArguments=Ui,f.isArray=ge,f.isArrayBuffer=pv,f.isArrayLike=rr,f.isArrayLikeObject=vt,f.isBoolean=dv,f.isBuffer=_i,f.isDate=gv,f.isElement=yv,f.isEmpty=vv,f.isEqual=mv,f.isEqualWith=wv,f.isError=Ja,f.isFinite=bv,f.isFunction=ti,f.isInteger=Ph,f.isLength=co,f.isMap=Sh,f.isMatch=_v,f.isMatchWith=Ev,f.isNaN=Iv,f.isNative=xv,f.isNil=Sv,f.isNull=Pv,f.isNumber=Ah,f.isObject=it,f.isObjectLike=pt,f.isPlainObject=zs,f.isRegExp=Qa,f.isSafeInteger=Av,f.isSet=Rh,f.isString=uo,f.isSymbol=pr,f.isTypedArray=ls,f.isUndefined=Rv,f.isWeakMap=Ov,f.isWeakSet=Cv,f.join=Ng,f.kebabCase=w0,f.last=Ir,f.lastIndexOf=Dg,f.lowerCase=b0,f.lowerFirst=_0,f.lt=Tv,f.lte=$v,f.max=gm,f.maxBy=ym,f.mean=vm,f.meanBy=mm,f.min=wm,f.minBy=bm,f.stubArray=sc,f.stubFalse=nc,f.stubObject=nm,f.stubString=om,f.stubTrue=am,f.multiply=_m,f.nth=Fg,f.noConflict=Y0,f.noop=ic,f.now=no,f.pad=E0,f.padEnd=I0,f.padStart=x0,f.parseInt=P0,f.random=d0,f.reduce=Ly,f.reduceRight=My,f.repeat=S0,f.replace=A0,f.result=s0,f.round=Em,f.runInContext=P,f.sample=Uy,f.size=By,f.snakeCase=R0,f.some=Ky,f.sortedIndex=Hg,f.sortedIndexBy=kg,f.sortedIndexOf=Bg,f.sortedLastIndex=Kg,f.sortedLastIndexBy=Vg,f.sortedLastIndexOf=Gg,f.startCase=C0,f.startsWith=T0,f.subtract=Im,f.sum=xm,f.sumBy=Pm,f.template=$0,f.times=cm,f.toFinite=ri,f.toInteger=ye,f.toLength=Ch,f.toLower=N0,f.toNumber=xr,f.toSafeInteger=Nv,f.toString=$e,f.toUpper=D0,f.trim=F0,f.trimEnd=q0,f.trimStart=j0,f.truncate=L0,f.unescape=M0,f.uniqueId=hm,f.upperCase=z0,f.upperFirst=Xa,f.each=yh,f.eachRight=vh,f.first=fh,rc(f,function(){var e={};return Ur(f,function(r,s){De.call(f.prototype,s)||(e[s]=r)}),e}(),{chain:!1}),f.VERSION=n,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),mr(["drop","take"],function(e,r){xe.prototype[e]=function(s){s=s===i?1:$t(ye(s),0);var c=this.__filtered__&&!r?new xe(this):this.clone();return c.__filtered__?c.__takeCount__=kt(s,c.__takeCount__):c.__views__.push({size:kt(s,B),type:e+(c.__dir__<0?"Right":"")}),c},xe.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),mr(["filter","map","takeWhile"],function(e,r){var s=r+1,c=s==b||s==J;xe.prototype[e]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ie(l,3),type:s}),d.__filtered__=d.__filtered__||c,d}}),mr(["head","last"],function(e,r){var s="take"+(r?"Right":"");xe.prototype[e]=function(){return this[s](1).value()[0]}}),mr(["initial","tail"],function(e,r){var s="drop"+(r?"":"Right");xe.prototype[e]=function(){return this.__filtered__?new xe(this):this[s](1)}}),xe.prototype.compact=function(){return this.filter(sr)},xe.prototype.find=function(e){return this.filter(e).head()},xe.prototype.findLast=function(e){return this.reverse().find(e)},xe.prototype.invokeMap=be(function(e,r){return typeof e=="function"?new xe(this):this.map(function(s){return Ds(s,e,r)})}),xe.prototype.reject=function(e){return this.filter(ao(ie(e)))},xe.prototype.slice=function(e,r){e=ye(e);var s=this;return s.__filtered__&&(e>0||r<0)?new xe(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),r!==i&&(r=ye(r),s=r<0?s.dropRight(-r):s.take(r-e)),s)},xe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},xe.prototype.toArray=function(){return this.take(B)},Ur(xe.prototype,function(e,r){var s=/^(?:filter|find|map|reject)|While$/.test(r),c=/^(?:head|last)$/.test(r),l=f[c?"take"+(r=="last"?"Right":""):r],d=c||/^find/.test(r);l&&(f.prototype[r]=function(){var w=this.__wrapped__,_=c?[1]:arguments,A=w instanceof xe,j=_[0],L=A||ge(w),z=function(_e){var Se=l.apply(f,di([_e],_));return c&&K?Se[0]:Se};L&&s&&typeof j=="function"&&j.length!=1&&(A=L=!1);var K=this.__chain__,X=!!this.__actions__.length,se=d&&!K,we=A&&!X;if(!d&&L){w=we?w:new xe(this);var ne=e.apply(w,_);return ne.__actions__.push({func:io,args:[z],thisArg:i}),new br(ne,K)}return se&&we?e.apply(this,_):(ne=this.thru(z),se?c?ne.value()[0]:ne.value():ne)})}),mr(["pop","push","shift","sort","splice","unshift"],function(e){var r=On[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return r.apply(ge(d)?d:[],l)}return this[s](function(w){return r.apply(ge(w)?w:[],l)})}}),Ur(xe.prototype,function(e,r){var s=f[r];if(s){var c=s.name+"";De.call(os,c)||(os[c]=[]),os[c].push({name:r,func:s})}}),os[Qn(i,oe).name]=[{name:"wrapper",func:i}],xe.prototype.clone=Mp,xe.prototype.reverse=zp,xe.prototype.value=Up,f.prototype.at=yy,f.prototype.chain=vy,f.prototype.commit=my,f.prototype.next=wy,f.prototype.plant=_y,f.prototype.reverse=Ey,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=Iy,f.prototype.first=f.prototype.head,As&&(f.prototype[As]=by),f},is=mp();yt?((yt.exports=is)._=is,ze._=is):Pe._=is}).call(Gs)})(Cc,Cc.exports);var II=Object.defineProperty,xI=Object.defineProperties,PI=Object.getOwnPropertyDescriptors,Gl=Object.getOwnPropertySymbols,SI=Object.prototype.hasOwnProperty,AI=Object.prototype.propertyIsEnumerable,Wl=(a,t,i)=>t in a?II(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,vo=(a,t)=>{for(var i in t||(t={}))SI.call(t,i)&&Wl(a,i,t[i]);if(Gl)for(var i of Gl(t))AI.call(t,i)&&Wl(a,i,t[i]);return a},RI=(a,t)=>xI(a,PI(t));function Pi(a,t,i){var n;const o=l1(a);return((n=t.rpcMap)==null?void 0:n[o.reference])||`${EI}?chainId=${o.namespace}:${o.reference}&projectId=${i}`}function Vi(a){return a.includes(":")?a.split(":")[1]:a}function Gf(a){return a.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function OI(a,t){const i=Object.keys(t.namespaces).filter(o=>o.includes(a));if(!i.length)return[];const n=[];return i.forEach(o=>{const h=t.namespaces[o].accounts;n.push(...h)}),n}function CI(a={},t={}){const i=Jl(a),n=Jl(t);return Cc.exports.merge(i,n)}function Jl(a){var t,i,n,o;const h={};if(!bo(a))return h;for(const[p,y]of Object.entries(a)){const m=hf(p)?[p]:y.chains,g=y.methods||[],E=y.events||[],R=y.rpcMap||{},N=Ws(p);h[N]=RI(vo(vo({},h[N]),y),{chains:ac(m,(t=h[N])==null?void 0:t.chains),methods:ac(g,(i=h[N])==null?void 0:i.methods),events:ac(E,(n=h[N])==null?void 0:n.events),rpcMap:vo(vo({},R),(o=h[N])==null?void 0:o.rpcMap)})}return h}function TI(a){return a.includes(":")?a.split(":")[2]:a}function $I(a){const t={};for(const[i,n]of Object.entries(a)){const o=n.methods||[],h=n.events||[],p=n.accounts||[],y=hf(i)?[i]:n.chains?n.chains:Gf(n.accounts);t[i]={chains:y,methods:o,events:h,accounts:p}}return t}function mc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Wf={},Ze=a=>Wf[a],wc=(a,t)=>{Wf[a]=t};class NI{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const o=Vi(i);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,Ze("disableProviderPing")))}}class DI{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(parseInt(t),i),this.chainId=parseInt(t),this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,i){const n=i||Pi(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,Ze("disableProviderPing")))}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const o=parseInt(Vi(i));t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}async handleSwitchChain(t){var i,n;let o=t.request.params?(i=t.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class FI{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const o=Vi(i);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,Ze("disableProviderPing")))}}class qI{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const o=Vi(i);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,Ze("disableProviderPing")))}}class jI{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{const n=this.getCardanoRPCUrl(i),o=Vi(i);t[o]=this.createHttpProvider(o,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}getCardanoRPCUrl(t){const i=this.namespace.rpcMap;if(i)return i[t]}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,Ze("disableProviderPing")))}}class LI{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const o=Vi(i);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,Ze("disableProviderPing")))}}class MI{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){this.httpProviders[t]||this.setHttpProvider(t,i),this.chainId=t,this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const o=Vi(i);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Pi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new ui(new Si(n,Ze("disableProviderPing")))}}class zI{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const n=i||Pi(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(hi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;t[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Pi(t,this.namespace);return typeof n>"u"?void 0:new ui(new Si(n,Ze("disableProviderPing")))}}var UI=Object.defineProperty,HI=Object.defineProperties,kI=Object.getOwnPropertyDescriptors,Ql=Object.getOwnPropertySymbols,BI=Object.prototype.hasOwnProperty,KI=Object.prototype.propertyIsEnumerable,Yl=(a,t,i)=>t in a?UI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,mo=(a,t)=>{for(var i in t||(t={}))BI.call(t,i)&&Yl(a,i,t[i]);if(Ql)for(var i of Ql(t))KI.call(t,i)&&Yl(a,i,t[i]);return a},bc=(a,t)=>HI(a,kI(t));class Hc{constructor(t){this.events=new Dc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Oo(Co({level:(t==null?void 0:t.logger)||Kl})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const i=new Hc(t);return await i.initialize(),i}async request(t,i){const[n,o]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:mo({},t),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(t,i,n){const o=new Date().getTime();this.request(t,n).then(h=>i(null,To(o,h))).catch(h=>i(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Kt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}removeListener(t,i){this.events.removeListener(t,i)}off(t,i){this.events.off(t,i)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=$I(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Kf)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,i){try{if(!this.session)return;const[n,o]=this.validateChain(t);this.getProvider(n).setDefaultChain(o,i)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(bs(i)){for(const n of i)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await hI.init({logger:this.providerOpts.logger||Kl,relayUrl:this.providerOpts.relayUrl||wI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(i=>Ws(i)))];wc("client",this.client),wc("events",this.events),wc("disableProviderPing",this.disableProviderPing),t.forEach(i=>{if(!this.session)return;const n=OI(i,this.session),o=Gf(n),h=CI(this.namespaces,this.optionalNamespaces),p=bc(mo({},h[i]),{accounts:n,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new DI({namespace:p});break;case"solana":this.rpcProviders[i]=new FI({namespace:p});break;case"cosmos":this.rpcProviders[i]=new qI({namespace:p});break;case"polkadot":this.rpcProviders[i]=new NI({namespace:p});break;case"cip34":this.rpcProviders[i]=new jI({namespace:p});break;case"elrond":this.rpcProviders[i]=new LI({namespace:p});break;case"multiversx":this.rpcProviders[i]=new MI({namespace:p});break;case"near":this.rpcProviders[i]=new zI({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:i}=t,{event:n}=i;if(n.name==="accountsChanged"){const o=n.data;o&&bs(o)&&this.events.emit("accountsChanged",o.map(TI))}else if(n.name==="chainChanged"){const o=i.chainId,h=i.event.data,p=Ws(o),y=mc(o)!==mc(h)?`${p}:${mc(h)}`:o;this.onChainChanged(y)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:i})=>{var n;const{namespaces:o}=i,h=(n=this.client)==null?void 0:n.session.get(t);this.session=bc(mo({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:i})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",bc(mo({},Kt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(hi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var i;this.getProvider(t).updateNamespace((i=this.session)==null?void 0:i.namespaces[t])})}setNamespaces(t){const{namespaces:i,optionalNamespaces:n,sessionProperties:o}=t;i&&Object.keys(i).length&&(this.namespaces=i),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",n)}validateChain(t){const[i,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,n];if(i&&!Object.keys(this.namespaces||{}).map(p=>Ws(p)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&n)return[i,n];const o=Ws(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,i=!1){var n;if(!this.namespaces)return;const[o,h]=this.validateChain(t);i||this.getProvider(o).setDefaultChain(h),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,i){this.client.core.storage.setItem(`${Vl}/${t}`,i)}async getFromStore(t){return await this.client.core.storage.getItem(`${Vl}/${t}`)}}const VI=Hc,GI="wc",WI="ethereum_provider",JI=`${GI}@2:${WI}:`,QI="https://rpc.walletconnect.com/v1/",Tc=["eth_sendTransaction","personal_sign"],YI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],$c=["chainChanged","accountsChanged"],ZI=["chainChanged","accountsChanged","message","disconnect","connect"];var XI=Object.defineProperty,ex=Object.defineProperties,tx=Object.getOwnPropertyDescriptors,Zl=Object.getOwnPropertySymbols,rx=Object.prototype.hasOwnProperty,ix=Object.prototype.propertyIsEnumerable,Xl=(a,t,i)=>t in a?XI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,Qs=(a,t)=>{for(var i in t||(t={}))rx.call(t,i)&&Xl(a,i,t[i]);if(Zl)for(var i of Zl(t))ix.call(t,i)&&Xl(a,i,t[i]);return a},ef=(a,t)=>ex(a,tx(t));function Po(a){return Number(a[0].split(":")[1])}function _c(a){return`0x${a.toString(16)}`}function sx(a){const{chains:t,optionalChains:i,methods:n,optionalMethods:o,events:h,optionalEvents:p,rpcMap:y}=a;if(!bs(t))throw new Error("Invalid chains");const m={chains:t,methods:n||Tc,events:h||$c,rpcMap:Qs({},t.length?{[Po(t)]:y[Po(t)]}:{})},g=h==null?void 0:h.filter(q=>!$c.includes(q)),E=n==null?void 0:n.filter(q=>!Tc.includes(q));if(!i&&!p&&!o&&!(g!=null&&g.length)&&!(E!=null&&E.length))return{required:t.length?m:void 0};const R=(g==null?void 0:g.length)&&(E==null?void 0:E.length)||!i,N={chains:[...new Set(R?m.chains.concat(i||[]):i)],methods:[...new Set(m.methods.concat(o!=null&&o.length?o:YI))],events:[...new Set(m.events.concat(p!=null&&p.length?p:ZI))],rpcMap:y};return{required:t.length?m:void 0,optional:i.length?N:void 0}}class kc{constructor(){this.events=new Sr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=JI,this.on=(t,i)=>(this.events.on(t,i),this),this.once=(t,i)=>(this.events.once(t,i),this),this.removeListener=(t,i)=>(this.events.removeListener(t,i),this),this.off=(t,i)=>(this.events.off(t,i),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const i=new kc;return await i.initialize(t),i}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,i){this.signer.sendAsync(t,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:i,optional:n}=sx(this.rpc);try{const o=await new Promise(async(p,y)=>{var m;this.rpc.showQrModal&&((m=this.modal)==null||m.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),y(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(ef(Qs({namespaces:Qs({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(g=>{p(g)}).catch(g=>{y(new Error(g.message))})});if(!o)return;const h=f1(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:_c(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:i}=t,{event:n}=i;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const i=parseInt(t);this.chainId=i,this.events.emit("chainChanged",_c(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",ef(Qs({},Kt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var i,n;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const i=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",_c(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const i=this.parseChainId(t);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(t){const[i,n,o]=t.split(":");return{chainId:`${i}:${n}`,address:o}}setAccounts(t){this.accounts=t.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var i,n;const o=(i=t==null?void 0:t.chains)!=null?i:[],h=(n=t==null?void 0:t.optionalChains)!=null?n:[],p=o.concat(h);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const y=o.length?(t==null?void 0:t.methods)||Tc:[],m=o.length?(t==null?void 0:t.events)||$c:[],g=(t==null?void 0:t.optionalMethods)||[],E=(t==null?void 0:t.optionalEvents)||[],R=(t==null?void 0:t.rpcMap)||this.buildRpcMap(p,t.projectId),N=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(q=>this.formatChainId(q)),optionalChains:h.map(q=>this.formatChainId(q)),methods:y,events:m,optionalMethods:g,optionalEvents:E,rpcMap:R,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:N,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,i){const n={};return t.forEach(o=>{n[o]=this.getRpcUrl(o,i)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Po(this.rpc.chains):Po(this.rpc.optionalChains),this.signer=await VI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:n}=await p1(()=>import("./index-6acd9cc1.js").then(o=>o.i),["./index-6acd9cc1.js","./index-b9e86077.js","./index-09d4cee0.css"],import.meta.url);i=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Qs({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:i,optionalChains:n,rpcMap:o}=t;i&&bs(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),n&&bs(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(t,i){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${QI}?chainId=eip155:${t}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(i=>this.parseAccount(i))}}const Ex=kc;export{Ex as EthereumProvider,ZI as OPTIONAL_EVENTS,YI as OPTIONAL_METHODS,$c as REQUIRED_EVENTS,Tc as REQUIRED_METHODS,kc as default};
