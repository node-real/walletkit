import{e as ur,r as bi,f as o1,h as se,i as Sr,j as a1,w as ql,k as Ml,m as yc,t as yo,o as c1,p as jl,q as wi,D as u1,s as h1,N as Z,u as l1,v as cc,x as f1,V as p1,R as d1,F as Rh,K as g1,y as y1,L as v1,z as Ch,$ as m1,A as w1,B as Qs,Z as Oh,J as _1,X as b1,C as vc,_ as Ul,E as Fr,G as E1,H as x1,I as us,M as Ft,U as er,O as mi,P as cr,Q as I1,S as hs,T as zl,W as P1,Y as S1,a0 as A1,a1 as kl,a2 as R1,a3 as Hl,a4 as Bl,a5 as fs,a6 as uc,a7 as uo,a8 as ds,a9 as C1,aa as ho,ab as O1,ac as T1,ad as N1,ae as no,af as F1,ag as D1,ah as Ka,ai as Th,aj as L1,ak as $1,al as q1,am as Nh,an as M1,ao as j1,ap as U1,aq as z1,ar as k1,as as H1,at as B1,au as Ks,av as Vl,aw as Ga,ax as V1,ay as K1,az as G1}from"./index-28437983.js";var vo={},Xs={};Object.defineProperty(Xs,"__esModule",{value:!0});function W1(u){if(typeof u!="string")throw new Error(`Cannot safe json parse value of type ${typeof u}`);try{return JSON.parse(u)}catch{return u}}Xs.safeJsonParse=W1;function J1(u){return typeof u=="string"?u:JSON.stringify(u,(i,r)=>typeof r>"u"?null:r)}Xs.safeJsonStringify=J1;var $s={exports:{}},Fh;function Q1(){return Fh||(Fh=1,function(){let u;function i(){}u=i,u.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},u.prototype.setItem=function(r,n){this[r]=String(n)},u.prototype.removeItem=function(r){delete this[r]},u.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},u.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},u.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ur<"u"&&ur.localStorage?$s.exports=ur.localStorage:typeof window<"u"&&window.localStorage?$s.exports=window.localStorage:$s.exports=new i}()),$s.exports}var Wa={},qs={},Dh;function Y1(){if(Dh)return qs;Dh=1,Object.defineProperty(qs,"__esModule",{value:!0}),qs.IKeyValueStorage=void 0;class u{}return qs.IKeyValueStorage=u,qs}var Ms={},Lh;function X1(){if(Lh)return Ms;Lh=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.parseEntry=void 0;const u=Xs;function i(r){var n;return[r[0],u.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return Ms.parseEntry=i,Ms}var $h;function Z1(){return $h||($h=1,function(u){Object.defineProperty(u,"__esModule",{value:!0});const i=bi;i.__exportStar(Y1(),u),i.__exportStar(X1(),u)}(Wa)),Wa}Object.defineProperty(vo,"__esModule",{value:!0});vo.KeyValueStorage=void 0;const ls=bi,qh=Xs,em=ls.__importDefault(Q1()),tm=Z1();class Kl{constructor(){this.localStorage=em.default}getKeys(){return ls.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return ls.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(tm.parseEntry)})}getItem(i){return ls.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(i);if(r!==null)return qh.safeJsonParse(r)})}setItem(i,r){return ls.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(i,qh.safeJsonStringify(r))})}removeItem(i){return ls.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(i)})}}vo.KeyValueStorage=Kl;var rm=vo.default=Kl,gs={},js={},Ja={},Us={};let Ui=class{};const im=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ui},Symbol.toStringTag,{value:"Module"})),sm=o1(im);var Mh;function nm(){if(Mh)return Us;Mh=1,Object.defineProperty(Us,"__esModule",{value:!0}),Us.IHeartBeat=void 0;const u=sm;class i extends u.IEvents{constructor(n){super()}}return Us.IHeartBeat=i,Us}var jh;function Gl(){return jh||(jh=1,function(u){Object.defineProperty(u,"__esModule",{value:!0}),bi.__exportStar(nm(),u)}(Ja)),Ja}var Qa={},Mi={},Uh;function om(){if(Uh)return Mi;Uh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.HEARTBEAT_EVENTS=Mi.HEARTBEAT_INTERVAL=void 0;const u=se;return Mi.HEARTBEAT_INTERVAL=u.FIVE_SECONDS,Mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Mi}var zh;function Wl(){return zh||(zh=1,function(u){Object.defineProperty(u,"__esModule",{value:!0}),bi.__exportStar(om(),u)}(Qa)),Qa}var kh;function am(){if(kh)return js;kh=1,Object.defineProperty(js,"__esModule",{value:!0}),js.HeartBeat=void 0;const u=bi,i=Sr,r=se,n=Gl(),o=Wl();class h extends n.IHeartBeat{constructor(v){super(v),this.events=new i.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(v==null?void 0:v.interval)||o.HEARTBEAT_INTERVAL}static init(v){return u.__awaiter(this,void 0,void 0,function*(){const _=new h(v);return yield _.init(),_})}init(){return u.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,_){this.events.on(v,_)}once(v,_){this.events.once(v,_)}off(v,_){this.events.off(v,_)}removeListener(v,_){this.events.removeListener(v,_)}initialize(){return u.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return js.HeartBeat=h,js}(function(u){Object.defineProperty(u,"__esModule",{value:!0});const i=bi;i.__exportStar(am(),u),i.__exportStar(Gl(),u),i.__exportStar(Wl(),u)})(gs);var Oe={},Ya,Hh;function cm(){if(Hh)return Ya;Hh=1;function u(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Ya=i;function i(r,n,o){var h=o&&o.stringify||u,d=1;if(typeof r=="object"&&r!==null){var v=n.length+d;if(v===1)return r;var _=new Array(v);_[0]=h(r);for(var S=1;S<v;S++)_[S]=h(n[S]);return _.join(" ")}if(typeof r!="string")return r;var F=n.length;if(F===0)return r;for(var k="",B=1-d,K=-1,q=r&&r.length||0,W=0;W<q;){if(r.charCodeAt(W)===37&&W+1<q){switch(K=K>-1?K:0,r.charCodeAt(W+1)){case 100:case 102:if(B>=F||n[B]==null)break;K<W&&(k+=r.slice(K,W)),k+=Number(n[B]),K=W+2,W++;break;case 105:if(B>=F||n[B]==null)break;K<W&&(k+=r.slice(K,W)),k+=Math.floor(Number(n[B])),K=W+2,W++;break;case 79:case 111:case 106:if(B>=F||n[B]===void 0)break;K<W&&(k+=r.slice(K,W));var ie=typeof n[B];if(ie==="string"){k+="'"+n[B]+"'",K=W+2,W++;break}if(ie==="function"){k+=n[B].name||"<anonymous>",K=W+2,W++;break}k+=h(n[B]),K=W+2,W++;break;case 115:if(B>=F)break;K<W&&(k+=r.slice(K,W)),k+=String(n[B]),K=W+2,W++;break;case 37:K<W&&(k+=r.slice(K,W)),k+="%",K=W+2,W++,B--;break}++B}++W}return K===-1?r:(K<q&&(k+=r.slice(K)),k)}return Ya}var Xa,Bh;function um(){if(Bh)return Xa;Bh=1;const u=cm();Xa=o;const i=le().console||{},r={mapHttpRequest:q,mapHttpResponse:q,wrapRequestSerializer:W,wrapResponseSerializer:W,wrapErrorSerializer:W,req:q,res:q,err:B};function n(T,M){return Array.isArray(T)?T.filter(function(ye){return ye!=="!stdSerializers.err"}):T===!0?Object.keys(M):!1}function o(T){T=T||{},T.browser=T.browser||{};const M=T.browser.transmit;if(M&&typeof M.send!="function")throw Error("pino: transmit option must have a send function");const G=T.browser.write||i;T.browser.write&&(T.browser.asObject=!0);const ye=T.serializers||{},re=n(T.browser.serialize,ye);let ue=T.browser.serialize;Array.isArray(T.browser.serialize)&&T.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof G=="function"&&(G.error=G.fatal=G.warn=G.info=G.debug=G.trace=G),T.enabled===!1&&(T.level="silent");const Ue=T.level||"info",y=Object.create(G);y.log||(y.log=ie),Object.defineProperty(y,"levelVal",{get:Y}),Object.defineProperty(y,"level",{get:ce,set:H});const E={transmit:M,serialize:re,asObject:T.browser.asObject,levels:Te,timestamp:K(T)};y.levels=o.levels,y.level=Ue,y.setMaxListeners=y.getMaxListeners=y.emit=y.addListener=y.on=y.prependListener=y.once=y.prependOnceListener=y.removeListener=y.removeAllListeners=y.listeners=y.listenerCount=y.eventNames=y.write=y.flush=ie,y.serializers=ye,y._serialize=re,y._stdErrSerialize=ue,y.child=j,M&&(y._logEvent=k());function Y(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function H(z){if(z!=="silent"&&!this.levels.values[z])throw Error("unknown level "+z);this._level=z,h(E,y,"error","log"),h(E,y,"fatal","error"),h(E,y,"warn","error"),h(E,y,"info","log"),h(E,y,"debug","log"),h(E,y,"trace","log")}function j(z,V){if(!z)throw new Error("missing bindings for child Pino");V=V||{},re&&z.serializers&&(V.serializers=z.serializers);const Je=V.serializers;if(re&&Je){var He=Object.assign({},ye,Je),Lr=T.browser.serialize===!0?Object.keys(He):re;delete z.serializers,_([z],Lr,He,this._stdErrSerialize)}function xe(xt){this._childLevel=(xt._childLevel|0)+1,this.error=S(xt,z,"error"),this.fatal=S(xt,z,"fatal"),this.warn=S(xt,z,"warn"),this.info=S(xt,z,"info"),this.debug=S(xt,z,"debug"),this.trace=S(xt,z,"trace"),He&&(this.serializers=He,this._serialize=Lr),M&&(this._logEvent=k([].concat(xt._logEvent.bindings,z)))}return xe.prototype=this,new xe(this)}return y}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:Ee,epochTime:ge,unixTime:pe,isoTime:he});function h(T,M,G,ye){const re=Object.getPrototypeOf(M);M[G]=M.levelVal>M.levels.values[G]?ie:re[G]?re[G]:i[G]||i[ye]||ie,d(T,M,G)}function d(T,M,G){!T.transmit&&M[G]===ie||(M[G]=function(ye){return function(){const ue=T.timestamp(),Te=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var y=0;y<Te.length;y++)Te[y]=arguments[y];if(T.serialize&&!T.asObject&&_(Te,this._serialize,this.serializers,this._stdErrSerialize),T.asObject?ye.call(Ue,v(this,G,Te,ue)):ye.apply(Ue,Te),T.transmit){const E=T.transmit.level||M.level,Y=o.levels.values[E],ce=o.levels.values[G];if(ce<Y)return;F(this,{ts:ue,methodLevel:G,methodValue:ce,transmitLevel:E,transmitValue:o.levels.values[T.transmit.level||M.level],send:T.transmit.send,val:M.levelVal},Te)}}}(M[G]))}function v(T,M,G,ye){T._serialize&&_(G,T._serialize,T.serializers,T._stdErrSerialize);const re=G.slice();let ue=re[0];const Te={};ye&&(Te.time=ye),Te.level=o.levels.values[M];let Ue=(T._childLevel|0)+1;if(Ue<1&&(Ue=1),ue!==null&&typeof ue=="object"){for(;Ue--&&typeof re[0]=="object";)Object.assign(Te,re.shift());ue=re.length?u(re.shift(),re):void 0}else typeof ue=="string"&&(ue=u(re.shift(),re));return ue!==void 0&&(Te.msg=ue),Te}function _(T,M,G,ye){for(const re in T)if(ye&&T[re]instanceof Error)T[re]=o.stdSerializers.err(T[re]);else if(typeof T[re]=="object"&&!Array.isArray(T[re]))for(const ue in T[re])M&&M.indexOf(ue)>-1&&ue in G&&(T[re][ue]=G[ue](T[re][ue]))}function S(T,M,G){return function(){const ye=new Array(1+arguments.length);ye[0]=M;for(var re=1;re<ye.length;re++)ye[re]=arguments[re-1];return T[G].apply(this,ye)}}function F(T,M,G){const ye=M.send,re=M.ts,ue=M.methodLevel,Te=M.methodValue,Ue=M.val,y=T._logEvent.bindings;_(G,T._serialize||Object.keys(T.serializers),T.serializers,T._stdErrSerialize===void 0?!0:T._stdErrSerialize),T._logEvent.ts=re,T._logEvent.messages=G.filter(function(E){return y.indexOf(E)===-1}),T._logEvent.level.label=ue,T._logEvent.level.value=Te,ye(ue,T._logEvent,Ue),T._logEvent=k(y)}function k(T){return{ts:0,messages:[],bindings:T||[],level:{label:"",value:0}}}function B(T){const M={type:T.constructor.name,msg:T.message,stack:T.stack};for(const G in T)M[G]===void 0&&(M[G]=T[G]);return M}function K(T){return typeof T.timestamp=="function"?T.timestamp:T.timestamp===!1?Ee:ge}function q(){return{}}function W(T){return T}function ie(){}function Ee(){return!1}function ge(){return Date.now()}function pe(){return Math.round(Date.now()/1e3)}function he(){return new Date(Date.now()).toISOString()}function le(){function T(M){return typeof M<"u"&&M}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return T(self)||T(window)||T(this)||{}}}return Xa}var ji={},Vh;function Jl(){return Vh||(Vh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.PINO_CUSTOM_CONTEXT_KEY=ji.PINO_LOGGER_DEFAULTS=void 0,ji.PINO_LOGGER_DEFAULTS={level:"info"},ji.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ji}var Zt={},Kh;function hm(){if(Kh)return Zt;Kh=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.generateChildLogger=Zt.formatChildLoggerContext=Zt.getLoggerContext=Zt.setBrowserLoggerContext=Zt.getBrowserLoggerContext=Zt.getDefaultLoggerOptions=void 0;const u=Jl();function i(v){return Object.assign(Object.assign({},v),{level:(v==null?void 0:v.level)||u.PINO_LOGGER_DEFAULTS.level})}Zt.getDefaultLoggerOptions=i;function r(v,_=u.PINO_CUSTOM_CONTEXT_KEY){return v[_]||""}Zt.getBrowserLoggerContext=r;function n(v,_,S=u.PINO_CUSTOM_CONTEXT_KEY){return v[S]=_,v}Zt.setBrowserLoggerContext=n;function o(v,_=u.PINO_CUSTOM_CONTEXT_KEY){let S="";return typeof v.bindings>"u"?S=r(v,_):S=v.bindings().context||"",S}Zt.getLoggerContext=o;function h(v,_,S=u.PINO_CUSTOM_CONTEXT_KEY){const F=o(v,S);return F.trim()?`${F}/${_}`:_}Zt.formatChildLoggerContext=h;function d(v,_,S=u.PINO_CUSTOM_CONTEXT_KEY){const F=h(v,_,S),k=v.child({context:F});return n(k,F,S)}return Zt.generateChildLogger=d,Zt}(function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.pino=void 0;const i=bi,r=i.__importDefault(um());Object.defineProperty(u,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(Jl(),u),i.__exportStar(hm(),u)})(Oe);class lm extends Ui{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}class fm extends Ui{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}}class pm{constructor(i,r){this.logger=i,this.core=r}}let dm=class extends Ui{constructor(i,r){super(),this.relayer=i,this.logger=r}},gm=class extends Ui{constructor(i){super()}},ym=class{constructor(i,r,n,o){this.core=i,this.logger=r,this.name=n}};class vm extends Ui{constructor(i,r){super(),this.relayer=i,this.logger=r}}let mm=class extends Ui{constructor(i,r){super(),this.core=i,this.logger=r}},wm=class{constructor(i,r){this.projectId=i,this.logger=r}},_m=class{constructor(i){this.opts=i,this.protocol="wc",this.version=2}},bm=class{constructor(i){this.client=i}};const Em=u=>JSON.stringify(u,(i,r)=>typeof r=="bigint"?r.toString()+"n":r),xm=u=>{const i=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=u.replace(i,'$1"$2n"$3');return JSON.parse(r,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function mc(u){if(typeof u!="string")throw new Error(`Cannot safe json parse value of type ${typeof u}`);try{return xm(u)}catch{return u}}function Ys(u){return typeof u=="string"?u:Em(u)||""}var wc={},Ql={};(function(u){Object.defineProperty(u,"__esModule",{value:!0});var i=a1,r=ql;u.DIGEST_LENGTH=64,u.BLOCK_SIZE=128;var n=function(){function v(){this.digestLength=u.DIGEST_LENGTH,this.blockSize=u.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},v.prototype.update=function(_,S){if(S===void 0&&(S=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var F=0;if(this._bytesHashed+=S,this._bufferLength>0){for(;this._bufferLength<u.BLOCK_SIZE&&S>0;)this._buffer[this._bufferLength++]=_[F++],S--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(S>=this.blockSize&&(F=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,F,S),S%=this.blockSize);S>0;)this._buffer[this._bufferLength++]=_[F++],S--;return this},v.prototype.finish=function(_){if(!this._finished){var S=this._bytesHashed,F=this._bufferLength,k=S/536870912|0,B=S<<3,K=S%128<112?128:256;this._buffer[F]=128;for(var q=F+1;q<K-8;q++)this._buffer[q]=0;i.writeUint32BE(k,this._buffer,K-8),i.writeUint32BE(B,this._buffer,K-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,K),this._finished=!0}for(var q=0;q<this.digestLength/8;q++)i.writeUint32BE(this._stateHi[q],_,q*8),i.writeUint32BE(this._stateLo[q],_,q*8+4);return this},v.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(_){r.wipe(_.stateHi),r.wipe(_.stateLo),_.buffer&&r.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},v}();u.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(v,_,S,F,k,B,K){for(var q=S[0],W=S[1],ie=S[2],Ee=S[3],ge=S[4],pe=S[5],he=S[6],le=S[7],T=F[0],M=F[1],G=F[2],ye=F[3],re=F[4],ue=F[5],Te=F[6],Ue=F[7],y,E,Y,ce,H,j,z,V;K>=128;){for(var Je=0;Je<16;Je++){var He=8*Je+B;v[Je]=i.readUint32BE(k,He),_[Je]=i.readUint32BE(k,He+4)}for(var Je=0;Je<80;Je++){var Lr=q,xe=W,xt=ie,O=Ee,C=ge,A=pe,c=he,b=le,ee=T,fe=M,_e=G,Ne=ye,De=re,Se=ue,It=Te,vt=Ue;if(y=le,E=Ue,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=(ge>>>14|re<<32-14)^(ge>>>18|re<<32-18)^(re>>>41-32|ge<<32-(41-32)),E=(re>>>14|ge<<32-14)^(re>>>18|ge<<32-18)^(ge>>>41-32|re<<32-(41-32)),H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,y=ge&pe^~ge&he,E=re&ue^~re&Te,H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,y=o[Je*2],E=o[Je*2+1],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,y=v[Je%16],E=_[Je%16],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,Y=z&65535|V<<16,ce=H&65535|j<<16,y=Y,E=ce,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=(q>>>28|T<<32-28)^(T>>>34-32|q<<32-(34-32))^(T>>>39-32|q<<32-(39-32)),E=(T>>>28|q<<32-28)^(q>>>34-32|T<<32-(34-32))^(q>>>39-32|T<<32-(39-32)),H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,y=q&W^q&ie^W&ie,E=T&M^T&G^M&G,H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,b=z&65535|V<<16,vt=H&65535|j<<16,y=O,E=Ne,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=Y,E=ce,H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,O=z&65535|V<<16,Ne=H&65535|j<<16,W=Lr,ie=xe,Ee=xt,ge=O,pe=C,he=A,le=c,q=b,M=ee,G=fe,ye=_e,re=Ne,ue=De,Te=Se,Ue=It,T=vt,Je%16===15)for(var He=0;He<16;He++)y=v[He],E=_[He],H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=v[(He+9)%16],E=_[(He+9)%16],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,Y=v[(He+1)%16],ce=_[(He+1)%16],y=(Y>>>1|ce<<32-1)^(Y>>>8|ce<<32-8)^Y>>>7,E=(ce>>>1|Y<<32-1)^(ce>>>8|Y<<32-8)^(ce>>>7|Y<<32-7),H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,Y=v[(He+14)%16],ce=_[(He+14)%16],y=(Y>>>19|ce<<32-19)^(ce>>>61-32|Y<<32-(61-32))^Y>>>6,E=(ce>>>19|Y<<32-19)^(Y>>>61-32|ce<<32-(61-32))^(ce>>>6|Y<<32-6),H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,v[He]=z&65535|V<<16,_[He]=H&65535|j<<16}y=q,E=T,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=S[0],E=F[0],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,S[0]=q=z&65535|V<<16,F[0]=T=H&65535|j<<16,y=W,E=M,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=S[1],E=F[1],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,S[1]=W=z&65535|V<<16,F[1]=M=H&65535|j<<16,y=ie,E=G,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=S[2],E=F[2],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,S[2]=ie=z&65535|V<<16,F[2]=G=H&65535|j<<16,y=Ee,E=ye,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=S[3],E=F[3],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,S[3]=Ee=z&65535|V<<16,F[3]=ye=H&65535|j<<16,y=ge,E=re,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=S[4],E=F[4],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,S[4]=ge=z&65535|V<<16,F[4]=re=H&65535|j<<16,y=pe,E=ue,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=S[5],E=F[5],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,S[5]=pe=z&65535|V<<16,F[5]=ue=H&65535|j<<16,y=he,E=Te,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=S[6],E=F[6],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,S[6]=he=z&65535|V<<16,F[6]=Te=H&65535|j<<16,y=le,E=Ue,H=E&65535,j=E>>>16,z=y&65535,V=y>>>16,y=S[7],E=F[7],H+=E&65535,j+=E>>>16,z+=y&65535,V+=y>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,S[7]=le=z&65535|V<<16,F[7]=Ue=H&65535|j<<16,B+=128,K-=128}return B}function d(v){var _=new n;_.update(v);var S=_.digest();return _.clean(),S}u.hash=d})(Ql);(function(u){Object.defineProperty(u,"__esModule",{value:!0}),u.convertSecretKeyToX25519=u.convertPublicKeyToX25519=u.verify=u.sign=u.extractPublicKeyFromSecretKey=u.generateKeyPair=u.generateKeyPairFromSeed=u.SEED_LENGTH=u.SECRET_KEY_LENGTH=u.PUBLIC_KEY_LENGTH=u.SIGNATURE_LENGTH=void 0;const i=Ml,r=Ql,n=ql;u.SIGNATURE_LENGTH=64,u.PUBLIC_KEY_LENGTH=32,u.SECRET_KEY_LENGTH=64,u.SEED_LENGTH=32;function o(O){const C=new Float64Array(16);if(O)for(let A=0;A<O.length;A++)C[A]=O[A];return C}const h=new Uint8Array(32);h[0]=9;const d=o(),v=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),S=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),F=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),k=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),B=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function K(O,C){for(let A=0;A<16;A++)O[A]=C[A]|0}function q(O){let C=1;for(let A=0;A<16;A++){let c=O[A]+C+65535;C=Math.floor(c/65536),O[A]=c-C*65536}O[0]+=C-1+37*(C-1)}function W(O,C,A){const c=~(A-1);for(let b=0;b<16;b++){const ee=c&(O[b]^C[b]);O[b]^=ee,C[b]^=ee}}function ie(O,C){const A=o(),c=o();for(let b=0;b<16;b++)c[b]=C[b];q(c),q(c),q(c);for(let b=0;b<2;b++){A[0]=c[0]-65517;for(let fe=1;fe<15;fe++)A[fe]=c[fe]-65535-(A[fe-1]>>16&1),A[fe-1]&=65535;A[15]=c[15]-32767-(A[14]>>16&1);const ee=A[15]>>16&1;A[14]&=65535,W(c,A,1-ee)}for(let b=0;b<16;b++)O[2*b]=c[b]&255,O[2*b+1]=c[b]>>8}function Ee(O,C){let A=0;for(let c=0;c<32;c++)A|=O[c]^C[c];return(1&A-1>>>8)-1}function ge(O,C){const A=new Uint8Array(32),c=new Uint8Array(32);return ie(A,O),ie(c,C),Ee(A,c)}function pe(O){const C=new Uint8Array(32);return ie(C,O),C[0]&1}function he(O,C){for(let A=0;A<16;A++)O[A]=C[2*A]+(C[2*A+1]<<8);O[15]&=32767}function le(O,C,A){for(let c=0;c<16;c++)O[c]=C[c]+A[c]}function T(O,C,A){for(let c=0;c<16;c++)O[c]=C[c]-A[c]}function M(O,C,A){let c,b,ee=0,fe=0,_e=0,Ne=0,De=0,Se=0,It=0,vt=0,nt=0,$e=0,Ye=0,Xe=0,ot=0,ze=0,Ze=0,Fe=0,Be=0,ut=0,Me=0,Pt=0,Dt=0,Ut=0,zt=0,qt=0,Gt=0,tr=0,$r=0,Wt=0,Br=0,ai=0,Ii=0,ht=A[0],rt=A[1],lt=A[2],ft=A[3],at=A[4],it=A[5],St=A[6],At=A[7],pt=A[8],Rt=A[9],dt=A[10],mt=A[11],gt=A[12],Qe=A[13],Ct=A[14],Ot=A[15];c=C[0],ee+=c*ht,fe+=c*rt,_e+=c*lt,Ne+=c*ft,De+=c*at,Se+=c*it,It+=c*St,vt+=c*At,nt+=c*pt,$e+=c*Rt,Ye+=c*dt,Xe+=c*mt,ot+=c*gt,ze+=c*Qe,Ze+=c*Ct,Fe+=c*Ot,c=C[1],fe+=c*ht,_e+=c*rt,Ne+=c*lt,De+=c*ft,Se+=c*at,It+=c*it,vt+=c*St,nt+=c*At,$e+=c*pt,Ye+=c*Rt,Xe+=c*dt,ot+=c*mt,ze+=c*gt,Ze+=c*Qe,Fe+=c*Ct,Be+=c*Ot,c=C[2],_e+=c*ht,Ne+=c*rt,De+=c*lt,Se+=c*ft,It+=c*at,vt+=c*it,nt+=c*St,$e+=c*At,Ye+=c*pt,Xe+=c*Rt,ot+=c*dt,ze+=c*mt,Ze+=c*gt,Fe+=c*Qe,Be+=c*Ct,ut+=c*Ot,c=C[3],Ne+=c*ht,De+=c*rt,Se+=c*lt,It+=c*ft,vt+=c*at,nt+=c*it,$e+=c*St,Ye+=c*At,Xe+=c*pt,ot+=c*Rt,ze+=c*dt,Ze+=c*mt,Fe+=c*gt,Be+=c*Qe,ut+=c*Ct,Me+=c*Ot,c=C[4],De+=c*ht,Se+=c*rt,It+=c*lt,vt+=c*ft,nt+=c*at,$e+=c*it,Ye+=c*St,Xe+=c*At,ot+=c*pt,ze+=c*Rt,Ze+=c*dt,Fe+=c*mt,Be+=c*gt,ut+=c*Qe,Me+=c*Ct,Pt+=c*Ot,c=C[5],Se+=c*ht,It+=c*rt,vt+=c*lt,nt+=c*ft,$e+=c*at,Ye+=c*it,Xe+=c*St,ot+=c*At,ze+=c*pt,Ze+=c*Rt,Fe+=c*dt,Be+=c*mt,ut+=c*gt,Me+=c*Qe,Pt+=c*Ct,Dt+=c*Ot,c=C[6],It+=c*ht,vt+=c*rt,nt+=c*lt,$e+=c*ft,Ye+=c*at,Xe+=c*it,ot+=c*St,ze+=c*At,Ze+=c*pt,Fe+=c*Rt,Be+=c*dt,ut+=c*mt,Me+=c*gt,Pt+=c*Qe,Dt+=c*Ct,Ut+=c*Ot,c=C[7],vt+=c*ht,nt+=c*rt,$e+=c*lt,Ye+=c*ft,Xe+=c*at,ot+=c*it,ze+=c*St,Ze+=c*At,Fe+=c*pt,Be+=c*Rt,ut+=c*dt,Me+=c*mt,Pt+=c*gt,Dt+=c*Qe,Ut+=c*Ct,zt+=c*Ot,c=C[8],nt+=c*ht,$e+=c*rt,Ye+=c*lt,Xe+=c*ft,ot+=c*at,ze+=c*it,Ze+=c*St,Fe+=c*At,Be+=c*pt,ut+=c*Rt,Me+=c*dt,Pt+=c*mt,Dt+=c*gt,Ut+=c*Qe,zt+=c*Ct,qt+=c*Ot,c=C[9],$e+=c*ht,Ye+=c*rt,Xe+=c*lt,ot+=c*ft,ze+=c*at,Ze+=c*it,Fe+=c*St,Be+=c*At,ut+=c*pt,Me+=c*Rt,Pt+=c*dt,Dt+=c*mt,Ut+=c*gt,zt+=c*Qe,qt+=c*Ct,Gt+=c*Ot,c=C[10],Ye+=c*ht,Xe+=c*rt,ot+=c*lt,ze+=c*ft,Ze+=c*at,Fe+=c*it,Be+=c*St,ut+=c*At,Me+=c*pt,Pt+=c*Rt,Dt+=c*dt,Ut+=c*mt,zt+=c*gt,qt+=c*Qe,Gt+=c*Ct,tr+=c*Ot,c=C[11],Xe+=c*ht,ot+=c*rt,ze+=c*lt,Ze+=c*ft,Fe+=c*at,Be+=c*it,ut+=c*St,Me+=c*At,Pt+=c*pt,Dt+=c*Rt,Ut+=c*dt,zt+=c*mt,qt+=c*gt,Gt+=c*Qe,tr+=c*Ct,$r+=c*Ot,c=C[12],ot+=c*ht,ze+=c*rt,Ze+=c*lt,Fe+=c*ft,Be+=c*at,ut+=c*it,Me+=c*St,Pt+=c*At,Dt+=c*pt,Ut+=c*Rt,zt+=c*dt,qt+=c*mt,Gt+=c*gt,tr+=c*Qe,$r+=c*Ct,Wt+=c*Ot,c=C[13],ze+=c*ht,Ze+=c*rt,Fe+=c*lt,Be+=c*ft,ut+=c*at,Me+=c*it,Pt+=c*St,Dt+=c*At,Ut+=c*pt,zt+=c*Rt,qt+=c*dt,Gt+=c*mt,tr+=c*gt,$r+=c*Qe,Wt+=c*Ct,Br+=c*Ot,c=C[14],Ze+=c*ht,Fe+=c*rt,Be+=c*lt,ut+=c*ft,Me+=c*at,Pt+=c*it,Dt+=c*St,Ut+=c*At,zt+=c*pt,qt+=c*Rt,Gt+=c*dt,tr+=c*mt,$r+=c*gt,Wt+=c*Qe,Br+=c*Ct,ai+=c*Ot,c=C[15],Fe+=c*ht,Be+=c*rt,ut+=c*lt,Me+=c*ft,Pt+=c*at,Dt+=c*it,Ut+=c*St,zt+=c*At,qt+=c*pt,Gt+=c*Rt,tr+=c*dt,$r+=c*mt,Wt+=c*gt,Br+=c*Qe,ai+=c*Ct,Ii+=c*Ot,ee+=38*Be,fe+=38*ut,_e+=38*Me,Ne+=38*Pt,De+=38*Dt,Se+=38*Ut,It+=38*zt,vt+=38*qt,nt+=38*Gt,$e+=38*tr,Ye+=38*$r,Xe+=38*Wt,ot+=38*Br,ze+=38*ai,Ze+=38*Ii,b=1,c=ee+b+65535,b=Math.floor(c/65536),ee=c-b*65536,c=fe+b+65535,b=Math.floor(c/65536),fe=c-b*65536,c=_e+b+65535,b=Math.floor(c/65536),_e=c-b*65536,c=Ne+b+65535,b=Math.floor(c/65536),Ne=c-b*65536,c=De+b+65535,b=Math.floor(c/65536),De=c-b*65536,c=Se+b+65535,b=Math.floor(c/65536),Se=c-b*65536,c=It+b+65535,b=Math.floor(c/65536),It=c-b*65536,c=vt+b+65535,b=Math.floor(c/65536),vt=c-b*65536,c=nt+b+65535,b=Math.floor(c/65536),nt=c-b*65536,c=$e+b+65535,b=Math.floor(c/65536),$e=c-b*65536,c=Ye+b+65535,b=Math.floor(c/65536),Ye=c-b*65536,c=Xe+b+65535,b=Math.floor(c/65536),Xe=c-b*65536,c=ot+b+65535,b=Math.floor(c/65536),ot=c-b*65536,c=ze+b+65535,b=Math.floor(c/65536),ze=c-b*65536,c=Ze+b+65535,b=Math.floor(c/65536),Ze=c-b*65536,c=Fe+b+65535,b=Math.floor(c/65536),Fe=c-b*65536,ee+=b-1+37*(b-1),b=1,c=ee+b+65535,b=Math.floor(c/65536),ee=c-b*65536,c=fe+b+65535,b=Math.floor(c/65536),fe=c-b*65536,c=_e+b+65535,b=Math.floor(c/65536),_e=c-b*65536,c=Ne+b+65535,b=Math.floor(c/65536),Ne=c-b*65536,c=De+b+65535,b=Math.floor(c/65536),De=c-b*65536,c=Se+b+65535,b=Math.floor(c/65536),Se=c-b*65536,c=It+b+65535,b=Math.floor(c/65536),It=c-b*65536,c=vt+b+65535,b=Math.floor(c/65536),vt=c-b*65536,c=nt+b+65535,b=Math.floor(c/65536),nt=c-b*65536,c=$e+b+65535,b=Math.floor(c/65536),$e=c-b*65536,c=Ye+b+65535,b=Math.floor(c/65536),Ye=c-b*65536,c=Xe+b+65535,b=Math.floor(c/65536),Xe=c-b*65536,c=ot+b+65535,b=Math.floor(c/65536),ot=c-b*65536,c=ze+b+65535,b=Math.floor(c/65536),ze=c-b*65536,c=Ze+b+65535,b=Math.floor(c/65536),Ze=c-b*65536,c=Fe+b+65535,b=Math.floor(c/65536),Fe=c-b*65536,ee+=b-1+37*(b-1),O[0]=ee,O[1]=fe,O[2]=_e,O[3]=Ne,O[4]=De,O[5]=Se,O[6]=It,O[7]=vt,O[8]=nt,O[9]=$e,O[10]=Ye,O[11]=Xe,O[12]=ot,O[13]=ze,O[14]=Ze,O[15]=Fe}function G(O,C){M(O,C,C)}function ye(O,C){const A=o();let c;for(c=0;c<16;c++)A[c]=C[c];for(c=253;c>=0;c--)G(A,A),c!==2&&c!==4&&M(A,A,C);for(c=0;c<16;c++)O[c]=A[c]}function re(O,C){const A=o();let c;for(c=0;c<16;c++)A[c]=C[c];for(c=250;c>=0;c--)G(A,A),c!==1&&M(A,A,C);for(c=0;c<16;c++)O[c]=A[c]}function ue(O,C){const A=o(),c=o(),b=o(),ee=o(),fe=o(),_e=o(),Ne=o(),De=o(),Se=o();T(A,O[1],O[0]),T(Se,C[1],C[0]),M(A,A,Se),le(c,O[0],O[1]),le(Se,C[0],C[1]),M(c,c,Se),M(b,O[3],C[3]),M(b,b,S),M(ee,O[2],C[2]),le(ee,ee,ee),T(fe,c,A),T(_e,ee,b),le(Ne,ee,b),le(De,c,A),M(O[0],fe,_e),M(O[1],De,Ne),M(O[2],Ne,_e),M(O[3],fe,De)}function Te(O,C,A){for(let c=0;c<4;c++)W(O[c],C[c],A)}function Ue(O,C){const A=o(),c=o(),b=o();ye(b,C[2]),M(A,C[0],b),M(c,C[1],b),ie(O,c),O[31]^=pe(A)<<7}function y(O,C,A){K(O[0],d),K(O[1],v),K(O[2],v),K(O[3],d);for(let c=255;c>=0;--c){const b=A[c/8|0]>>(c&7)&1;Te(O,C,b),ue(C,O),ue(O,O),Te(O,C,b)}}function E(O,C){const A=[o(),o(),o(),o()];K(A[0],F),K(A[1],k),K(A[2],v),M(A[3],F,k),y(O,A,C)}function Y(O){if(O.length!==u.SEED_LENGTH)throw new Error(`ed25519: seed must be ${u.SEED_LENGTH} bytes`);const C=(0,r.hash)(O);C[0]&=248,C[31]&=127,C[31]|=64;const A=new Uint8Array(32),c=[o(),o(),o(),o()];E(c,C),Ue(A,c);const b=new Uint8Array(64);return b.set(O),b.set(A,32),{publicKey:A,secretKey:b}}u.generateKeyPairFromSeed=Y;function ce(O){const C=(0,i.randomBytes)(32,O),A=Y(C);return(0,n.wipe)(C),A}u.generateKeyPair=ce;function H(O){if(O.length!==u.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${u.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(O.subarray(32))}u.extractPublicKeyFromSecretKey=H;const j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function z(O,C){let A,c,b,ee;for(c=63;c>=32;--c){for(A=0,b=c-32,ee=c-12;b<ee;++b)C[b]+=A-16*C[c]*j[b-(c-32)],A=Math.floor((C[b]+128)/256),C[b]-=A*256;C[b]+=A,C[c]=0}for(A=0,b=0;b<32;b++)C[b]+=A-(C[31]>>4)*j[b],A=C[b]>>8,C[b]&=255;for(b=0;b<32;b++)C[b]-=A*j[b];for(c=0;c<32;c++)C[c+1]+=C[c]>>8,O[c]=C[c]&255}function V(O){const C=new Float64Array(64);for(let A=0;A<64;A++)C[A]=O[A];for(let A=0;A<64;A++)O[A]=0;z(O,C)}function Je(O,C){const A=new Float64Array(64),c=[o(),o(),o(),o()],b=(0,r.hash)(O.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const ee=new Uint8Array(64);ee.set(b.subarray(32),32);const fe=new r.SHA512;fe.update(ee.subarray(32)),fe.update(C);const _e=fe.digest();fe.clean(),V(_e),E(c,_e),Ue(ee,c),fe.reset(),fe.update(ee.subarray(0,32)),fe.update(O.subarray(32)),fe.update(C);const Ne=fe.digest();V(Ne);for(let De=0;De<32;De++)A[De]=_e[De];for(let De=0;De<32;De++)for(let Se=0;Se<32;Se++)A[De+Se]+=Ne[De]*b[Se];return z(ee.subarray(32),A),ee}u.sign=Je;function He(O,C){const A=o(),c=o(),b=o(),ee=o(),fe=o(),_e=o(),Ne=o();return K(O[2],v),he(O[1],C),G(b,O[1]),M(ee,b,_),T(b,b,O[2]),le(ee,O[2],ee),G(fe,ee),G(_e,fe),M(Ne,_e,fe),M(A,Ne,b),M(A,A,ee),re(A,A),M(A,A,b),M(A,A,ee),M(A,A,ee),M(O[0],A,ee),G(c,O[0]),M(c,c,ee),ge(c,b)&&M(O[0],O[0],B),G(c,O[0]),M(c,c,ee),ge(c,b)?-1:(pe(O[0])===C[31]>>7&&T(O[0],d,O[0]),M(O[3],O[0],O[1]),0)}function Lr(O,C,A){const c=new Uint8Array(32),b=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(A.length!==u.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${u.SIGNATURE_LENGTH} bytes`);if(He(ee,O))return!1;const fe=new r.SHA512;fe.update(A.subarray(0,32)),fe.update(O),fe.update(C);const _e=fe.digest();return V(_e),y(b,ee,_e),E(ee,A.subarray(32)),ue(b,ee),Ue(c,b),!Ee(A,c)}u.verify=Lr;function xe(O){let C=[o(),o(),o(),o()];if(He(C,O))throw new Error("Ed25519: invalid public key");let A=o(),c=o(),b=C[1];le(A,v,b),T(c,v,b),ye(c,c),M(A,A,c);let ee=new Uint8Array(32);return ie(ee,A),ee}u.convertPublicKeyToX25519=xe;function xt(O){const C=(0,r.hash)(O.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const A=new Uint8Array(C.subarray(0,32));return(0,n.wipe)(C),A}u.convertSecretKeyToX25519=xt})(wc);const Im="EdDSA",Pm="JWT",Yl=".",Xl="base64url",Sm="utf8",Am="utf8",Rm=":",Cm="did",Om="key",Gh="base58btc",Tm="z",Nm="K36",Fm=32;function fo(u){return yo(yc(Ys(u),Sm),Xl)}function Zl(u){const i=yc(Nm,Gh),r=Tm+yo(c1([i,u]),Gh);return[Cm,Om,r].join(Rm)}function Dm(u){return yo(u,Xl)}function Lm(u){return yc([fo(u.header),fo(u.payload)].join(Yl),Am)}function $m(u){return[fo(u.header),fo(u.payload),Dm(u.signature)].join(Yl)}function Wh(u=Ml.randomBytes(Fm)){return wc.generateKeyPairFromSeed(u)}async function qm(u,i,r,n,o=se.fromMiliseconds(Date.now())){const h={alg:Im,typ:Pm},d=Zl(n.publicKey),v=o+r,_={iss:d,sub:u,aud:i,iat:o,exp:v},S=Lm({header:h,payload:_}),F=wc.sign(n.secretKey,S);return $m({header:h,payload:_,signature:F})}const Mm="PARSE_ERROR",jm="INVALID_REQUEST",Um="METHOD_NOT_FOUND",zm="INVALID_PARAMS",ef="INTERNAL_ERROR",_c="SERVER_ERROR",km=[-32700,-32600,-32601,-32602,-32603],Js={[Mm]:{code:-32700,message:"Parse error"},[jm]:{code:-32600,message:"Invalid Request"},[Um]:{code:-32601,message:"Method not found"},[zm]:{code:-32602,message:"Invalid params"},[ef]:{code:-32603,message:"Internal error"},[_c]:{code:-32e3,message:"Server error"}},tf=_c;function Hm(u){return km.includes(u)}function Jh(u){return Object.keys(Js).includes(u)?Js[u]:Js[tf]}function Bm(u){const i=Object.values(Js).find(r=>r.code===u);return i||Js[tf]}function rf(u,i,r){return u.message.includes("getaddrinfo ENOTFOUND")||u.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${i}`):u}var sf={},ri={},Qh;function Vm(){if(Qh)return ri;Qh=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.isBrowserCryptoAvailable=ri.getSubtleCrypto=ri.getBrowerCrypto=void 0;function u(){return(ur===null||ur===void 0?void 0:ur.crypto)||(ur===null||ur===void 0?void 0:ur.msCrypto)||{}}ri.getBrowerCrypto=u;function i(){const n=u();return n.subtle||n.webkitSubtle}ri.getSubtleCrypto=i;function r(){return!!u()&&!!i()}return ri.isBrowserCryptoAvailable=r,ri}var ii={},Yh;function Km(){if(Yh)return ii;Yh=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.isBrowser=ii.isNode=ii.isReactNative=void 0;function u(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ii.isReactNative=u;function i(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ii.isNode=i;function r(){return!u()&&!i()}return ii.isBrowser=r,ii}(function(u){Object.defineProperty(u,"__esModule",{value:!0});const i=bi;i.__exportStar(Vm(),u),i.__exportStar(Km(),u)})(sf);function bc(u=3){const i=Date.now()*Math.pow(10,u),r=Math.floor(Math.random()*Math.pow(10,u));return i+r}function nf(u=6){return BigInt(bc(u))}function ps(u,i,r){return{id:r||bc(),jsonrpc:"2.0",method:u,params:i}}function Ec(u,i){return{id:u,jsonrpc:"2.0",result:i}}function mo(u,i,r){return{id:u,jsonrpc:"2.0",error:Gm(i,r)}}function Gm(u,i){return typeof u>"u"?Jh(ef):(typeof u=="string"&&(u=Object.assign(Object.assign({},Jh(_c)),{message:u})),typeof i<"u"&&(u.data=i),Hm(u.code)&&(u=Bm(u.code)),u)}class Wm{}class Jm extends Wm{constructor(){super()}}class Qm extends Jm{constructor(i){super()}}const Ym="^https?:",Xm="^wss?:";function Zm(u){const i=u.match(new RegExp(/^\w+:/,"gi"));if(!(!i||!i.length))return i[0]}function of(u,i){const r=Zm(u);return typeof r>"u"?!1:new RegExp(i).test(r)}function Xh(u){return of(u,Ym)}function Zh(u){return of(u,Xm)}function ew(u){return new RegExp("wss?://localhost(:d{2,5})?").test(u)}function af(u){return typeof u=="object"&&"id"in u&&"jsonrpc"in u&&u.jsonrpc==="2.0"}function xc(u){return af(u)&&"method"in u}function wo(u){return af(u)&&(oi(u)||Dr(u))}function oi(u){return"result"in u}function Dr(u){return"error"in u}class Ei extends Qm{constructor(i){super(i),this.events=new Sr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(i),this.connection.connected&&this.registerEventListeners()}async connect(i=this.connection){await this.open(i)}async disconnect(){await this.close()}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async request(i,r){return this.requestStrict(ps(i.method,i.params||[],i.id||nf().toString()),r)}async requestStrict(i,r){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${i.id}`,h=>{Dr(h)?o(h.error):n(h.result)});try{await this.connection.send(i,r)}catch(h){o(h)}})}setConnection(i=this.connection){return i}onPayload(i){this.events.emit("payload",i),wo(i)?this.events.emit(`${i.id}`,i):this.events.emit("message",{type:i.method,data:i.params})}onClose(i){i&&i.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${i.code} ${i.reason?`(${i.reason})`:""}`)),this.events.emit("disconnect")}async open(i=this.connection){this.connection===i&&this.connection.connected||(this.connection.connected&&this.close(),typeof i=="string"&&(await this.connection.open(i),i=this.connection),this.connection=this.setConnection(i),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",i=>this.onPayload(i)),this.connection.on("close",i=>this.onClose(i)),this.connection.on("error",i=>this.events.emit("error",i)),this.connection.on("register_error",i=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const tw=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),rw=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",el=u=>u.split("?")[0],tl=10,iw=tw();class sw{constructor(i){if(this.url=i,this.events=new Sr.EventEmitter,this.registering=!1,!Zh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),i()},this.socket.close()})}async send(i,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ys(i))}catch(n){this.onError(i.id,n)}}register(i=this.url){if(!Zh(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,n)=>{const o=sf.isReactNative()?void 0:{rejectUnauthorized:!ew(i)},h=new iw(i,[],o);rw()?h.onerror=d=>{const v=d;n(this.emitError(v.error))}:h.on("error",d=>{n(this.emitError(d))}),h.onopen=()=>{this.onOpen(h),r(h)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?mc(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),o=n.message||n.toString(),h=mo(i,o);this.events.emit("payload",h)}parseError(i,r=this.url){return rf(i,el(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>tl&&this.events.setMaxListeners(tl)}emitError(i){const r=this.parseError(new Error((i==null?void 0:i.message)||`WebSocket connection failed for host: ${el(this.url)}`));return this.events.emit("register_error",r),r}}var po={exports:{}};po.exports;(function(u,i){var r=200,n="__lodash_hash_undefined__",o=1,h=2,d=9007199254740991,v="[object Arguments]",_="[object Array]",S="[object AsyncFunction]",F="[object Boolean]",k="[object Date]",B="[object Error]",K="[object Function]",q="[object GeneratorFunction]",W="[object Map]",ie="[object Number]",Ee="[object Null]",ge="[object Object]",pe="[object Promise]",he="[object Proxy]",le="[object RegExp]",T="[object Set]",M="[object String]",G="[object Symbol]",ye="[object Undefined]",re="[object WeakMap]",ue="[object ArrayBuffer]",Te="[object DataView]",Ue="[object Float32Array]",y="[object Float64Array]",E="[object Int8Array]",Y="[object Int16Array]",ce="[object Int32Array]",H="[object Uint8Array]",j="[object Uint8ClampedArray]",z="[object Uint16Array]",V="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,Lr=/^(?:0|[1-9]\d*)$/,xe={};xe[Ue]=xe[y]=xe[E]=xe[Y]=xe[ce]=xe[H]=xe[j]=xe[z]=xe[V]=!0,xe[v]=xe[_]=xe[ue]=xe[F]=xe[Te]=xe[k]=xe[B]=xe[K]=xe[W]=xe[ie]=xe[ge]=xe[le]=xe[T]=xe[M]=xe[re]=!1;var xt=typeof ur=="object"&&ur&&ur.Object===Object&&ur,O=typeof self=="object"&&self&&self.Object===Object&&self,C=xt||O||Function("return this")(),A=i&&!i.nodeType&&i,c=A&&!0&&u&&!u.nodeType&&u,b=c&&c.exports===A,ee=b&&xt.process,fe=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),_e=fe&&fe.isTypedArray;function Ne(g,x){for(var $=-1,Q=g==null?0:g.length,Ke=0,ve=[];++$<Q;){var et=g[$];x(et,$,g)&&(ve[Ke++]=et)}return ve}function De(g,x){for(var $=-1,Q=x.length,Ke=g.length;++$<Q;)g[Ke+$]=x[$];return g}function Se(g,x){for(var $=-1,Q=g==null?0:g.length;++$<Q;)if(x(g[$],$,g))return!0;return!1}function It(g,x){for(var $=-1,Q=Array(g);++$<g;)Q[$]=x($);return Q}function vt(g){return function(x){return g(x)}}function nt(g,x){return g.has(x)}function $e(g,x){return g==null?void 0:g[x]}function Ye(g){var x=-1,$=Array(g.size);return g.forEach(function(Q,Ke){$[++x]=[Ke,Q]}),$}function Xe(g,x){return function($){return g(x($))}}function ot(g){var x=-1,$=Array(g.size);return g.forEach(function(Q){$[++x]=Q}),$}var ze=Array.prototype,Ze=Function.prototype,Fe=Object.prototype,Be=C["__core-js_shared__"],ut=Ze.toString,Me=Fe.hasOwnProperty,Pt=function(){var g=/[^.]+$/.exec(Be&&Be.keys&&Be.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Dt=Fe.toString,Ut=RegExp("^"+ut.call(Me).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zt=b?C.Buffer:void 0,qt=C.Symbol,Gt=C.Uint8Array,tr=Fe.propertyIsEnumerable,$r=ze.splice,Wt=qt?qt.toStringTag:void 0,Br=Object.getOwnPropertySymbols,ai=zt?zt.isBuffer:void 0,Ii=Xe(Object.keys,Object),ht=hr(C,"DataView"),rt=hr(C,"Map"),lt=hr(C,"Promise"),ft=hr(C,"Set"),at=hr(C,"WeakMap"),it=hr(Object,"create"),St=Kr(ht),At=Kr(rt),pt=Kr(lt),Rt=Kr(ft),dt=Kr(at),mt=qt?qt.prototype:void 0,gt=mt?mt.valueOf:void 0;function Qe(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Q=g[x];this.set(Q[0],Q[1])}}function Ct(){this.__data__=it?it(null):{},this.size=0}function Ot(g){var x=this.has(g)&&delete this.__data__[g];return this.size-=x?1:0,x}function Eo(g){var x=this.__data__;if(it){var $=x[g];return $===n?void 0:$}return Me.call(x,g)?x[g]:void 0}function xo(g){var x=this.__data__;return it?x[g]!==void 0:Me.call(x,g)}function Io(g,x){var $=this.__data__;return this.size+=this.has(g)?0:1,$[g]=it&&x===void 0?n:x,this}Qe.prototype.clear=Ct,Qe.prototype.delete=Ot,Qe.prototype.get=Eo,Qe.prototype.has=xo,Qe.prototype.set=Io;function yr(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Q=g[x];this.set(Q[0],Q[1])}}function Po(){this.__data__=[],this.size=0}function So(g){var x=this.__data__,$=Pi(x,g);if($<0)return!1;var Q=x.length-1;return $==Q?x.pop():$r.call(x,$,1),--this.size,!0}function Ao(g){var x=this.__data__,$=Pi(x,g);return $<0?void 0:x[$][1]}function Ro(g){return Pi(this.__data__,g)>-1}function Co(g,x){var $=this.__data__,Q=Pi($,g);return Q<0?(++this.size,$.push([g,x])):$[Q][1]=x,this}yr.prototype.clear=Po,yr.prototype.delete=So,yr.prototype.get=Ao,yr.prototype.has=Ro,yr.prototype.set=Co;function Vr(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Q=g[x];this.set(Q[0],Q[1])}}function Hi(){this.size=0,this.__data__={hash:new Qe,map:new(rt||yr),string:new Qe}}function Oo(g){var x=ci(this,g).delete(g);return this.size-=x?1:0,x}function Bi(g){return ci(this,g).get(g)}function To(g){return ci(this,g).has(g)}function No(g,x){var $=ci(this,g),Q=$.size;return $.set(g,x),this.size+=$.size==Q?0:1,this}Vr.prototype.clear=Hi,Vr.prototype.delete=Oo,Vr.prototype.get=Bi,Vr.prototype.has=To,Vr.prototype.set=No;function Vi(g){var x=-1,$=g==null?0:g.length;for(this.__data__=new Vr;++x<$;)this.add(g[x])}function en(g){return this.__data__.set(g,n),this}function tn(g){return this.__data__.has(g)}Vi.prototype.add=Vi.prototype.push=en,Vi.prototype.has=tn;function Ar(g){var x=this.__data__=new yr(g);this.size=x.size}function Fo(){this.__data__=new yr,this.size=0}function Do(g){var x=this.__data__,$=x.delete(g);return this.size=x.size,$}function Lo(g){return this.__data__.get(g)}function $o(g){return this.__data__.has(g)}function rn(g,x){var $=this.__data__;if($ instanceof yr){var Q=$.__data__;if(!rt||Q.length<r-1)return Q.push([g,x]),this.size=++$.size,this;$=this.__data__=new Vr(Q)}return $.set(g,x),this.size=$.size,this}Ar.prototype.clear=Fo,Ar.prototype.delete=Do,Ar.prototype.get=Lo,Ar.prototype.has=$o,Ar.prototype.set=rn;function sn(g,x){var $=Wi(g),Q=!$&&yn(g),Ke=!$&&!Q&&ws(g),ve=!$&&!Q&&!Ke&&wn(g),et=$||Q||Ke||ve,Tt=et?It(g.length,String):[],Re=Tt.length;for(var Ge in g)(x||Me.call(g,Ge))&&!(et&&(Ge=="length"||Ke&&(Ge=="offset"||Ge=="parent")||ve&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||ln(Ge,Re)))&&Tt.push(Ge);return Tt}function Pi(g,x){for(var $=g.length;$--;)if(gn(g[$][0],x))return $;return-1}function vs(g,x,$){var Q=x(g);return Wi(g)?Q:De(Q,$(g))}function Si(g){return g==null?g===void 0?ye:Ee:Wt&&Wt in Object(g)?un(g):jo(g)}function ms(g){return Ri(g)&&Si(g)==v}function Ai(g,x,$,Q,Ke){return g===x?!0:g==null||x==null||!Ri(g)&&!Ri(x)?g!==g&&x!==x:nn(g,x,$,Q,Ai,Ke)}function nn(g,x,$,Q,Ke,ve){var et=Wi(g),Tt=Wi(x),Re=et?_:qr(g),Ge=Tt?_:qr(x);Re=Re==v?ge:Re,Ge=Ge==v?ge:Ge;var wt=Re==ge,rr=Ge==ge,Nt=Re==Ge;if(Nt&&ws(g)){if(!ws(x))return!1;et=!0,wt=!1}if(Nt&&!wt)return ve||(ve=new Ar),et||wn(g)?Ki(g,x,$,Q,Ke,ve):Mo(g,x,Re,$,Q,Ke,ve);if(!($&o)){var tt=wt&&Me.call(g,"__wrapped__"),Jt=rr&&Me.call(x,"__wrapped__");if(tt||Jt){var Rr=tt?g.value():g,vr=Jt?x.value():x;return ve||(ve=new Ar),Ke(Rr,vr,$,Q,ve)}}return Nt?(ve||(ve=new Ar),cn(g,x,$,Q,Ke,ve)):!1}function qo(g){if(!mn(g)||pn(g))return!1;var x=Ji(g)?Ut:He;return x.test(Kr(g))}function on(g){return Ri(g)&&vn(g.length)&&!!xe[Si(g)]}function an(g){if(!dn(g))return Ii(g);var x=[];for(var $ in Object(g))Me.call(g,$)&&$!="constructor"&&x.push($);return x}function Ki(g,x,$,Q,Ke,ve){var et=$&o,Tt=g.length,Re=x.length;if(Tt!=Re&&!(et&&Re>Tt))return!1;var Ge=ve.get(g);if(Ge&&ve.get(x))return Ge==x;var wt=-1,rr=!0,Nt=$&h?new Vi:void 0;for(ve.set(g,x),ve.set(x,g);++wt<Tt;){var tt=g[wt],Jt=x[wt];if(Q)var Rr=et?Q(Jt,tt,wt,x,g,ve):Q(tt,Jt,wt,g,x,ve);if(Rr!==void 0){if(Rr)continue;rr=!1;break}if(Nt){if(!Se(x,function(vr,Mr){if(!nt(Nt,Mr)&&(tt===vr||Ke(tt,vr,$,Q,ve)))return Nt.push(Mr)})){rr=!1;break}}else if(!(tt===Jt||Ke(tt,Jt,$,Q,ve))){rr=!1;break}}return ve.delete(g),ve.delete(x),rr}function Mo(g,x,$,Q,Ke,ve,et){switch($){case Te:if(g.byteLength!=x.byteLength||g.byteOffset!=x.byteOffset)return!1;g=g.buffer,x=x.buffer;case ue:return!(g.byteLength!=x.byteLength||!ve(new Gt(g),new Gt(x)));case F:case k:case ie:return gn(+g,+x);case B:return g.name==x.name&&g.message==x.message;case le:case M:return g==x+"";case W:var Tt=Ye;case T:var Re=Q&o;if(Tt||(Tt=ot),g.size!=x.size&&!Re)return!1;var Ge=et.get(g);if(Ge)return Ge==x;Q|=h,et.set(g,x);var wt=Ki(Tt(g),Tt(x),Q,Ke,ve,et);return et.delete(g),wt;case G:if(gt)return gt.call(g)==gt.call(x)}return!1}function cn(g,x,$,Q,Ke,ve){var et=$&o,Tt=Gi(g),Re=Tt.length,Ge=Gi(x),wt=Ge.length;if(Re!=wt&&!et)return!1;for(var rr=Re;rr--;){var Nt=Tt[rr];if(!(et?Nt in x:Me.call(x,Nt)))return!1}var tt=ve.get(g);if(tt&&ve.get(x))return tt==x;var Jt=!0;ve.set(g,x),ve.set(x,g);for(var Rr=et;++rr<Re;){Nt=Tt[rr];var vr=g[Nt],Mr=x[Nt];if(Q)var _s=et?Q(Mr,vr,Nt,x,g,ve):Q(vr,Mr,Nt,g,x,ve);if(!(_s===void 0?vr===Mr||Ke(vr,Mr,$,Q,ve):_s)){Jt=!1;break}Rr||(Rr=Nt=="constructor")}if(Jt&&!Rr){var Ci=g.constructor,Mt=x.constructor;Ci!=Mt&&"constructor"in g&&"constructor"in x&&!(typeof Ci=="function"&&Ci instanceof Ci&&typeof Mt=="function"&&Mt instanceof Mt)&&(Jt=!1)}return ve.delete(g),ve.delete(x),Jt}function Gi(g){return vs(g,ko,hn)}function ci(g,x){var $=g.__data__;return fn(x)?$[typeof x=="string"?"string":"hash"]:$.map}function hr(g,x){var $=$e(g,x);return qo($)?$:void 0}function un(g){var x=Me.call(g,Wt),$=g[Wt];try{g[Wt]=void 0;var Q=!0}catch{}var Ke=Dt.call(g);return Q&&(x?g[Wt]=$:delete g[Wt]),Ke}var hn=Br?function(g){return g==null?[]:(g=Object(g),Ne(Br(g),function(x){return tr.call(g,x)}))}:Ve,qr=Si;(ht&&qr(new ht(new ArrayBuffer(1)))!=Te||rt&&qr(new rt)!=W||lt&&qr(lt.resolve())!=pe||ft&&qr(new ft)!=T||at&&qr(new at)!=re)&&(qr=function(g){var x=Si(g),$=x==ge?g.constructor:void 0,Q=$?Kr($):"";if(Q)switch(Q){case St:return Te;case At:return W;case pt:return pe;case Rt:return T;case dt:return re}return x});function ln(g,x){return x=x??d,!!x&&(typeof g=="number"||Lr.test(g))&&g>-1&&g%1==0&&g<x}function fn(g){var x=typeof g;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?g!=="__proto__":g===null}function pn(g){return!!Pt&&Pt in g}function dn(g){var x=g&&g.constructor,$=typeof x=="function"&&x.prototype||Fe;return g===$}function jo(g){return Dt.call(g)}function Kr(g){if(g!=null){try{return ut.call(g)}catch{}try{return g+""}catch{}}return""}function gn(g,x){return g===x||g!==g&&x!==x}var yn=ms(function(){return arguments}())?ms:function(g){return Ri(g)&&Me.call(g,"callee")&&!tr.call(g,"callee")},Wi=Array.isArray;function Uo(g){return g!=null&&vn(g.length)&&!Ji(g)}var ws=ai||ke;function zo(g,x){return Ai(g,x)}function Ji(g){if(!mn(g))return!1;var x=Si(g);return x==K||x==q||x==S||x==he}function vn(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function mn(g){var x=typeof g;return g!=null&&(x=="object"||x=="function")}function Ri(g){return g!=null&&typeof g=="object"}var wn=_e?vt(_e):on;function ko(g){return Uo(g)?sn(g):an(g)}function Ve(){return[]}function ke(){return!1}u.exports=zo})(po,po.exports);var nw=po.exports;const ow=jl(nw);function aw(u,i){if(u.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<u.length;o++){var h=u.charAt(o),d=h.charCodeAt(0);if(r[d]!==255)throw new TypeError(h+" is ambiguous");r[d]=o}var v=u.length,_=u.charAt(0),S=Math.log(v)/Math.log(256),F=Math.log(256)/Math.log(v);function k(q){if(q instanceof Uint8Array||(ArrayBuffer.isView(q)?q=new Uint8Array(q.buffer,q.byteOffset,q.byteLength):Array.isArray(q)&&(q=Uint8Array.from(q))),!(q instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(q.length===0)return"";for(var W=0,ie=0,Ee=0,ge=q.length;Ee!==ge&&q[Ee]===0;)Ee++,W++;for(var pe=(ge-Ee)*F+1>>>0,he=new Uint8Array(pe);Ee!==ge;){for(var le=q[Ee],T=0,M=pe-1;(le!==0||T<ie)&&M!==-1;M--,T++)le+=256*he[M]>>>0,he[M]=le%v>>>0,le=le/v>>>0;if(le!==0)throw new Error("Non-zero carry");ie=T,Ee++}for(var G=pe-ie;G!==pe&&he[G]===0;)G++;for(var ye=_.repeat(W);G<pe;++G)ye+=u.charAt(he[G]);return ye}function B(q){if(typeof q!="string")throw new TypeError("Expected String");if(q.length===0)return new Uint8Array;var W=0;if(q[W]!==" "){for(var ie=0,Ee=0;q[W]===_;)ie++,W++;for(var ge=(q.length-W)*S+1>>>0,pe=new Uint8Array(ge);q[W];){var he=r[q.charCodeAt(W)];if(he===255)return;for(var le=0,T=ge-1;(he!==0||le<Ee)&&T!==-1;T--,le++)he+=v*pe[T]>>>0,pe[T]=he%256>>>0,he=he/256>>>0;if(he!==0)throw new Error("Non-zero carry");Ee=le,W++}if(q[W]!==" "){for(var M=ge-Ee;M!==ge&&pe[M]===0;)M++;for(var G=new Uint8Array(ie+(ge-M)),ye=ie;M!==ge;)G[ye++]=pe[M++];return G}}}function K(q){var W=B(q);if(W)return W;throw new Error(`Non-${i} character`)}return{encode:k,decodeUnsafe:B,decode:K}}var cw=aw,uw=cw;const cf=u=>{if(u instanceof Uint8Array&&u.constructor.name==="Uint8Array")return u;if(u instanceof ArrayBuffer)return new Uint8Array(u);if(ArrayBuffer.isView(u))return new Uint8Array(u.buffer,u.byteOffset,u.byteLength);throw new Error("Unknown type, must be binary type")},hw=u=>new TextEncoder().encode(u),lw=u=>new TextDecoder().decode(u);class fw{constructor(i,r,n){this.name=i,this.prefix=r,this.baseEncode=n}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class pw{constructor(i,r,n){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return uf(this,i)}}class dw{constructor(i){this.decoders=i}or(i){return uf(this,i)}decode(i){const r=i[0],n=this.decoders[r];if(n)return n.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const uf=(u,i)=>new dw({...u.decoders||{[u.prefix]:u},...i.decoders||{[i.prefix]:i}});class gw{constructor(i,r,n,o){this.name=i,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new fw(i,r,n),this.decoder=new pw(i,r,o)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const _o=({name:u,prefix:i,encode:r,decode:n})=>new gw(u,i,r,n),Zs=({prefix:u,name:i,alphabet:r})=>{const{encode:n,decode:o}=uw(r,i);return _o({prefix:u,name:i,encode:n,decode:h=>cf(o(h))})},yw=(u,i,r,n)=>{const o={};for(let F=0;F<i.length;++F)o[i[F]]=F;let h=u.length;for(;u[h-1]==="=";)--h;const d=new Uint8Array(h*r/8|0);let v=0,_=0,S=0;for(let F=0;F<h;++F){const k=o[u[F]];if(k===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<r|k,v+=r,v>=8&&(v-=8,d[S++]=255&_>>v)}if(v>=r||255&_<<8-v)throw new SyntaxError("Unexpected end of data");return d},vw=(u,i,r)=>{const n=i[i.length-1]==="=",o=(1<<r)-1;let h="",d=0,v=0;for(let _=0;_<u.length;++_)for(v=v<<8|u[_],d+=8;d>r;)d-=r,h+=i[o&v>>d];if(d&&(h+=i[o&v<<r-d]),n)for(;h.length*r&7;)h+="=";return h},Ht=({name:u,prefix:i,bitsPerChar:r,alphabet:n})=>_o({prefix:i,name:u,encode(o){return vw(o,n,r)},decode(o){return yw(o,n,r,u)}}),mw=_o({prefix:"\0",name:"identity",encode:u=>lw(u),decode:u=>hw(u)});var ww=Object.freeze({__proto__:null,identity:mw});const _w=Ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var bw=Object.freeze({__proto__:null,base2:_w});const Ew=Ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var xw=Object.freeze({__proto__:null,base8:Ew});const Iw=Zs({prefix:"9",name:"base10",alphabet:"0123456789"});var Pw=Object.freeze({__proto__:null,base10:Iw});const Sw=Ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Aw=Ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Rw=Object.freeze({__proto__:null,base16:Sw,base16upper:Aw});const Cw=Ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ow=Ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Tw=Ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Nw=Ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fw=Ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Dw=Ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Lw=Ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$w=Ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qw=Ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Mw=Object.freeze({__proto__:null,base32:Cw,base32upper:Ow,base32pad:Tw,base32padupper:Nw,base32hex:Fw,base32hexupper:Dw,base32hexpad:Lw,base32hexpadupper:$w,base32z:qw});const jw=Zs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Uw=Zs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var zw=Object.freeze({__proto__:null,base36:jw,base36upper:Uw});const kw=Zs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Hw=Zs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Bw=Object.freeze({__proto__:null,base58btc:kw,base58flickr:Hw});const Vw=Ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Kw=Ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Gw=Ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ww=Ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Jw=Object.freeze({__proto__:null,base64:Vw,base64pad:Kw,base64url:Gw,base64urlpad:Ww});const hf=Array.from(""),Qw=hf.reduce((u,i,r)=>(u[r]=i,u),[]),Yw=hf.reduce((u,i,r)=>(u[i.codePointAt(0)]=r,u),[]);function Xw(u){return u.reduce((i,r)=>(i+=Qw[r],i),"")}function Zw(u){const i=[];for(const r of u){const n=Yw[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(n)}return new Uint8Array(i)}const e_=_o({prefix:"",name:"base256emoji",encode:Xw,decode:Zw});var t_=Object.freeze({__proto__:null,base256emoji:e_}),r_=lf,rl=128,i_=127,s_=~i_,n_=Math.pow(2,31);function lf(u,i,r){i=i||[],r=r||0;for(var n=r;u>=n_;)i[r++]=u&255|rl,u/=128;for(;u&s_;)i[r++]=u&255|rl,u>>>=7;return i[r]=u|0,lf.bytes=r-n+1,i}var o_=hc,a_=128,il=127;function hc(u,n){var r=0,n=n||0,o=0,h=n,d,v=u.length;do{if(h>=v)throw hc.bytes=0,new RangeError("Could not decode varint");d=u[h++],r+=o<28?(d&il)<<o:(d&il)*Math.pow(2,o),o+=7}while(d>=a_);return hc.bytes=h-n,r}var c_=Math.pow(2,7),u_=Math.pow(2,14),h_=Math.pow(2,21),l_=Math.pow(2,28),f_=Math.pow(2,35),p_=Math.pow(2,42),d_=Math.pow(2,49),g_=Math.pow(2,56),y_=Math.pow(2,63),v_=function(u){return u<c_?1:u<u_?2:u<h_?3:u<l_?4:u<f_?5:u<p_?6:u<d_?7:u<g_?8:u<y_?9:10},m_={encode:r_,decode:o_,encodingLength:v_},ff=m_;const sl=(u,i,r=0)=>(ff.encode(u,i,r),i),nl=u=>ff.encodingLength(u),lc=(u,i)=>{const r=i.byteLength,n=nl(u),o=n+nl(r),h=new Uint8Array(o+r);return sl(u,h,0),sl(r,h,n),h.set(i,o),new w_(u,r,i,h)};class w_{constructor(i,r,n,o){this.code=i,this.size=r,this.digest=n,this.bytes=o}}const pf=({name:u,code:i,encode:r})=>new __(u,i,r);class __{constructor(i,r,n){this.name=i,this.code=r,this.encode=n}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?lc(this.code,r):r.then(n=>lc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const df=u=>async i=>new Uint8Array(await crypto.subtle.digest(u,i)),b_=pf({name:"sha2-256",code:18,encode:df("SHA-256")}),E_=pf({name:"sha2-512",code:19,encode:df("SHA-512")});var x_=Object.freeze({__proto__:null,sha256:b_,sha512:E_});const gf=0,I_="identity",yf=cf,P_=u=>lc(gf,yf(u)),S_={code:gf,name:I_,encode:yf,digest:P_};var A_=Object.freeze({__proto__:null,identity:S_});new TextEncoder,new TextDecoder;const ol={...ww,...bw,...xw,...Pw,...Rw,...Mw,...zw,...Bw,...Jw,...t_};({...x_,...A_});function vf(u){return globalThis.Buffer!=null?new Uint8Array(u.buffer,u.byteOffset,u.byteLength):u}function R_(u=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?vf(globalThis.Buffer.allocUnsafe(u)):new Uint8Array(u)}function mf(u,i,r,n){return{name:u,prefix:i,encoder:{name:u,prefix:i,encode:r},decoder:{decode:n}}}const al=mf("utf8","u",u=>"u"+new TextDecoder("utf8").decode(u),u=>new TextEncoder().encode(u.substring(1))),Za=mf("ascii","a",u=>{let i="a";for(let r=0;r<u.length;r++)i+=String.fromCharCode(u[r]);return i},u=>{u=u.substring(1);const i=R_(u.length);for(let r=0;r<u.length;r++)i[r]=u.charCodeAt(r);return i}),C_={utf8:al,"utf-8":al,hex:ol.base16,latin1:Za,ascii:Za,binary:Za,...ol};function O_(u,i="utf8"){const r=C_[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?vf(globalThis.Buffer.from(u,"utf-8")):r.decoder.decode(`${r.prefix}${u}`)}const wf="wc",T_=2,Ic="core",_i=`${wf}@2:${Ic}:`,N_={name:Ic,logger:"error"},F_={database:":memory:"},D_="crypto",cl="client_ed25519_seed",L_=se.ONE_DAY,$_="keychain",q_="0.3",M_="messages",j_="0.3",U_=se.SIX_HOURS,z_="publisher",_f="irn",k_="error",bf="wss://relay.walletconnect.com",ul="wss://relay.walletconnect.org",H_="relayer",Kt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},B_="_subscription",si={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},V_=se.ONE_SECOND,K_="2.10.1",G_=1e4,W_="0.3",J_="WALLETCONNECT_CLIENT_ID",Hr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Q_="subscription",Y_="0.3",X_=se.FIVE_SECONDS*1e3,Z_="pairing",eb="0.3",zs={wc_pairingDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:se.ONE_DAY,prompt:!1,tag:0},res:{ttl:se.ONE_DAY,prompt:!1,tag:0}}},Gs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},tb="history",rb="0.3",ib="expirer",Pr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},sb="0.3",ec="verify-api",lo="https://verify.walletconnect.com",hl="https://verify.walletconnect.org";class nb{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=$_,this.version=q_,this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:h}=Z("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=i,this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,Hl(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Bl(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class ob{constructor(i,r,n){this.core=i,this.logger=r,this.name=D_,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=Wh(o);return Zl(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=l1();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),d=Wh(h),v=cc();return await qm(v,o,L_,d)},this.generateSharedKey=(o,h,d)=>{this.isInitialized();const v=this.getPrivateKey(o),_=f1(v,h);return this.setSymKey(_,d)},this.setSymKey=async(o,h)=>{this.isInitialized();const d=h||p1(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,d)=>{this.isInitialized();const v=d1(d),_=Ys(h);if(Rh(v)){const B=v.senderPublicKey,K=v.receiverPublicKey;o=await this.generateSharedKey(B,K)}const S=this.getSymKey(o),{type:F,senderPublicKey:k}=v;return g1({type:F,symKey:S,message:_,senderPublicKey:k})},this.decode=async(o,h,d)=>{this.isInitialized();const v=y1(h,d);if(Rh(v)){const _=v.receiverPublicKey,S=v.senderPublicKey;o=await this.generateSharedKey(_,S)}try{const _=this.getSymKey(o),S=v1({symKey:_,encoded:h});return mc(S)}catch(_){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=o=>{const h=Ch(o);return m1(h.type)},this.getPayloadSenderPublicKey=o=>{const h=Ch(o);return h.senderPublicKey?yo(h.senderPublicKey,w1):void 0},this.core=i,this.logger=Oe.generateChildLogger(r,this.name),this.keychain=n||new nb(this.core,this.logger)}get context(){return Oe.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(cl)}catch{i=cc(),await this.keychain.set(cl,i)}return O_(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class ab extends pm{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=M_,this.version=j_,this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const h=fs(o);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[h]<"u"||(d[h]=o,this.messages.set(n,d),await this.persist()),h},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const h=this.get(n),d=fs(o);return typeof h[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Oe.generateChildLogger(i,this.name),this.core=r}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,Hl(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Bl(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class cb extends dm{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new Sr.EventEmitter,this.name=z_,this.queue=new Map,this.publishTimeout=se.toMiliseconds(se.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,h)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}});try{const v=(h==null?void 0:h.ttl)||U_,_=uc(h),S=(h==null?void 0:h.prompt)||!1,F=(h==null?void 0:h.tag)||0,k=(h==null?void 0:h.id)||nf().toString(),B={topic:n,message:o,opts:{ttl:v,relay:_,prompt:S,tag:F,id:k}},K=setTimeout(()=>this.queue.set(k,B),this.publishTimeout);try{await await Qs(this.rpcPublish(n,o,v,_,S,F,k),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(k),this.relayer.events.emit(Kt.publish,B)}catch(q){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=h==null?void 0:h.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(k),q;return}finally{clearTimeout(K)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}})}catch(v){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(v),v}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=i,this.logger=Oe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Oe.getLoggerContext(this.logger)}rpcPublish(i,r,n,o,h,d,v){var _,S,F,k;const B={method:uo(o.protocol).publish,params:{topic:i,message:r,ttl:n,prompt:h,tag:d},id:v};return wi((_=B.params)==null?void 0:_.prompt)&&((S=B.params)==null||delete S.prompt),wi((F=B.params)==null?void 0:F.tag)&&((k=B.params)==null||delete k.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:B}),this.relayer.request(B)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:n,opts:o}=i;await this.publish(r,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Kt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Kt.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}}class ub{constructor(){this.map=new Map,this.set=(i,r)=>{const n=this.get(i);this.exists(i,r)||this.map.set(i,[...n,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const n=this.get(i);if(!this.exists(i,r))return;const o=n.filter(h=>h!==r);if(!o.length){this.map.delete(i);return}this.map.set(i,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var hb=Object.defineProperty,lb=Object.defineProperties,fb=Object.getOwnPropertyDescriptors,ll=Object.getOwnPropertySymbols,pb=Object.prototype.hasOwnProperty,db=Object.prototype.propertyIsEnumerable,fl=(u,i,r)=>i in u?hb(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,ks=(u,i)=>{for(var r in i||(i={}))pb.call(i,r)&&fl(u,r,i[r]);if(ll)for(var r of ll(i))db.call(i,r)&&fl(u,r,i[r]);return u},tc=(u,i)=>lb(u,fb(i));class gb extends vm{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new ub,this.events=new Sr.EventEmitter,this.name=Q_,this.version=Y_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=_i,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const h=uc(o),d={topic:n,relay:h};this.pending.set(n,d);const v=await this.rpcSubscribe(n,h);return this.onSubscribe(v,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),v}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,h)=>{const d=new se.Watch;d.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),o(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=X_&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=Oe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let n=!1;try{n=this.getSubscription(i).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const n=this.topicMap.get(i);await Promise.all(n.map(async o=>await this.unsubscribeById(i,o,r)))}async unsubscribeById(i,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}});try{const o=uc(n);await this.rpcUnsubscribe(i,r,o);const h=er("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(i,r){const n={method:uo(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Qs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}return fs(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,n={method:uo(r.protocol).batchSubscribe,params:{topics:i.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Qs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Kt.connection_stalled)}}rpcUnsubscribe(i,r,n){const o={method:uo(n.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(i,r){this.setSubscription(i,tc(ks({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,ks({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,n),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,ks({},r)),this.topicMap.set(r.topic,i),this.events.emit(Hr.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const n=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(n.topic,i),this.events.emit(Hr.deleted,tc(ks({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Hr.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Hr.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);ds(r)&&this.onBatchSubscribe(r.map((n,o)=>tc(ks({},i[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Kt.connect,async()=>{await this.onConnect()}),this.relayer.on(Kt.disconnect,()=>{this.onDisconnect()}),this.events.on(Hr.created,async i=>{const r=Hr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(Hr.deleted,async i=>{const r=Hr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var yb=Object.defineProperty,pl=Object.getOwnPropertySymbols,vb=Object.prototype.hasOwnProperty,mb=Object.prototype.propertyIsEnumerable,dl=(u,i,r)=>i in u?yb(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,wb=(u,i)=>{for(var r in i||(i={}))vb.call(i,r)&&dl(u,r,i[r]);if(pl)for(var r of pl(i))mb.call(i,r)&&dl(u,r,i[r]);return u};class _b extends gm{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new Sr.EventEmitter,this.name=H_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Kt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Kt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(si.payload,this.onPayloadHandler),this.provider.on(si.connect,this.onConnectHandler),this.provider.on(si.disconnect,this.onDisconnectHandler),this.provider.on(si.error,this.onProviderErrorHandler)},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?Oe.generateChildLogger(i.logger,this.name):Oe.pino(Oe.getDefaultLoggerOptions({level:i.logger||k_})),this.messages=new ab(this.logger,i.core),this.subscriber=new gb(this,this.logger),this.publisher=new cb(this,this.logger),this.relayUrl=(i==null?void 0:i.relayUrl)||bf,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${ul}...`),await this.restartTransport(ul)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},G_)}get context(){return Oe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,n){this.isInitialized(),await this.publisher.publish(i,r,n),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(i))==null?void 0:n[0])||"";return o||(await Promise.all([new Promise(h=>{this.subscriber.once(Hr.created,d=>{d.topic===i&&h()})}),new Promise(async h=>{o=await this.subscriber.subscribe(i,r),h()})]),o)}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Qs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(i){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Hr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Qs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(si.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(i){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=i||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Oh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ei(new sw(_1({sdkVersion:K_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:n}=i;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(i){const{topic:r,message:n}=i;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),xc(i)){if(!i.method.endsWith(B_))return;const r=i.params,{topic:n,message:o,publishedAt:h}=r.data,d={topic:n,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(wb({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(i),await this.onMessageEvent(d)}else wo(i)&&this.events.emit(Kt.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(Kt.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=Ec(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(si.payload,this.onPayloadHandler),this.provider.off(si.connect,this.onConnectHandler),this.provider.off(si.disconnect,this.onDisconnectHandler),this.provider.off(si.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Kt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let i=await Oh();b1(async r=>{this.initialized&&i!==r&&(i=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Kt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(i=>this.logger.error(i))},se.toMiliseconds(V_)))}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var bb=Object.defineProperty,gl=Object.getOwnPropertySymbols,Eb=Object.prototype.hasOwnProperty,xb=Object.prototype.propertyIsEnumerable,yl=(u,i,r)=>i in u?bb(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,vl=(u,i)=>{for(var r in i||(i={}))Eb.call(i,r)&&yl(u,r,i[r]);if(gl)for(var r of gl(i))xb.call(i,r)&&yl(u,r,i[r]);return u};class bo extends ym{constructor(i,r,n,o=_i,h=void 0){super(i,r,n,o),this.core=i,this.logger=r,this.name=n,this.map=new Map,this.version=W_,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!wi(d)?this.map.set(this.getKey(d),d):u1(d)?this.map.set(d.id,d):h1(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,v)=>{this.isInitialized(),this.map.has(d)?await this.update(d,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:v}),this.map.set(d,v),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(v=>Object.keys(d).every(_=>ow(v[_],d[_]))):this.values),this.update=async(d,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:v});const _=vl(vl({},this.getData(d)),v);this.map.set(d,_),await this.persist()},this.delete=async(d,v)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:v}),this.map.delete(d),await this.persist())},this.logger=Oe.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=h}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Ib{constructor(i,r){this.core=i,this.logger=r,this.name=Z_,this.version=eb,this.events=new vc,this.initialized=!1,this.storagePrefix=_i,this.ignoredPayloadTypes=[Ul],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=cc(),o=await this.core.crypto.setSymKey(n),h=Fr(se.FIVE_MINUTES),d={protocol:_f},v={topic:o,expiry:h,relay:d,active:!1},_=E1({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:d});return await this.pairings.set(o,v),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:h,relay:d}=x1(n.uri);let v;if(this.pairings.keys.includes(o)&&(v=this.pairings.get(o),v.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:d}));const _=Fr(se.FIVE_MINUTES),S={topic:o,relay:d,expiry:_,active:!1};return await this.pairings.set(o,S),this.core.expirer.set(o,_),n.activatePairing&&await this.activate({topic:o}),this.events.emit(Gs.create,S),S},this.activate=async({topic:n})=>{this.isInitialized();const o=Fr(se.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:v,reject:_}=us();this.events.once(Ft("pairing_ping",h),({error:S})=>{S?_(S):v()}),await d()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",er("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,h)=>{const d=ps(o,h),v=await this.core.crypto.encode(n,d),_=zs[o].req;return this.core.history.set(n,d),this.core.relayer.publish(n,v,_),d.id},this.sendResult=async(n,o,h)=>{const d=Ec(n,h),v=await this.core.crypto.encode(o,d),_=await this.core.history.get(o,n),S=zs[_.request.method].res;await this.core.relayer.publish(o,v,S),await this.core.history.resolve(d)},this.sendError=async(n,o,h)=>{const d=mo(n,h),v=await this.core.crypto.encode(o,d),_=await this.core.history.get(o,n),S=zs[_.request.method]?zs[_.request.method].res:zs.unregistered_method.res;await this.core.relayer.publish(o,v,S),await this.core.history.resolve(d)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,er("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>mi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:h}=n;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:h}=n,d=(await this.core.history.get(o,h.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,o)=>{const{id:h}=o;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit(Gs.ping,{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,o)=>{const{id:h}=o;setTimeout(()=>{oi(o)?this.events.emit(Ft("pairing_ping",h),{}):Dr(o)&&this.events.emit(Ft("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Gs.delete,{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:h,method:d}=o;try{if(this.registeredMethods.includes(d))return;const v=er("WC_METHOD_UNSUPPORTED",d);await this.sendError(h,n,v),this.logger.error(v)}catch(v){await this.sendError(h,n,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(er("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!cr(n)){const{message:o}=Z("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!I1(n.uri)){const{message:o}=Z("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!cr(n)){const{message:h}=Z("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!cr(n)){const{message:h}=Z("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!hs(n,!1)){const{message:o}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(mi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Z("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=i,this.logger=Oe.generateChildLogger(r,this.name),this.pairings=new bo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Oe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(Kt.message,async i=>{const{topic:r,message:n}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(r,n);try{xc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):wo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Pr.expired,async i=>{const{topic:r}=zl(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Gs.expire,{topic:r}))})}}class Pb extends fm{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new Sr.EventEmitter,this.name=tb,this.version=rb,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:h}),this.records.has(o.id))return;const d={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:h,expiry:Fr(se.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(kr.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=Dr(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(kr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===n){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(kr.deleted,h)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ps(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(n)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(kr.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(kr.created,i=>{const r=kr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(kr.updated,i=>{const r=kr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(kr.deleted,i=>{const r=kr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{se.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Sb extends mm{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new Sr.EventEmitter,this.name=ib,this.version=sb,this.cached=[],this.initialized=!1,this.storagePrefix=_i,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const h=this.formatTarget(n),d={target:h,expiry:o};this.expirations.set(h,d),this.checkExpiry(h,d),this.events.emit(Pr.created,{target:h,expiration:d})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Pr.deleted,{target:o,expiration:h})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return P1(i);if(typeof i=="number")return S1(i);const{message:r}=Z("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Pr.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(i,r){const{expiry:n}=r;se.toMiliseconds(n)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Pr.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(gs.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Pr.created,i=>{const r=Pr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Pr.expired,i=>{const r=Pr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Pr.deleted,i=>{const r=Pr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Ab extends wm{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=ec,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||A1()||!kl())return;const o=(n==null?void 0:n.verifyUrl)||lo;this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=hl;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=(n==null?void 0:n.verifyUrl)||lo;let h;try{h=await this.fetchAttestation(n.attestationId,o)}catch(d){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.info(d),h=await this.fetchAttestation(n.attestationId,hl)}return h},this.fetchAttestation=async(n,o)=>{this.logger.info(`resolving attestation: ${n} from url: ${o}`);const h=this.startAbortTimer(se.ONE_SECOND*2),d=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(h),d.status===200?await d.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(h=>{if(document.getElementById(ec))return h();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=ec,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,n=h}),new Promise((h,d)=>setTimeout(()=>{window.removeEventListener("message",o),d("verify iframe load timeout")},se.toMiliseconds(se.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Oe.generateChildLogger(r,this.name),this.verifyUrl=lo,this.abortController=new AbortController,this.isDevEnv=R1()&&{}.IS_VITEST}get context(){return Oe.getLoggerContext(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),se.toMiliseconds(i))}}var Rb=Object.defineProperty,ml=Object.getOwnPropertySymbols,Cb=Object.prototype.hasOwnProperty,Ob=Object.prototype.propertyIsEnumerable,wl=(u,i,r)=>i in u?Rb(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,_l=(u,i)=>{for(var r in i||(i={}))Cb.call(i,r)&&wl(u,r,i[r]);if(ml)for(var r of ml(i))Ob.call(i,r)&&wl(u,r,i[r]);return u};class Pc extends lm{constructor(i){super(i),this.protocol=wf,this.version=T_,this.name=Ic,this.events=new Sr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=i==null?void 0:i.projectId,this.relayUrl=(i==null?void 0:i.relayUrl)||bf;const r=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Oe.pino(Oe.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||N_.logger}));this.logger=Oe.generateChildLogger(r,this.name),this.heartbeat=new gs.HeartBeat,this.crypto=new ob(this,this.logger,i==null?void 0:i.keychain),this.history=new Pb(this,this.logger),this.expirer=new Sb(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new rm(_l(_l({},F_),i==null?void 0:i.storageOptions)),this.relayer=new _b({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ib(this,this.logger),this.verify=new Ab(this.projectId||"",this.logger)}static async init(i){const r=new Pc(i);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(J_,n),r}get context(){return Oe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const Tb=Pc,Ef="wc",xf=2,If="client",Sc=`${Ef}@${xf}:${If}:`,rc={name:If,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},bl="WALLETCONNECT_DEEPLINK_CHOICE",Nb="proposal",Pf="Proposal expired",Fb="session",oo=se.SEVEN_DAYS,Db="engine",Hs={wc_sessionPropose:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1115}}},ic={min:se.FIVE_MINUTES,max:se.SEVEN_DAYS},ni={idle:"IDLE",active:"ACTIVE"},Lb="request",$b=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var qb=Object.defineProperty,Mb=Object.defineProperties,jb=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,Ub=Object.prototype.hasOwnProperty,zb=Object.prototype.propertyIsEnumerable,xl=(u,i,r)=>i in u?qb(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,ar=(u,i)=>{for(var r in i||(i={}))Ub.call(i,r)&&xl(u,r,i[r]);if(El)for(var r of El(i))zb.call(i,r)&&xl(u,r,i[r]);return u},Bs=(u,i)=>Mb(u,jb(i));class kb extends bm{constructor(i){super(i),this.name=Db,this.events=new vc,this.initialized=!1,this.ignoredPayloadTypes=[Ul],this.requestQueue={state:ni.idle,queue:[]},this.sessionRequestQueue={state:ni.idle,queue:[]},this.requestQueueDelay=se.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Hs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},se.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Bs(ar({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:d,sessionProperties:v,relays:_}=n;let S=o,F,k=!1;if(S&&(k=this.client.core.pairing.pairings.get(S).active),!S||!k){const{topic:pe,uri:he}=await this.client.core.pairing.create();S=pe,F=he}const B=await this.client.core.crypto.generateKeyPair(),K=ar({requiredNamespaces:h,optionalNamespaces:d,relays:_??[{protocol:_f}],proposer:{publicKey:B,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:q,resolve:W,done:ie}=us(se.FIVE_MINUTES,Pf);if(this.events.once(Ft("session_connect"),async({error:pe,session:he})=>{if(pe)q(pe);else if(he){he.self.publicKey=B;const le=Bs(ar({},he),{requiredNamespaces:he.requiredNamespaces,optionalNamespaces:he.optionalNamespaces});await this.client.session.set(he.topic,le),await this.setExpiry(he.topic,he.expiry),S&&await this.client.core.pairing.updateMetadata({topic:S,metadata:he.peer.metadata}),W(le)}}),!S){const{message:pe}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${S}`);throw new Error(pe)}const Ee=await this.sendRequest({topic:S,method:"wc_sessionPropose",params:K}),ge=Fr(se.FIVE_MINUTES);return await this.setProposal(Ee,ar({id:Ee,expiry:ge},K)),{uri:F,approval:ie}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:o,namespaces:h,sessionProperties:d}=r,v=this.client.proposal.get(n);let{pairingTopic:_,proposer:S,requiredNamespaces:F,optionalNamespaces:k}=v;_=_||"",ho(F)||(F=O1(h,"approve()"));const B=await this.client.core.crypto.generateKeyPair(),K=S.publicKey,q=await this.client.core.crypto.generateSharedKey(B,K);_&&n&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:S.metadata}),await this.sendResult({id:n,topic:_,result:{relay:{protocol:o??"irn"},responderPublicKey:B}}),await this.client.proposal.delete(n,er("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const W=ar({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:F,optionalNamespaces:k,pairingTopic:_,controller:{publicKey:B,metadata:this.client.metadata},expiry:Fr(oo)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(q),await this.sendRequest({topic:q,method:"wc_sessionSettle",params:W,throwOnFailedPublish:!0});const ie=Bs(ar({},W),{topic:q,pairingTopic:_,acknowledged:!1,self:W.controller,peer:{publicKey:S.publicKey,metadata:S.metadata},controller:B});return await this.client.session.set(q,ie),await this.setExpiry(q,Fr(oo)),{topic:q,acknowledged:()=>new Promise(Ee=>setTimeout(()=>Ee(this.client.session.get(q)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:o}=r,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,o),await this.client.proposal.delete(n,er("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:o}=r,h=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:d,resolve:v,reject:_}=us();return this.events.once(Ft("session_update",h),({error:S})=>{S?_(S):v()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:d}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:h,resolve:d,reject:v}=us();return this.events.once(Ft("session_extend",o),({error:_})=>{_?v(_):d()}),await this.setExpiry(n,Fr(oo)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:o,topic:h,expiry:d}=r,v=bc(),{done:_,resolve:S,reject:F}=us(d);return this.events.once(Ft("session_request",v),({error:k,result:B})=>{k?F(k):S(B)}),await Promise.all([new Promise(async k=>{await this.sendRequest({clientRpcId:v,topic:h,method:"wc_sessionRequest",params:{request:o,chainId:n},expiry:d,throwOnFailedPublish:!0}).catch(B=>F(B)),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:n,id:v}),k()}),new Promise(async k=>{const B=await this.client.core.storage.getItem(bl);T1({id:v,topic:h,wcDeepLink:B}),k()}),_()]).then(k=>k[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:o}=r,{id:h}=o;oi(o)?await this.sendResult({id:h,topic:n,result:o.result,throwOnFailedPublish:!0}):Dr(o)&&await this.sendError(h,n,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:h,resolve:d,reject:v}=us();this.events.once(Ft("session_ping",o),({error:_})=>{_?v(_):d()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:o,chainId:h}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:er("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>N1(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var d,v;return((d=h.peerMetadata)==null?void 0:d.url)&&((v=h.peerMetadata)==null?void 0:v.url)===r.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,er("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(bl).catch(h=>this.client.logger.warn(h))},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,er("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),o&&(this.sessionRequestQueue.state=ni.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Hs.wc_sessionRequest.req.ttl,{id:o,topic:h,params:d,verifyContext:v}=r;await this.client.pendingRequest.set(o,{id:o,topic:h,params:d,verifyContext:v}),n&&this.client.core.expirer.set(o,Fr(n))},this.sendRequest=async r=>{const{topic:n,method:o,params:h,expiry:d,relayRpcId:v,clientRpcId:_,throwOnFailedPublish:S}=r,F=ps(o,h,_);if(kl()&&$b.includes(o)){const K=fs(JSON.stringify(F));this.client.core.verify.register({attestationId:K})}const k=await this.client.core.crypto.encode(n,F),B=Hs[o].req;return d&&(B.ttl=d),v&&(B.id=v),this.client.core.history.set(n,F),S?(B.internal=Bs(ar({},B.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,k,B)):this.client.core.relayer.publish(n,k,B).catch(K=>this.client.logger.error(K)),F.id},this.sendResult=async r=>{const{id:n,topic:o,result:h,throwOnFailedPublish:d}=r,v=Ec(n,h),_=await this.client.core.crypto.encode(o,v),S=await this.client.core.history.get(o,n),F=Hs[S.request.method].res;d?(F.internal=Bs(ar({},F.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,_,F)):this.client.core.relayer.publish(o,_,F).catch(k=>this.client.logger.error(k)),await this.client.core.history.resolve(v)},this.sendError=async(r,n,o)=>{const h=mo(r,o),d=await this.client.core.crypto.encode(n,h),v=await this.client.core.history.get(n,r),_=Hs[v.request.method].res;this.client.core.relayer.publish(n,d,_),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(o=>{mi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{mi(o.expiry)&&n.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ni.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ni.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ni.idle},this.processRequest=r=>{const{topic:n,payload:o}=r,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:o}=r,h=(await this.client.core.history.get(n,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:o}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,n)=>{const{params:o,id:h}=n;try{this.isValidConnect(ar({},n.params));const d=Fr(se.FIVE_MINUTES),v=ar({id:h,pairingTopic:r,expiry:d},o);await this.setProposal(h,v);const _=fs(JSON.stringify(n)),S=await this.getVerifyContext(_,v.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:v,verifyContext:S})}catch(d){await this.sendError(h,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,n)=>{const{id:o}=n;if(oi(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const v=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const _=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const S=await this.client.core.crypto.generateSharedKey(v,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:S});const F=await this.client.core.relayer.subscribe(S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:F}),await this.client.core.pairing.activate({topic:r})}else Dr(n)&&(await this.client.proposal.delete(o,er("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:o,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:d,controller:v,expiry:_,namespaces:S,requiredNamespaces:F,optionalNamespaces:k,sessionProperties:B,pairingTopic:K}=n.params,q=ar({topic:r,relay:d,expiry:_,namespaces:S,acknowledged:!0,pairingTopic:K,requiredNamespaces:F,optionalNamespaces:k,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},B&&{sessionProperties:B});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Ft("session_connect"),{session:q}),this.cleanupDuplicatePairings(q)}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,n)=>{const{id:o}=n;oi(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):Dr(n)&&(await this.client.session.delete(r,er("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:o,id:h}=n;try{const d=`${r}_session_update`,v=no.get(d);if(v&&this.isRequestOutOfSync(v,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(ar({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:o}),no.set(d,h)}catch(d){await this.sendError(h,r,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:o}=n;oi(n)?this.events.emit(Ft("session_update",o),{}):Dr(n)&&this.events.emit(Ft("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:o}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Fr(oo)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,n)=>{const{id:o}=n;oi(n)?this.events.emit(Ft("session_extend",o),{}):Dr(n)&&this.events.emit(Ft("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:o}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,n)=>{const{id:o}=n;setTimeout(()=>{oi(n)?this.events.emit(Ft("session_ping",o),{}):Dr(n)&&this.events.emit(Ft("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Kt.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,n)=>{const{id:o,params:h}=n;try{this.isValidRequest(ar({topic:r},h));const d=fs(JSON.stringify(ps("wc_sessionRequest",h,o))),v=this.client.session.get(r),_=await this.getVerifyContext(d,v.peer.metadata),S={id:o,topic:r,params:h,verifyContext:_};await this.setPendingSessionRequest(S),this.addSessionRequestToSessionRequestQueue(S),this.processSessionRequestQueue()}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,n)=>{const{id:o}=n;oi(n)?this.events.emit(Ft("session_request",o),{result:n.result}):Dr(n)&&this.events.emit(Ft("session_request",o),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:o,params:h}=n;try{const d=`${r}_session_event_${h.event.name}`,v=no.get(d);if(v&&this.isRequestOutOfSync(v,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(ar({topic:r},h)),this.client.events.emit("session_event",{id:o,topic:r,params:h}),no.set(d,o)}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ni.idle,this.processSessionRequestQueue()},se.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ni.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ni.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,ps("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer},n.id))},this.isValidConnect=async r=>{if(!cr(r)){const{message:_}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(_)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:d,relays:v}=r;if(wi(n)||await this.isValidPairingTopic(n),!F1(v,!0)){const{message:_}=Z("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(_)}!wi(o)&&ho(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!wi(h)&&ho(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),wi(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,n)=>{const o=D1(r,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!cr(r))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:o,relayProtocol:h,sessionProperties:d}=r;await this.isValidProposalId(n);const v=this.client.proposal.get(n),_=Ka(o,"approve()");if(_)throw new Error(_.message);const S=Th(v.requiredNamespaces,o,"approve()");if(S)throw new Error(S.message);if(!hs(h,!0)){const{message:F}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(F)}wi(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!cr(r)){const{message:h}=Z("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:n,reason:o}=r;if(await this.isValidProposalId(n),!L1(o)){const{message:h}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!cr(r)){const{message:S}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(S)}const{relay:n,controller:o,namespaces:h,expiry:d}=r;if(!$1(n)){const{message:S}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(S)}const v=q1(o,"onSessionSettleRequest()");if(v)throw new Error(v.message);const _=Ka(h,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(mi(d)){const{message:S}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(S)}},this.isValidUpdate=async r=>{if(!cr(r)){const{message:_}=Z("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(_)}const{topic:n,namespaces:o}=r;await this.isValidSessionTopic(n);const h=this.client.session.get(n),d=Ka(o,"update()");if(d)throw new Error(d.message);const v=Th(h.requiredNamespaces,o,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async r=>{if(!cr(r)){const{message:o}=Z("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!cr(r)){const{message:_}=Z("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(_)}const{topic:n,request:o,chainId:h,expiry:d}=r;await this.isValidSessionTopic(n);const{namespaces:v}=this.client.session.get(n);if(!Nh(v,h)){const{message:_}=Z("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(_)}if(!M1(o)){const{message:_}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!j1(v,h,o.method)){const{message:_}=Z("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(d&&!U1(d,ic)){const{message:_}=Z("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${ic.min} and ${ic.max}`);throw new Error(_)}},this.isValidRespond=async r=>{if(!cr(r)){const{message:h}=Z("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:n,response:o}=r;if(await this.isValidSessionTopic(n),!z1(o)){const{message:h}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!cr(r)){const{message:o}=Z("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!cr(r)){const{message:v}=Z("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(v)}const{topic:n,event:o,chainId:h}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Nh(d,h)){const{message:v}=Z("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(v)}if(!k1(o)){const{message:v}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}if(!H1(d,h,o.name)){const{message:v}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}},this.isValidDisconnect=async r=>{if(!cr(r)){const{message:o}=Z("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const o={verified:{verifyUrl:n.verifyUrl||lo,validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});h&&(o.verified.origin=h.origin,o.verified.isScam=h.isScam,o.verified.validation=h.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(o=>{if(!hs(o,!1)){const{message:h}=Z("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Kt.message,async i=>{const{topic:r,message:n}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(r,n);try{xc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):wo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Pr.expired,async i=>{const{topic:r,id:n}=zl(i.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Z("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Gs.create,i=>this.onPairingCreated(i))}isValidPairingTopic(i){if(!hs(i,!1)){const{message:r}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=Z("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!hs(i,!1)){const{message:r}=Z("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=Z("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(hs(i,!1)){const{message:r}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!B1(i)){const{message:r}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(mi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=Z("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class Hb extends bo{constructor(i,r){super(i,r,Nb,Sc),this.core=i,this.logger=r}}class Bb extends bo{constructor(i,r){super(i,r,Fb,Sc),this.core=i,this.logger=r}}class Vb extends bo{constructor(i,r){super(i,r,Lb,Sc,n=>n.id),this.core=i,this.logger=r}}let Kb=class Sf extends _m{constructor(i){super(i),this.protocol=Ef,this.version=xf,this.name=rc.name,this.events=new Sr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(i==null?void 0:i.name)||rc.name,this.metadata=(i==null?void 0:i.metadata)||C1();const r=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Oe.pino(Oe.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||rc.logger}));this.core=(i==null?void 0:i.core)||new Tb(i),this.logger=Oe.generateChildLogger(r,this.name),this.session=new Bb(this.core,this.logger),this.proposal=new Hb(this.core,this.logger),this.pendingRequest=new Vb(this.core,this.logger),this.engine=new kb(this)}static async init(i){const r=new Sf(i);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}};var fc={exports:{}};(function(u,i){var r=typeof self<"u"?self:ur,n=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(d){var v={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function _(y){return y&&DataView.prototype.isPrototypeOf(y)}if(v.arrayBuffer)var S=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],F=ArrayBuffer.isView||function(y){return y&&S.indexOf(Object.prototype.toString.call(y))>-1};function k(y){if(typeof y!="string"&&(y=String(y)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(y))throw new TypeError("Invalid character in header field name");return y.toLowerCase()}function B(y){return typeof y!="string"&&(y=String(y)),y}function K(y){var E={next:function(){var Y=y.shift();return{done:Y===void 0,value:Y}}};return v.iterable&&(E[Symbol.iterator]=function(){return E}),E}function q(y){this.map={},y instanceof q?y.forEach(function(E,Y){this.append(Y,E)},this):Array.isArray(y)?y.forEach(function(E){this.append(E[0],E[1])},this):y&&Object.getOwnPropertyNames(y).forEach(function(E){this.append(E,y[E])},this)}q.prototype.append=function(y,E){y=k(y),E=B(E);var Y=this.map[y];this.map[y]=Y?Y+", "+E:E},q.prototype.delete=function(y){delete this.map[k(y)]},q.prototype.get=function(y){return y=k(y),this.has(y)?this.map[y]:null},q.prototype.has=function(y){return this.map.hasOwnProperty(k(y))},q.prototype.set=function(y,E){this.map[k(y)]=B(E)},q.prototype.forEach=function(y,E){for(var Y in this.map)this.map.hasOwnProperty(Y)&&y.call(E,this.map[Y],Y,this)},q.prototype.keys=function(){var y=[];return this.forEach(function(E,Y){y.push(Y)}),K(y)},q.prototype.values=function(){var y=[];return this.forEach(function(E){y.push(E)}),K(y)},q.prototype.entries=function(){var y=[];return this.forEach(function(E,Y){y.push([Y,E])}),K(y)},v.iterable&&(q.prototype[Symbol.iterator]=q.prototype.entries);function W(y){if(y.bodyUsed)return Promise.reject(new TypeError("Already read"));y.bodyUsed=!0}function ie(y){return new Promise(function(E,Y){y.onload=function(){E(y.result)},y.onerror=function(){Y(y.error)}})}function Ee(y){var E=new FileReader,Y=ie(E);return E.readAsArrayBuffer(y),Y}function ge(y){var E=new FileReader,Y=ie(E);return E.readAsText(y),Y}function pe(y){for(var E=new Uint8Array(y),Y=new Array(E.length),ce=0;ce<E.length;ce++)Y[ce]=String.fromCharCode(E[ce]);return Y.join("")}function he(y){if(y.slice)return y.slice(0);var E=new Uint8Array(y.byteLength);return E.set(new Uint8Array(y)),E.buffer}function le(){return this.bodyUsed=!1,this._initBody=function(y){this._bodyInit=y,y?typeof y=="string"?this._bodyText=y:v.blob&&Blob.prototype.isPrototypeOf(y)?this._bodyBlob=y:v.formData&&FormData.prototype.isPrototypeOf(y)?this._bodyFormData=y:v.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)?this._bodyText=y.toString():v.arrayBuffer&&v.blob&&_(y)?(this._bodyArrayBuffer=he(y.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):v.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(y)||F(y))?this._bodyArrayBuffer=he(y):this._bodyText=y=Object.prototype.toString.call(y):this._bodyText="",this.headers.get("content-type")||(typeof y=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(y)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var y=W(this);if(y)return y;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?W(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ee)}),this.text=function(){var y=W(this);if(y)return y;if(this._bodyBlob)return ge(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(pe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(ye)}),this.json=function(){return this.text().then(JSON.parse)},this}var T=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function M(y){var E=y.toUpperCase();return T.indexOf(E)>-1?E:y}function G(y,E){E=E||{};var Y=E.body;if(y instanceof G){if(y.bodyUsed)throw new TypeError("Already read");this.url=y.url,this.credentials=y.credentials,E.headers||(this.headers=new q(y.headers)),this.method=y.method,this.mode=y.mode,this.signal=y.signal,!Y&&y._bodyInit!=null&&(Y=y._bodyInit,y.bodyUsed=!0)}else this.url=String(y);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new q(E.headers)),this.method=M(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Y)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Y)}G.prototype.clone=function(){return new G(this,{body:this._bodyInit})};function ye(y){var E=new FormData;return y.trim().split("&").forEach(function(Y){if(Y){var ce=Y.split("="),H=ce.shift().replace(/\+/g," "),j=ce.join("=").replace(/\+/g," ");E.append(decodeURIComponent(H),decodeURIComponent(j))}}),E}function re(y){var E=new q,Y=y.replace(/\r?\n[\t ]+/g," ");return Y.split(/\r?\n/).forEach(function(ce){var H=ce.split(":"),j=H.shift().trim();if(j){var z=H.join(":").trim();E.append(j,z)}}),E}le.call(G.prototype);function ue(y,E){E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"OK",this.headers=new q(E.headers),this.url=E.url||"",this._initBody(y)}le.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new q(this.headers),url:this.url})},ue.error=function(){var y=new ue(null,{status:0,statusText:""});return y.type="error",y};var Te=[301,302,303,307,308];ue.redirect=function(y,E){if(Te.indexOf(E)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:E,headers:{location:y}})},d.DOMException=h.DOMException;try{new d.DOMException}catch{d.DOMException=function(E,Y){this.message=E,this.name=Y;var ce=Error(E);this.stack=ce.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function Ue(y,E){return new Promise(function(Y,ce){var H=new G(y,E);if(H.signal&&H.signal.aborted)return ce(new d.DOMException("Aborted","AbortError"));var j=new XMLHttpRequest;function z(){j.abort()}j.onload=function(){var V={status:j.status,statusText:j.statusText,headers:re(j.getAllResponseHeaders()||"")};V.url="responseURL"in j?j.responseURL:V.headers.get("X-Request-URL");var Je="response"in j?j.response:j.responseText;Y(new ue(Je,V))},j.onerror=function(){ce(new TypeError("Network request failed"))},j.ontimeout=function(){ce(new TypeError("Network request failed"))},j.onabort=function(){ce(new d.DOMException("Aborted","AbortError"))},j.open(H.method,H.url,!0),H.credentials==="include"?j.withCredentials=!0:H.credentials==="omit"&&(j.withCredentials=!1),"responseType"in j&&v.blob&&(j.responseType="blob"),H.headers.forEach(function(V,Je){j.setRequestHeader(Je,V)}),H.signal&&(H.signal.addEventListener("abort",z),j.onreadystatechange=function(){j.readyState===4&&H.signal.removeEventListener("abort",z)}),j.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return Ue.polyfill=!0,h.fetch||(h.fetch=Ue,h.Headers=q,h.Request=G,h.Response=ue),d.Headers=q,d.Request=G,d.Response=ue,d.fetch=Ue,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;i=o.fetch,i.default=o.fetch,i.fetch=o.fetch,i.Headers=o.Headers,i.Request=o.Request,i.Response=o.Response,u.exports=i})(fc,fc.exports);var Gb=fc.exports;const Il=jl(Gb),Wb={Accept:"application/json","Content-Type":"application/json"},Jb="POST",Pl={headers:Wb,method:Jb},Sl=10;class zi{constructor(i,r=!1){if(this.url=i,this.disableProviderPing=r,this.events=new Sr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Xh(i))throw new Error(`Provided URL is not compatible with HTTP connection: ${i}`);this.url=i,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(i,r){this.isAvailable||await this.register();try{const n=Ys(i),h=await(await Il(this.url,Object.assign(Object.assign({},Pl),{body:n}))).json();this.onPayload({data:h})}catch(n){this.onError(i.id,n)}}async register(i=this.url){if(!Xh(i))throw new Error(`Provided URL is not compatible with HTTP connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=i,this.registering=!0;try{if(!this.disableProviderPing){const r=Ys({id:1,jsonrpc:"2.0",method:"test",params:[]});await Il(i,Object.assign(Object.assign({},Pl),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?mc(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),o=n.message||n.toString(),h=mo(i,o);this.events.emit("payload",h)}parseError(i,r=this.url){return rf(i,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Sl&&this.events.setMaxListeners(Sl)}}const Al="error",Qb="wss://relay.walletconnect.com",Yb="wc",Xb="universal_provider",Rl=`${Yb}@2:${Xb}:`,Zb="https://rpc.walletconnect.com/v1/",xi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},pc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(u,i){(function(){var r,n="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",v="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",S=500,F="__lodash_placeholder__",k=1,B=2,K=4,q=1,W=2,ie=1,Ee=2,ge=4,pe=8,he=16,le=32,T=64,M=128,G=256,ye=512,re=30,ue="...",Te=800,Ue=16,y=1,E=2,Y=3,ce=1/0,H=9007199254740991,j=17976931348623157e292,z=0/0,V=4294967295,Je=V-1,He=V>>>1,Lr=[["ary",M],["bind",ie],["bindKey",Ee],["curry",pe],["curryRight",he],["flip",ye],["partial",le],["partialRight",T],["rearg",G]],xe="[object Arguments]",xt="[object Array]",O="[object AsyncFunction]",C="[object Boolean]",A="[object Date]",c="[object DOMException]",b="[object Error]",ee="[object Function]",fe="[object GeneratorFunction]",_e="[object Map]",Ne="[object Number]",De="[object Null]",Se="[object Object]",It="[object Promise]",vt="[object Proxy]",nt="[object RegExp]",$e="[object Set]",Ye="[object String]",Xe="[object Symbol]",ot="[object Undefined]",ze="[object WeakMap]",Ze="[object WeakSet]",Fe="[object ArrayBuffer]",Be="[object DataView]",ut="[object Float32Array]",Me="[object Float64Array]",Pt="[object Int8Array]",Dt="[object Int16Array]",Ut="[object Int32Array]",zt="[object Uint8Array]",qt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",tr="[object Uint32Array]",$r=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,Br=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ai=/&(?:amp|lt|gt|quot|#39);/g,Ii=/[&<>"']/g,ht=RegExp(ai.source),rt=RegExp(Ii.source),lt=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,at=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,At=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(pt.source),dt=/^\s+/,mt=/\s/,gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,Ct=/,? & /,Ot=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Eo=/[()=,{}\[\]\/\s]/,xo=/\\(\\)?/g,Io=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Po=/^[-+]0x[0-9a-f]+$/i,So=/^0b[01]+$/i,Ao=/^\[object .+?Constructor\]$/,Ro=/^0o[0-7]+$/i,Co=/^(?:0|[1-9]\d*)$/,Vr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Hi=/($^)/,Oo=/['\n\r\u2028\u2029\\]/g,Bi="\\ud800-\\udfff",To="\\u0300-\\u036f",No="\\ufe20-\\ufe2f",Vi="\\u20d0-\\u20ff",en=To+No+Vi,tn="\\u2700-\\u27bf",Ar="a-z\\xdf-\\xf6\\xf8-\\xff",Fo="\\xac\\xb1\\xd7\\xf7",Do="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Lo="\\u2000-\\u206f",$o=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rn="A-Z\\xc0-\\xd6\\xd8-\\xde",sn="\\ufe0e\\ufe0f",Pi=Fo+Do+Lo+$o,vs="[']",Si="["+Bi+"]",ms="["+Pi+"]",Ai="["+en+"]",nn="\\d+",qo="["+tn+"]",on="["+Ar+"]",an="[^"+Bi+Pi+nn+tn+Ar+rn+"]",Ki="\\ud83c[\\udffb-\\udfff]",Mo="(?:"+Ai+"|"+Ki+")",cn="[^"+Bi+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",ci="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+rn+"]",un="\\u200d",hn="(?:"+on+"|"+an+")",qr="(?:"+hr+"|"+an+")",ln="(?:"+vs+"(?:d|ll|m|re|s|t|ve))?",fn="(?:"+vs+"(?:D|LL|M|RE|S|T|VE))?",pn=Mo+"?",dn="["+sn+"]?",jo="(?:"+un+"(?:"+[cn,Gi,ci].join("|")+")"+dn+pn+")*",Kr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",gn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",yn=dn+pn+jo,Wi="(?:"+[qo,Gi,ci].join("|")+")"+yn,Uo="(?:"+[cn+Ai+"?",Ai,Gi,ci,Si].join("|")+")",ws=RegExp(vs,"g"),zo=RegExp(Ai,"g"),Ji=RegExp(Ki+"(?="+Ki+")|"+Uo+yn,"g"),vn=RegExp([hr+"?"+on+"+"+ln+"(?="+[ms,hr,"$"].join("|")+")",qr+"+"+fn+"(?="+[ms,hr+hn,"$"].join("|")+")",hr+"?"+hn+"+"+ln,hr+"+"+fn,gn,Kr,nn,Wi].join("|"),"g"),mn=RegExp("["+un+Bi+en+sn+"]"),Ri=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,wn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ko=-1,Ve={};Ve[ut]=Ve[Me]=Ve[Pt]=Ve[Dt]=Ve[Ut]=Ve[zt]=Ve[qt]=Ve[Gt]=Ve[tr]=!0,Ve[xe]=Ve[xt]=Ve[Fe]=Ve[C]=Ve[Be]=Ve[A]=Ve[b]=Ve[ee]=Ve[_e]=Ve[Ne]=Ve[Se]=Ve[nt]=Ve[$e]=Ve[Ye]=Ve[ze]=!1;var ke={};ke[xe]=ke[xt]=ke[Fe]=ke[Be]=ke[C]=ke[A]=ke[ut]=ke[Me]=ke[Pt]=ke[Dt]=ke[Ut]=ke[_e]=ke[Ne]=ke[Se]=ke[nt]=ke[$e]=ke[Ye]=ke[Xe]=ke[zt]=ke[qt]=ke[Gt]=ke[tr]=!0,ke[b]=ke[ee]=ke[ze]=!1;var g={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ke=parseFloat,ve=parseInt,et=typeof Vs=="object"&&Vs&&Vs.Object===Object&&Vs,Tt=typeof self=="object"&&self&&self.Object===Object&&self,Re=et||Tt||Function("return this")(),Ge=i&&!i.nodeType&&i,wt=Ge&&!0&&u&&!u.nodeType&&u,rr=wt&&wt.exports===Ge,Nt=rr&&et.process,tt=function(){try{var I=wt&&wt.require&&wt.require("util").types;return I||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Jt=tt&&tt.isArrayBuffer,Rr=tt&&tt.isDate,vr=tt&&tt.isMap,Mr=tt&&tt.isRegExp,_s=tt&&tt.isSet,Ci=tt&&tt.isTypedArray;function Mt(I,N,R){switch(R.length){case 0:return I.call(N);case 1:return I.call(N,R[0]);case 2:return I.call(N,R[0],R[1]);case 3:return I.call(N,R[0],R[1],R[2])}return I.apply(N,R)}function Cf(I,N,R,X){for(var de=-1,Le=I==null?0:I.length;++de<Le;){var Lt=I[de];N(X,Lt,R(Lt),I)}return X}function mr(I,N){for(var R=-1,X=I==null?0:I.length;++R<X&&N(I[R],R,I)!==!1;);return I}function Of(I,N){for(var R=I==null?0:I.length;R--&&N(I[R],R,I)!==!1;);return I}function Cc(I,N){for(var R=-1,X=I==null?0:I.length;++R<X;)if(!N(I[R],R,I))return!1;return!0}function ui(I,N){for(var R=-1,X=I==null?0:I.length,de=0,Le=[];++R<X;){var Lt=I[R];N(Lt,R,I)&&(Le[de++]=Lt)}return Le}function _n(I,N){var R=I==null?0:I.length;return!!R&&Qi(I,N,0)>-1}function Ho(I,N,R){for(var X=-1,de=I==null?0:I.length;++X<de;)if(R(N,I[X]))return!0;return!1}function st(I,N){for(var R=-1,X=I==null?0:I.length,de=Array(X);++R<X;)de[R]=N(I[R],R,I);return de}function hi(I,N){for(var R=-1,X=N.length,de=I.length;++R<X;)I[de+R]=N[R];return I}function Bo(I,N,R,X){var de=-1,Le=I==null?0:I.length;for(X&&Le&&(R=I[++de]);++de<Le;)R=N(R,I[de],de,I);return R}function Tf(I,N,R,X){var de=I==null?0:I.length;for(X&&de&&(R=I[--de]);de--;)R=N(R,I[de],de,I);return R}function Vo(I,N){for(var R=-1,X=I==null?0:I.length;++R<X;)if(N(I[R],R,I))return!0;return!1}var Nf=Ko("length");function Ff(I){return I.split("")}function Df(I){return I.match(Ot)||[]}function Oc(I,N,R){var X;return R(I,function(de,Le,Lt){if(N(de,Le,Lt))return X=Le,!1}),X}function bn(I,N,R,X){for(var de=I.length,Le=R+(X?1:-1);X?Le--:++Le<de;)if(N(I[Le],Le,I))return Le;return-1}function Qi(I,N,R){return N===N?Kf(I,N,R):bn(I,Tc,R)}function Lf(I,N,R,X){for(var de=R-1,Le=I.length;++de<Le;)if(X(I[de],N))return de;return-1}function Tc(I){return I!==I}function Nc(I,N){var R=I==null?0:I.length;return R?Wo(I,N)/R:z}function Ko(I){return function(N){return N==null?r:N[I]}}function Go(I){return function(N){return I==null?r:I[N]}}function Fc(I,N,R,X,de){return de(I,function(Le,Lt,We){R=X?(X=!1,Le):N(R,Le,Lt,We)}),R}function $f(I,N){var R=I.length;for(I.sort(N);R--;)I[R]=I[R].value;return I}function Wo(I,N){for(var R,X=-1,de=I.length;++X<de;){var Le=N(I[X]);Le!==r&&(R=R===r?Le:R+Le)}return R}function Jo(I,N){for(var R=-1,X=Array(I);++R<I;)X[R]=N(R);return X}function qf(I,N){return st(N,function(R){return[R,I[R]]})}function Dc(I){return I&&I.slice(0,Mc(I)+1).replace(dt,"")}function lr(I){return function(N){return I(N)}}function Qo(I,N){return st(N,function(R){return I[R]})}function bs(I,N){return I.has(N)}function Lc(I,N){for(var R=-1,X=I.length;++R<X&&Qi(N,I[R],0)>-1;);return R}function $c(I,N){for(var R=I.length;R--&&Qi(N,I[R],0)>-1;);return R}function Mf(I,N){for(var R=I.length,X=0;R--;)I[R]===N&&++X;return X}var jf=Go(g),Uf=Go(x);function zf(I){return"\\"+Q[I]}function kf(I,N){return I==null?r:I[N]}function Yi(I){return mn.test(I)}function Hf(I){return Ri.test(I)}function Bf(I){for(var N,R=[];!(N=I.next()).done;)R.push(N.value);return R}function Yo(I){var N=-1,R=Array(I.size);return I.forEach(function(X,de){R[++N]=[de,X]}),R}function qc(I,N){return function(R){return I(N(R))}}function li(I,N){for(var R=-1,X=I.length,de=0,Le=[];++R<X;){var Lt=I[R];(Lt===N||Lt===F)&&(I[R]=F,Le[de++]=R)}return Le}function En(I){var N=-1,R=Array(I.size);return I.forEach(function(X){R[++N]=X}),R}function Vf(I){var N=-1,R=Array(I.size);return I.forEach(function(X){R[++N]=[X,X]}),R}function Kf(I,N,R){for(var X=R-1,de=I.length;++X<de;)if(I[X]===N)return X;return-1}function Gf(I,N,R){for(var X=R+1;X--;)if(I[X]===N)return X;return X}function Xi(I){return Yi(I)?Jf(I):Nf(I)}function Cr(I){return Yi(I)?Qf(I):Ff(I)}function Mc(I){for(var N=I.length;N--&&mt.test(I.charAt(N)););return N}var Wf=Go($);function Jf(I){for(var N=Ji.lastIndex=0;Ji.test(I);)++N;return N}function Qf(I){return I.match(Ji)||[]}function Yf(I){return I.match(vn)||[]}var Xf=function I(N){N=N==null?Re:Zi.defaults(Re.Object(),N,Zi.pick(Re,wn));var R=N.Array,X=N.Date,de=N.Error,Le=N.Function,Lt=N.Math,We=N.Object,Xo=N.RegExp,Zf=N.String,wr=N.TypeError,xn=R.prototype,ep=Le.prototype,es=We.prototype,In=N["__core-js_shared__"],Pn=ep.toString,je=es.hasOwnProperty,tp=0,jc=function(){var e=/[^.]+$/.exec(In&&In.keys&&In.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Sn=es.toString,rp=Pn.call(We),ip=Re._,sp=Xo("^"+Pn.call(je).replace(pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),An=rr?N.Buffer:r,fi=N.Symbol,Rn=N.Uint8Array,Uc=An?An.allocUnsafe:r,Cn=qc(We.getPrototypeOf,We),zc=We.create,kc=es.propertyIsEnumerable,On=xn.splice,Hc=fi?fi.isConcatSpreadable:r,Es=fi?fi.iterator:r,Oi=fi?fi.toStringTag:r,Tn=function(){try{var e=Li(We,"defineProperty");return e({},"",{}),e}catch{}}(),np=N.clearTimeout!==Re.clearTimeout&&N.clearTimeout,op=X&&X.now!==Re.Date.now&&X.now,ap=N.setTimeout!==Re.setTimeout&&N.setTimeout,Nn=Lt.ceil,Fn=Lt.floor,Zo=We.getOwnPropertySymbols,cp=An?An.isBuffer:r,Bc=N.isFinite,up=xn.join,hp=qc(We.keys,We),$t=Lt.max,Bt=Lt.min,lp=X.now,fp=N.parseInt,Vc=Lt.random,pp=xn.reverse,ea=Li(N,"DataView"),xs=Li(N,"Map"),ta=Li(N,"Promise"),ts=Li(N,"Set"),Is=Li(N,"WeakMap"),Ps=Li(We,"create"),Dn=Is&&new Is,rs={},dp=$i(ea),gp=$i(xs),yp=$i(ta),vp=$i(ts),mp=$i(Is),Ln=fi?fi.prototype:r,Ss=Ln?Ln.valueOf:r,Kc=Ln?Ln.toString:r;function f(e){if(yt(e)&&!me(e)&&!(e instanceof Ae)){if(e instanceof _r)return e;if(je.call(e,"__wrapped__"))return Gu(e)}return new _r(e)}var is=function(){function e(){}return function(t){if(!ct(t))return{};if(zc)return zc(t);e.prototype=t;var s=new e;return e.prototype=r,s}}();function $n(){}function _r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}f.templateSettings={escape:lt,evaluate:ft,interpolate:at,variable:"",imports:{_:f}},f.prototype=$n.prototype,f.prototype.constructor=f,_r.prototype=is($n.prototype),_r.prototype.constructor=_r;function Ae(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=V,this.__views__=[]}function wp(){var e=new Ae(this.__wrapped__);return e.__actions__=ir(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ir(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ir(this.__views__),e}function _p(){if(this.__filtered__){var e=new Ae(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function bp(){var e=this.__wrapped__.value(),t=this.__dir__,s=me(e),a=t<0,l=s?e.length:0,p=Fd(0,l,this.__views__),m=p.start,w=p.end,P=w-m,D=a?w:m-1,L=this.__iteratees__,U=L.length,J=0,te=Bt(P,this.__takeCount__);if(!s||!a&&l==P&&te==P)return yu(e,this.__actions__);var oe=[];e:for(;P--&&J<te;){D+=t;for(var be=-1,ae=e[D];++be<U;){var Pe=L[be],Ce=Pe.iteratee,dr=Pe.type,Xt=Ce(ae);if(dr==E)ae=Xt;else if(!Xt){if(dr==y)continue e;break e}}oe[J++]=ae}return oe}Ae.prototype=is($n.prototype),Ae.prototype.constructor=Ae;function Ti(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Ep(){this.__data__=Ps?Ps(null):{},this.size=0}function xp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Ip(e){var t=this.__data__;if(Ps){var s=t[e];return s===_?r:s}return je.call(t,e)?t[e]:r}function Pp(e){var t=this.__data__;return Ps?t[e]!==r:je.call(t,e)}function Sp(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Ps&&t===r?_:t,this}Ti.prototype.clear=Ep,Ti.prototype.delete=xp,Ti.prototype.get=Ip,Ti.prototype.has=Pp,Ti.prototype.set=Sp;function Gr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Ap(){this.__data__=[],this.size=0}function Rp(e){var t=this.__data__,s=qn(t,e);if(s<0)return!1;var a=t.length-1;return s==a?t.pop():On.call(t,s,1),--this.size,!0}function Cp(e){var t=this.__data__,s=qn(t,e);return s<0?r:t[s][1]}function Op(e){return qn(this.__data__,e)>-1}function Tp(e,t){var s=this.__data__,a=qn(s,e);return a<0?(++this.size,s.push([e,t])):s[a][1]=t,this}Gr.prototype.clear=Ap,Gr.prototype.delete=Rp,Gr.prototype.get=Cp,Gr.prototype.has=Op,Gr.prototype.set=Tp;function Wr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Np(){this.size=0,this.__data__={hash:new Ti,map:new(xs||Gr),string:new Ti}}function Fp(e){var t=Jn(this,e).delete(e);return this.size-=t?1:0,t}function Dp(e){return Jn(this,e).get(e)}function Lp(e){return Jn(this,e).has(e)}function $p(e,t){var s=Jn(this,e),a=s.size;return s.set(e,t),this.size+=s.size==a?0:1,this}Wr.prototype.clear=Np,Wr.prototype.delete=Fp,Wr.prototype.get=Dp,Wr.prototype.has=Lp,Wr.prototype.set=$p;function Ni(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Wr;++t<s;)this.add(e[t])}function qp(e){return this.__data__.set(e,_),this}function Mp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=qp,Ni.prototype.has=Mp;function Or(e){var t=this.__data__=new Gr(e);this.size=t.size}function jp(){this.__data__=new Gr,this.size=0}function Up(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function zp(e){return this.__data__.get(e)}function kp(e){return this.__data__.has(e)}function Hp(e,t){var s=this.__data__;if(s instanceof Gr){var a=s.__data__;if(!xs||a.length<o-1)return a.push([e,t]),this.size=++s.size,this;s=this.__data__=new Wr(a)}return s.set(e,t),this.size=s.size,this}Or.prototype.clear=jp,Or.prototype.delete=Up,Or.prototype.get=zp,Or.prototype.has=kp,Or.prototype.set=Hp;function Gc(e,t){var s=me(e),a=!s&&qi(e),l=!s&&!a&&vi(e),p=!s&&!a&&!l&&as(e),m=s||a||l||p,w=m?Jo(e.length,Zf):[],P=w.length;for(var D in e)(t||je.call(e,D))&&!(m&&(D=="length"||l&&(D=="offset"||D=="parent")||p&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||Xr(D,P)))&&w.push(D);return w}function Wc(e){var t=e.length;return t?e[fa(0,t-1)]:r}function Bp(e,t){return Qn(ir(e),Fi(t,0,e.length))}function Vp(e){return Qn(ir(e))}function ra(e,t,s){(s!==r&&!Tr(e[t],s)||s===r&&!(t in e))&&Jr(e,t,s)}function As(e,t,s){var a=e[t];(!(je.call(e,t)&&Tr(a,s))||s===r&&!(t in e))&&Jr(e,t,s)}function qn(e,t){for(var s=e.length;s--;)if(Tr(e[s][0],t))return s;return-1}function Kp(e,t,s,a){return pi(e,function(l,p,m){t(a,l,s(l),m)}),a}function Jc(e,t){return e&&Ur(t,jt(t),e)}function Gp(e,t){return e&&Ur(t,nr(t),e)}function Jr(e,t,s){t=="__proto__"&&Tn?Tn(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function ia(e,t){for(var s=-1,a=t.length,l=R(a),p=e==null;++s<a;)l[s]=p?r:qa(e,t[s]);return l}function Fi(e,t,s){return e===e&&(s!==r&&(e=e<=s?e:s),t!==r&&(e=e>=t?e:t)),e}function br(e,t,s,a,l,p){var m,w=t&k,P=t&B,D=t&K;if(s&&(m=l?s(e,a,l,p):s(e)),m!==r)return m;if(!ct(e))return e;var L=me(e);if(L){if(m=Ld(e),!w)return ir(e,m)}else{var U=Vt(e),J=U==ee||U==fe;if(vi(e))return wu(e,w);if(U==Se||U==xe||J&&!l){if(m=P||J?{}:Mu(e),!w)return P?Id(e,Gp(m,e)):xd(e,Jc(m,e))}else{if(!ke[U])return l?e:{};m=$d(e,U,w)}}p||(p=new Or);var te=p.get(e);if(te)return te;p.set(e,m),ph(e)?e.forEach(function(ae){m.add(br(ae,t,s,ae,e,p))}):lh(e)&&e.forEach(function(ae,Pe){m.set(Pe,br(ae,t,s,Pe,e,p))});var oe=D?P?xa:Ea:P?nr:jt,be=L?r:oe(e);return mr(be||e,function(ae,Pe){be&&(Pe=ae,ae=e[Pe]),As(m,Pe,br(ae,t,s,Pe,e,p))}),m}function Wp(e){var t=jt(e);return function(s){return Qc(s,e,t)}}function Qc(e,t,s){var a=s.length;if(e==null)return!a;for(e=We(e);a--;){var l=s[a],p=t[l],m=e[l];if(m===r&&!(l in e)||!p(m))return!1}return!0}function Yc(e,t,s){if(typeof e!="function")throw new wr(d);return Ds(function(){e.apply(r,s)},t)}function Rs(e,t,s,a){var l=-1,p=_n,m=!0,w=e.length,P=[],D=t.length;if(!w)return P;s&&(t=st(t,lr(s))),a?(p=Ho,m=!1):t.length>=o&&(p=bs,m=!1,t=new Ni(t));e:for(;++l<w;){var L=e[l],U=s==null?L:s(L);if(L=a||L!==0?L:0,m&&U===U){for(var J=D;J--;)if(t[J]===U)continue e;P.push(L)}else p(t,U,a)||P.push(L)}return P}var pi=Iu(jr),Xc=Iu(na,!0);function Jp(e,t){var s=!0;return pi(e,function(a,l,p){return s=!!t(a,l,p),s}),s}function Mn(e,t,s){for(var a=-1,l=e.length;++a<l;){var p=e[a],m=t(p);if(m!=null&&(w===r?m===m&&!pr(m):s(m,w)))var w=m,P=p}return P}function Qp(e,t,s,a){var l=e.length;for(s=we(s),s<0&&(s=-s>l?0:l+s),a=a===r||a>l?l:we(a),a<0&&(a+=l),a=s>a?0:gh(a);s<a;)e[s++]=t;return e}function Zc(e,t){var s=[];return pi(e,function(a,l,p){t(a,l,p)&&s.push(a)}),s}function kt(e,t,s,a,l){var p=-1,m=e.length;for(s||(s=Md),l||(l=[]);++p<m;){var w=e[p];t>0&&s(w)?t>1?kt(w,t-1,s,a,l):hi(l,w):a||(l[l.length]=w)}return l}var sa=Pu(),eu=Pu(!0);function jr(e,t){return e&&sa(e,t,jt)}function na(e,t){return e&&eu(e,t,jt)}function jn(e,t){return ui(t,function(s){return Zr(e[s])})}function Di(e,t){t=gi(t,e);for(var s=0,a=t.length;e!=null&&s<a;)e=e[zr(t[s++])];return s&&s==a?e:r}function tu(e,t,s){var a=t(e);return me(e)?a:hi(a,s(e))}function Qt(e){return e==null?e===r?ot:De:Oi&&Oi in We(e)?Nd(e):Vd(e)}function oa(e,t){return e>t}function Yp(e,t){return e!=null&&je.call(e,t)}function Xp(e,t){return e!=null&&t in We(e)}function Zp(e,t,s){return e>=Bt(t,s)&&e<$t(t,s)}function aa(e,t,s){for(var a=s?Ho:_n,l=e[0].length,p=e.length,m=p,w=R(p),P=1/0,D=[];m--;){var L=e[m];m&&t&&(L=st(L,lr(t))),P=Bt(L.length,P),w[m]=!s&&(t||l>=120&&L.length>=120)?new Ni(m&&L):r}L=e[0];var U=-1,J=w[0];e:for(;++U<l&&D.length<P;){var te=L[U],oe=t?t(te):te;if(te=s||te!==0?te:0,!(J?bs(J,oe):a(D,oe,s))){for(m=p;--m;){var be=w[m];if(!(be?bs(be,oe):a(e[m],oe,s)))continue e}J&&J.push(oe),D.push(te)}}return D}function ed(e,t,s,a){return jr(e,function(l,p,m){t(a,s(l),p,m)}),a}function Cs(e,t,s){t=gi(t,e),e=ku(e,t);var a=e==null?e:e[zr(xr(t))];return a==null?r:Mt(a,e,s)}function ru(e){return yt(e)&&Qt(e)==xe}function td(e){return yt(e)&&Qt(e)==Fe}function rd(e){return yt(e)&&Qt(e)==A}function Os(e,t,s,a,l){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:id(e,t,s,a,Os,l)}function id(e,t,s,a,l,p){var m=me(e),w=me(t),P=m?xt:Vt(e),D=w?xt:Vt(t);P=P==xe?Se:P,D=D==xe?Se:D;var L=P==Se,U=D==Se,J=P==D;if(J&&vi(e)){if(!vi(t))return!1;m=!0,L=!1}if(J&&!L)return p||(p=new Or),m||as(e)?Lu(e,t,s,a,l,p):Od(e,t,P,s,a,l,p);if(!(s&q)){var te=L&&je.call(e,"__wrapped__"),oe=U&&je.call(t,"__wrapped__");if(te||oe){var be=te?e.value():e,ae=oe?t.value():t;return p||(p=new Or),l(be,ae,s,a,p)}}return J?(p||(p=new Or),Td(e,t,s,a,l,p)):!1}function sd(e){return yt(e)&&Vt(e)==_e}function ca(e,t,s,a){var l=s.length,p=l,m=!a;if(e==null)return!p;for(e=We(e);l--;){var w=s[l];if(m&&w[2]?w[1]!==e[w[0]]:!(w[0]in e))return!1}for(;++l<p;){w=s[l];var P=w[0],D=e[P],L=w[1];if(m&&w[2]){if(D===r&&!(P in e))return!1}else{var U=new Or;if(a)var J=a(D,L,P,e,t,U);if(!(J===r?Os(L,D,q|W,a,U):J))return!1}}return!0}function iu(e){if(!ct(e)||Ud(e))return!1;var t=Zr(e)?sp:Ao;return t.test($i(e))}function nd(e){return yt(e)&&Qt(e)==nt}function od(e){return yt(e)&&Vt(e)==$e}function ad(e){return yt(e)&&ro(e.length)&&!!Ve[Qt(e)]}function su(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?me(e)?au(e[0],e[1]):ou(e):Sh(e)}function ua(e){if(!Fs(e))return hp(e);var t=[];for(var s in We(e))je.call(e,s)&&s!="constructor"&&t.push(s);return t}function cd(e){if(!ct(e))return Bd(e);var t=Fs(e),s=[];for(var a in e)a=="constructor"&&(t||!je.call(e,a))||s.push(a);return s}function ha(e,t){return e<t}function nu(e,t){var s=-1,a=sr(e)?R(e.length):[];return pi(e,function(l,p,m){a[++s]=t(l,p,m)}),a}function ou(e){var t=Pa(e);return t.length==1&&t[0][2]?Uu(t[0][0],t[0][1]):function(s){return s===e||ca(s,e,t)}}function au(e,t){return Aa(e)&&ju(t)?Uu(zr(e),t):function(s){var a=qa(s,e);return a===r&&a===t?Ma(s,e):Os(t,a,q|W)}}function Un(e,t,s,a,l){e!==t&&sa(t,function(p,m){if(l||(l=new Or),ct(p))ud(e,t,m,s,Un,a,l);else{var w=a?a(Ca(e,m),p,m+"",e,t,l):r;w===r&&(w=p),ra(e,m,w)}},nr)}function ud(e,t,s,a,l,p,m){var w=Ca(e,s),P=Ca(t,s),D=m.get(P);if(D){ra(e,s,D);return}var L=p?p(w,P,s+"",e,t,m):r,U=L===r;if(U){var J=me(P),te=!J&&vi(P),oe=!J&&!te&&as(P);L=P,J||te||oe?me(w)?L=w:_t(w)?L=ir(w):te?(U=!1,L=wu(P,!0)):oe?(U=!1,L=_u(P,!0)):L=[]:Ls(P)||qi(P)?(L=w,qi(w)?L=yh(w):(!ct(w)||Zr(w))&&(L=Mu(P))):U=!1}U&&(m.set(P,L),l(L,P,a,p,m),m.delete(P)),ra(e,s,L)}function cu(e,t){var s=e.length;if(s)return t+=t<0?s:0,Xr(t,s)?e[t]:r}function uu(e,t,s){t.length?t=st(t,function(p){return me(p)?function(m){return Di(m,p.length===1?p[0]:p)}:p}):t=[or];var a=-1;t=st(t,lr(ne()));var l=nu(e,function(p,m,w){var P=st(t,function(D){return D(p)});return{criteria:P,index:++a,value:p}});return $f(l,function(p,m){return Ed(p,m,s)})}function hd(e,t){return hu(e,t,function(s,a){return Ma(e,a)})}function hu(e,t,s){for(var a=-1,l=t.length,p={};++a<l;){var m=t[a],w=Di(e,m);s(w,m)&&Ts(p,gi(m,e),w)}return p}function ld(e){return function(t){return Di(t,e)}}function la(e,t,s,a){var l=a?Lf:Qi,p=-1,m=t.length,w=e;for(e===t&&(t=ir(t)),s&&(w=st(e,lr(s)));++p<m;)for(var P=0,D=t[p],L=s?s(D):D;(P=l(w,L,P,a))>-1;)w!==e&&On.call(w,P,1),On.call(e,P,1);return e}function lu(e,t){for(var s=e?t.length:0,a=s-1;s--;){var l=t[s];if(s==a||l!==p){var p=l;Xr(l)?On.call(e,l,1):ga(e,l)}}return e}function fa(e,t){return e+Fn(Vc()*(t-e+1))}function fd(e,t,s,a){for(var l=-1,p=$t(Nn((t-e)/(s||1)),0),m=R(p);p--;)m[a?p:++l]=e,e+=s;return m}function pa(e,t){var s="";if(!e||t<1||t>H)return s;do t%2&&(s+=e),t=Fn(t/2),t&&(e+=e);while(t);return s}function Ie(e,t){return Oa(zu(e,t,or),e+"")}function pd(e){return Wc(cs(e))}function dd(e,t){var s=cs(e);return Qn(s,Fi(t,0,s.length))}function Ts(e,t,s,a){if(!ct(e))return e;t=gi(t,e);for(var l=-1,p=t.length,m=p-1,w=e;w!=null&&++l<p;){var P=zr(t[l]),D=s;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(l!=m){var L=w[P];D=a?a(L,P,w):r,D===r&&(D=ct(L)?L:Xr(t[l+1])?[]:{})}As(w,P,D),w=w[P]}return e}var fu=Dn?function(e,t){return Dn.set(e,t),e}:or,gd=Tn?function(e,t){return Tn(e,"toString",{configurable:!0,enumerable:!1,value:Ua(t),writable:!0})}:or;function yd(e){return Qn(cs(e))}function Er(e,t,s){var a=-1,l=e.length;t<0&&(t=-t>l?0:l+t),s=s>l?l:s,s<0&&(s+=l),l=t>s?0:s-t>>>0,t>>>=0;for(var p=R(l);++a<l;)p[a]=e[a+t];return p}function vd(e,t){var s;return pi(e,function(a,l,p){return s=t(a,l,p),!s}),!!s}function zn(e,t,s){var a=0,l=e==null?a:e.length;if(typeof t=="number"&&t===t&&l<=He){for(;a<l;){var p=a+l>>>1,m=e[p];m!==null&&!pr(m)&&(s?m<=t:m<t)?a=p+1:l=p}return l}return da(e,t,or,s)}function da(e,t,s,a){var l=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var m=t!==t,w=t===null,P=pr(t),D=t===r;l<p;){var L=Fn((l+p)/2),U=s(e[L]),J=U!==r,te=U===null,oe=U===U,be=pr(U);if(m)var ae=a||oe;else D?ae=oe&&(a||J):w?ae=oe&&J&&(a||!te):P?ae=oe&&J&&!te&&(a||!be):te||be?ae=!1:ae=a?U<=t:U<t;ae?l=L+1:p=L}return Bt(p,Je)}function pu(e,t){for(var s=-1,a=e.length,l=0,p=[];++s<a;){var m=e[s],w=t?t(m):m;if(!s||!Tr(w,P)){var P=w;p[l++]=m===0?0:m}}return p}function du(e){return typeof e=="number"?e:pr(e)?z:+e}function fr(e){if(typeof e=="string")return e;if(me(e))return st(e,fr)+"";if(pr(e))return Kc?Kc.call(e):"";var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function di(e,t,s){var a=-1,l=_n,p=e.length,m=!0,w=[],P=w;if(s)m=!1,l=Ho;else if(p>=o){var D=t?null:Rd(e);if(D)return En(D);m=!1,l=bs,P=new Ni}else P=t?[]:w;e:for(;++a<p;){var L=e[a],U=t?t(L):L;if(L=s||L!==0?L:0,m&&U===U){for(var J=P.length;J--;)if(P[J]===U)continue e;t&&P.push(U),w.push(L)}else l(P,U,s)||(P!==w&&P.push(U),w.push(L))}return w}function ga(e,t){return t=gi(t,e),e=ku(e,t),e==null||delete e[zr(xr(t))]}function gu(e,t,s,a){return Ts(e,t,s(Di(e,t)),a)}function kn(e,t,s,a){for(var l=e.length,p=a?l:-1;(a?p--:++p<l)&&t(e[p],p,e););return s?Er(e,a?0:p,a?p+1:l):Er(e,a?p+1:0,a?l:p)}function yu(e,t){var s=e;return s instanceof Ae&&(s=s.value()),Bo(t,function(a,l){return l.func.apply(l.thisArg,hi([a],l.args))},s)}function ya(e,t,s){var a=e.length;if(a<2)return a?di(e[0]):[];for(var l=-1,p=R(a);++l<a;)for(var m=e[l],w=-1;++w<a;)w!=l&&(p[l]=Rs(p[l]||m,e[w],t,s));return di(kt(p,1),t,s)}function vu(e,t,s){for(var a=-1,l=e.length,p=t.length,m={};++a<l;){var w=a<p?t[a]:r;s(m,e[a],w)}return m}function va(e){return _t(e)?e:[]}function ma(e){return typeof e=="function"?e:or}function gi(e,t){return me(e)?e:Aa(e,t)?[e]:Ku(qe(e))}var md=Ie;function yi(e,t,s){var a=e.length;return s=s===r?a:s,!t&&s>=a?e:Er(e,t,s)}var mu=np||function(e){return Re.clearTimeout(e)};function wu(e,t){if(t)return e.slice();var s=e.length,a=Uc?Uc(s):new e.constructor(s);return e.copy(a),a}function wa(e){var t=new e.constructor(e.byteLength);return new Rn(t).set(new Rn(e)),t}function wd(e,t){var s=t?wa(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function _d(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function bd(e){return Ss?We(Ss.call(e)):{}}function _u(e,t){var s=t?wa(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function bu(e,t){if(e!==t){var s=e!==r,a=e===null,l=e===e,p=pr(e),m=t!==r,w=t===null,P=t===t,D=pr(t);if(!w&&!D&&!p&&e>t||p&&m&&P&&!w&&!D||a&&m&&P||!s&&P||!l)return 1;if(!a&&!p&&!D&&e<t||D&&s&&l&&!a&&!p||w&&s&&l||!m&&l||!P)return-1}return 0}function Ed(e,t,s){for(var a=-1,l=e.criteria,p=t.criteria,m=l.length,w=s.length;++a<m;){var P=bu(l[a],p[a]);if(P){if(a>=w)return P;var D=s[a];return P*(D=="desc"?-1:1)}}return e.index-t.index}function Eu(e,t,s,a){for(var l=-1,p=e.length,m=s.length,w=-1,P=t.length,D=$t(p-m,0),L=R(P+D),U=!a;++w<P;)L[w]=t[w];for(;++l<m;)(U||l<p)&&(L[s[l]]=e[l]);for(;D--;)L[w++]=e[l++];return L}function xu(e,t,s,a){for(var l=-1,p=e.length,m=-1,w=s.length,P=-1,D=t.length,L=$t(p-w,0),U=R(L+D),J=!a;++l<L;)U[l]=e[l];for(var te=l;++P<D;)U[te+P]=t[P];for(;++m<w;)(J||l<p)&&(U[te+s[m]]=e[l++]);return U}function ir(e,t){var s=-1,a=e.length;for(t||(t=R(a));++s<a;)t[s]=e[s];return t}function Ur(e,t,s,a){var l=!s;s||(s={});for(var p=-1,m=t.length;++p<m;){var w=t[p],P=a?a(s[w],e[w],w,s,e):r;P===r&&(P=e[w]),l?Jr(s,w,P):As(s,w,P)}return s}function xd(e,t){return Ur(e,Sa(e),t)}function Id(e,t){return Ur(e,$u(e),t)}function Hn(e,t){return function(s,a){var l=me(s)?Cf:Kp,p=t?t():{};return l(s,e,ne(a,2),p)}}function ss(e){return Ie(function(t,s){var a=-1,l=s.length,p=l>1?s[l-1]:r,m=l>2?s[2]:r;for(p=e.length>3&&typeof p=="function"?(l--,p):r,m&&Yt(s[0],s[1],m)&&(p=l<3?r:p,l=1),t=We(t);++a<l;){var w=s[a];w&&e(t,w,a,p)}return t})}function Iu(e,t){return function(s,a){if(s==null)return s;if(!sr(s))return e(s,a);for(var l=s.length,p=t?l:-1,m=We(s);(t?p--:++p<l)&&a(m[p],p,m)!==!1;);return s}}function Pu(e){return function(t,s,a){for(var l=-1,p=We(t),m=a(t),w=m.length;w--;){var P=m[e?w:++l];if(s(p[P],P,p)===!1)break}return t}}function Pd(e,t,s){var a=t&ie,l=Ns(e);function p(){var m=this&&this!==Re&&this instanceof p?l:e;return m.apply(a?s:this,arguments)}return p}function Su(e){return function(t){t=qe(t);var s=Yi(t)?Cr(t):r,a=s?s[0]:t.charAt(0),l=s?yi(s,1).join(""):t.slice(1);return a[e]()+l}}function ns(e){return function(t){return Bo(Ih(xh(t).replace(ws,"")),e,"")}}function Ns(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=is(e.prototype),a=e.apply(s,t);return ct(a)?a:s}}function Sd(e,t,s){var a=Ns(e);function l(){for(var p=arguments.length,m=R(p),w=p,P=os(l);w--;)m[w]=arguments[w];var D=p<3&&m[0]!==P&&m[p-1]!==P?[]:li(m,P);if(p-=D.length,p<s)return Tu(e,t,Bn,l.placeholder,r,m,D,r,r,s-p);var L=this&&this!==Re&&this instanceof l?a:e;return Mt(L,this,m)}return l}function Au(e){return function(t,s,a){var l=We(t);if(!sr(t)){var p=ne(s,3);t=jt(t),s=function(w){return p(l[w],w,l)}}var m=e(t,s,a);return m>-1?l[p?t[m]:m]:r}}function Ru(e){return Yr(function(t){var s=t.length,a=s,l=_r.prototype.thru;for(e&&t.reverse();a--;){var p=t[a];if(typeof p!="function")throw new wr(d);if(l&&!m&&Wn(p)=="wrapper")var m=new _r([],!0)}for(a=m?a:s;++a<s;){p=t[a];var w=Wn(p),P=w=="wrapper"?Ia(p):r;P&&Ra(P[0])&&P[1]==(M|pe|le|G)&&!P[4].length&&P[9]==1?m=m[Wn(P[0])].apply(m,P[3]):m=p.length==1&&Ra(p)?m[w]():m.thru(p)}return function(){var D=arguments,L=D[0];if(m&&D.length==1&&me(L))return m.plant(L).value();for(var U=0,J=s?t[U].apply(this,D):L;++U<s;)J=t[U].call(this,J);return J}})}function Bn(e,t,s,a,l,p,m,w,P,D){var L=t&M,U=t&ie,J=t&Ee,te=t&(pe|he),oe=t&ye,be=J?r:Ns(e);function ae(){for(var Pe=arguments.length,Ce=R(Pe),dr=Pe;dr--;)Ce[dr]=arguments[dr];if(te)var Xt=os(ae),gr=Mf(Ce,Xt);if(a&&(Ce=Eu(Ce,a,l,te)),p&&(Ce=xu(Ce,p,m,te)),Pe-=gr,te&&Pe<D){var bt=li(Ce,Xt);return Tu(e,t,Bn,ae.placeholder,s,Ce,bt,w,P,D-Pe)}var Nr=U?s:this,ti=J?Nr[e]:e;return Pe=Ce.length,w?Ce=Kd(Ce,w):oe&&Pe>1&&Ce.reverse(),L&&P<Pe&&(Ce.length=P),this&&this!==Re&&this instanceof ae&&(ti=be||Ns(ti)),ti.apply(Nr,Ce)}return ae}function Cu(e,t){return function(s,a){return ed(s,e,t(a),{})}}function Vn(e,t){return function(s,a){var l;if(s===r&&a===r)return t;if(s!==r&&(l=s),a!==r){if(l===r)return a;typeof s=="string"||typeof a=="string"?(s=fr(s),a=fr(a)):(s=du(s),a=du(a)),l=e(s,a)}return l}}function _a(e){return Yr(function(t){return t=st(t,lr(ne())),Ie(function(s){var a=this;return e(t,function(l){return Mt(l,a,s)})})})}function Kn(e,t){t=t===r?" ":fr(t);var s=t.length;if(s<2)return s?pa(t,e):t;var a=pa(t,Nn(e/Xi(t)));return Yi(t)?yi(Cr(a),0,e).join(""):a.slice(0,e)}function Ad(e,t,s,a){var l=t&ie,p=Ns(e);function m(){for(var w=-1,P=arguments.length,D=-1,L=a.length,U=R(L+P),J=this&&this!==Re&&this instanceof m?p:e;++D<L;)U[D]=a[D];for(;P--;)U[D++]=arguments[++w];return Mt(J,l?s:this,U)}return m}function Ou(e){return function(t,s,a){return a&&typeof a!="number"&&Yt(t,s,a)&&(s=a=r),t=ei(t),s===r?(s=t,t=0):s=ei(s),a=a===r?t<s?1:-1:ei(a),fd(t,s,a,e)}}function Gn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=Ir(t),s=Ir(s)),e(t,s)}}function Tu(e,t,s,a,l,p,m,w,P,D){var L=t&pe,U=L?m:r,J=L?r:m,te=L?p:r,oe=L?r:p;t|=L?le:T,t&=~(L?T:le),t&ge||(t&=~(ie|Ee));var be=[e,t,l,te,U,oe,J,w,P,D],ae=s.apply(r,be);return Ra(e)&&Hu(ae,be),ae.placeholder=a,Bu(ae,e,t)}function ba(e){var t=Lt[e];return function(s,a){if(s=Ir(s),a=a==null?0:Bt(we(a),292),a&&Bc(s)){var l=(qe(s)+"e").split("e"),p=t(l[0]+"e"+(+l[1]+a));return l=(qe(p)+"e").split("e"),+(l[0]+"e"+(+l[1]-a))}return t(s)}}var Rd=ts&&1/En(new ts([,-0]))[1]==ce?function(e){return new ts(e)}:Ha;function Nu(e){return function(t){var s=Vt(t);return s==_e?Yo(t):s==$e?Vf(t):qf(t,e(t))}}function Qr(e,t,s,a,l,p,m,w){var P=t&Ee;if(!P&&typeof e!="function")throw new wr(d);var D=a?a.length:0;if(D||(t&=~(le|T),a=l=r),m=m===r?m:$t(we(m),0),w=w===r?w:we(w),D-=l?l.length:0,t&T){var L=a,U=l;a=l=r}var J=P?r:Ia(e),te=[e,t,s,a,l,L,U,p,m,w];if(J&&Hd(te,J),e=te[0],t=te[1],s=te[2],a=te[3],l=te[4],w=te[9]=te[9]===r?P?0:e.length:$t(te[9]-D,0),!w&&t&(pe|he)&&(t&=~(pe|he)),!t||t==ie)var oe=Pd(e,t,s);else t==pe||t==he?oe=Sd(e,t,w):(t==le||t==(ie|le))&&!l.length?oe=Ad(e,t,s,a):oe=Bn.apply(r,te);var be=J?fu:Hu;return Bu(be(oe,te),e,t)}function Fu(e,t,s,a){return e===r||Tr(e,es[s])&&!je.call(a,s)?t:e}function Du(e,t,s,a,l,p){return ct(e)&&ct(t)&&(p.set(t,e),Un(e,t,r,Du,p),p.delete(t)),e}function Cd(e){return Ls(e)?r:e}function Lu(e,t,s,a,l,p){var m=s&q,w=e.length,P=t.length;if(w!=P&&!(m&&P>w))return!1;var D=p.get(e),L=p.get(t);if(D&&L)return D==t&&L==e;var U=-1,J=!0,te=s&W?new Ni:r;for(p.set(e,t),p.set(t,e);++U<w;){var oe=e[U],be=t[U];if(a)var ae=m?a(be,oe,U,t,e,p):a(oe,be,U,e,t,p);if(ae!==r){if(ae)continue;J=!1;break}if(te){if(!Vo(t,function(Pe,Ce){if(!bs(te,Ce)&&(oe===Pe||l(oe,Pe,s,a,p)))return te.push(Ce)})){J=!1;break}}else if(!(oe===be||l(oe,be,s,a,p))){J=!1;break}}return p.delete(e),p.delete(t),J}function Od(e,t,s,a,l,p,m){switch(s){case Be:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Fe:return!(e.byteLength!=t.byteLength||!p(new Rn(e),new Rn(t)));case C:case A:case Ne:return Tr(+e,+t);case b:return e.name==t.name&&e.message==t.message;case nt:case Ye:return e==t+"";case _e:var w=Yo;case $e:var P=a&q;if(w||(w=En),e.size!=t.size&&!P)return!1;var D=m.get(e);if(D)return D==t;a|=W,m.set(e,t);var L=Lu(w(e),w(t),a,l,p,m);return m.delete(e),L;case Xe:if(Ss)return Ss.call(e)==Ss.call(t)}return!1}function Td(e,t,s,a,l,p){var m=s&q,w=Ea(e),P=w.length,D=Ea(t),L=D.length;if(P!=L&&!m)return!1;for(var U=P;U--;){var J=w[U];if(!(m?J in t:je.call(t,J)))return!1}var te=p.get(e),oe=p.get(t);if(te&&oe)return te==t&&oe==e;var be=!0;p.set(e,t),p.set(t,e);for(var ae=m;++U<P;){J=w[U];var Pe=e[J],Ce=t[J];if(a)var dr=m?a(Ce,Pe,J,t,e,p):a(Pe,Ce,J,e,t,p);if(!(dr===r?Pe===Ce||l(Pe,Ce,s,a,p):dr)){be=!1;break}ae||(ae=J=="constructor")}if(be&&!ae){var Xt=e.constructor,gr=t.constructor;Xt!=gr&&"constructor"in e&&"constructor"in t&&!(typeof Xt=="function"&&Xt instanceof Xt&&typeof gr=="function"&&gr instanceof gr)&&(be=!1)}return p.delete(e),p.delete(t),be}function Yr(e){return Oa(zu(e,r,Qu),e+"")}function Ea(e){return tu(e,jt,Sa)}function xa(e){return tu(e,nr,$u)}var Ia=Dn?function(e){return Dn.get(e)}:Ha;function Wn(e){for(var t=e.name+"",s=rs[t],a=je.call(rs,t)?s.length:0;a--;){var l=s[a],p=l.func;if(p==null||p==e)return l.name}return t}function os(e){var t=je.call(f,"placeholder")?f:e;return t.placeholder}function ne(){var e=f.iteratee||za;return e=e===za?su:e,arguments.length?e(arguments[0],arguments[1]):e}function Jn(e,t){var s=e.__data__;return jd(t)?s[typeof t=="string"?"string":"hash"]:s.map}function Pa(e){for(var t=jt(e),s=t.length;s--;){var a=t[s],l=e[a];t[s]=[a,l,ju(l)]}return t}function Li(e,t){var s=kf(e,t);return iu(s)?s:r}function Nd(e){var t=je.call(e,Oi),s=e[Oi];try{e[Oi]=r;var a=!0}catch{}var l=Sn.call(e);return a&&(t?e[Oi]=s:delete e[Oi]),l}var Sa=Zo?function(e){return e==null?[]:(e=We(e),ui(Zo(e),function(t){return kc.call(e,t)}))}:Ba,$u=Zo?function(e){for(var t=[];e;)hi(t,Sa(e)),e=Cn(e);return t}:Ba,Vt=Qt;(ea&&Vt(new ea(new ArrayBuffer(1)))!=Be||xs&&Vt(new xs)!=_e||ta&&Vt(ta.resolve())!=It||ts&&Vt(new ts)!=$e||Is&&Vt(new Is)!=ze)&&(Vt=function(e){var t=Qt(e),s=t==Se?e.constructor:r,a=s?$i(s):"";if(a)switch(a){case dp:return Be;case gp:return _e;case yp:return It;case vp:return $e;case mp:return ze}return t});function Fd(e,t,s){for(var a=-1,l=s.length;++a<l;){var p=s[a],m=p.size;switch(p.type){case"drop":e+=m;break;case"dropRight":t-=m;break;case"take":t=Bt(t,e+m);break;case"takeRight":e=$t(e,t-m);break}}return{start:e,end:t}}function Dd(e){var t=e.match(Qe);return t?t[1].split(Ct):[]}function qu(e,t,s){t=gi(t,e);for(var a=-1,l=t.length,p=!1;++a<l;){var m=zr(t[a]);if(!(p=e!=null&&s(e,m)))break;e=e[m]}return p||++a!=l?p:(l=e==null?0:e.length,!!l&&ro(l)&&Xr(m,l)&&(me(e)||qi(e)))}function Ld(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&je.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Mu(e){return typeof e.constructor=="function"&&!Fs(e)?is(Cn(e)):{}}function $d(e,t,s){var a=e.constructor;switch(t){case Fe:return wa(e);case C:case A:return new a(+e);case Be:return wd(e,s);case ut:case Me:case Pt:case Dt:case Ut:case zt:case qt:case Gt:case tr:return _u(e,s);case _e:return new a;case Ne:case Ye:return new a(e);case nt:return _d(e);case $e:return new a;case Xe:return bd(e)}}function qd(e,t){var s=t.length;if(!s)return e;var a=s-1;return t[a]=(s>1?"& ":"")+t[a],t=t.join(s>2?", ":" "),e.replace(gt,`{
/* [wrapped with `+t+`] */
`)}function Md(e){return me(e)||qi(e)||!!(Hc&&e&&e[Hc])}function Xr(e,t){var s=typeof e;return t=t??H,!!t&&(s=="number"||s!="symbol"&&Co.test(e))&&e>-1&&e%1==0&&e<t}function Yt(e,t,s){if(!ct(s))return!1;var a=typeof t;return(a=="number"?sr(s)&&Xr(t,s.length):a=="string"&&t in s)?Tr(s[t],e):!1}function Aa(e,t){if(me(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||pr(e)?!0:St.test(e)||!it.test(e)||t!=null&&e in We(t)}function jd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Ra(e){var t=Wn(e),s=f[t];if(typeof s!="function"||!(t in Ae.prototype))return!1;if(e===s)return!0;var a=Ia(s);return!!a&&e===a[0]}function Ud(e){return!!jc&&jc in e}var zd=In?Zr:Va;function Fs(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||es;return e===s}function ju(e){return e===e&&!ct(e)}function Uu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==r||e in We(s))}}function kd(e){var t=eo(e,function(a){return s.size===S&&s.clear(),a}),s=t.cache;return t}function Hd(e,t){var s=e[1],a=t[1],l=s|a,p=l<(ie|Ee|M),m=a==M&&s==pe||a==M&&s==G&&e[7].length<=t[8]||a==(M|G)&&t[7].length<=t[8]&&s==pe;if(!(p||m))return e;a&ie&&(e[2]=t[2],l|=s&ie?0:ge);var w=t[3];if(w){var P=e[3];e[3]=P?Eu(P,w,t[4]):w,e[4]=P?li(e[3],F):t[4]}return w=t[5],w&&(P=e[5],e[5]=P?xu(P,w,t[6]):w,e[6]=P?li(e[5],F):t[6]),w=t[7],w&&(e[7]=w),a&M&&(e[8]=e[8]==null?t[8]:Bt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=l,e}function Bd(e){var t=[];if(e!=null)for(var s in We(e))t.push(s);return t}function Vd(e){return Sn.call(e)}function zu(e,t,s){return t=$t(t===r?e.length-1:t,0),function(){for(var a=arguments,l=-1,p=$t(a.length-t,0),m=R(p);++l<p;)m[l]=a[t+l];l=-1;for(var w=R(t+1);++l<t;)w[l]=a[l];return w[t]=s(m),Mt(e,this,w)}}function ku(e,t){return t.length<2?e:Di(e,Er(t,0,-1))}function Kd(e,t){for(var s=e.length,a=Bt(t.length,s),l=ir(e);a--;){var p=t[a];e[a]=Xr(p,s)?l[p]:r}return e}function Ca(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Hu=Vu(fu),Ds=ap||function(e,t){return Re.setTimeout(e,t)},Oa=Vu(gd);function Bu(e,t,s){var a=t+"";return Oa(e,qd(a,Gd(Dd(a),s)))}function Vu(e){var t=0,s=0;return function(){var a=lp(),l=Ue-(a-s);if(s=a,l>0){if(++t>=Te)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Qn(e,t){var s=-1,a=e.length,l=a-1;for(t=t===r?a:t;++s<t;){var p=fa(s,l),m=e[p];e[p]=e[s],e[s]=m}return e.length=t,e}var Ku=kd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(At,function(s,a,l,p){t.push(l?p.replace(xo,"$1"):a||s)}),t});function zr(e){if(typeof e=="string"||pr(e))return e;var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function $i(e){if(e!=null){try{return Pn.call(e)}catch{}try{return e+""}catch{}}return""}function Gd(e,t){return mr(Lr,function(s){var a="_."+s[0];t&s[1]&&!_n(e,a)&&e.push(a)}),e.sort()}function Gu(e){if(e instanceof Ae)return e.clone();var t=new _r(e.__wrapped__,e.__chain__);return t.__actions__=ir(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Wd(e,t,s){(s?Yt(e,t,s):t===r)?t=1:t=$t(we(t),0);var a=e==null?0:e.length;if(!a||t<1)return[];for(var l=0,p=0,m=R(Nn(a/t));l<a;)m[p++]=Er(e,l,l+=t);return m}function Jd(e){for(var t=-1,s=e==null?0:e.length,a=0,l=[];++t<s;){var p=e[t];p&&(l[a++]=p)}return l}function Qd(){var e=arguments.length;if(!e)return[];for(var t=R(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return hi(me(s)?ir(s):[s],kt(t,1))}var Yd=Ie(function(e,t){return _t(e)?Rs(e,kt(t,1,_t,!0)):[]}),Xd=Ie(function(e,t){var s=xr(t);return _t(s)&&(s=r),_t(e)?Rs(e,kt(t,1,_t,!0),ne(s,2)):[]}),Zd=Ie(function(e,t){var s=xr(t);return _t(s)&&(s=r),_t(e)?Rs(e,kt(t,1,_t,!0),r,s):[]});function eg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:we(t),Er(e,t<0?0:t,a)):[]}function tg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:we(t),t=a-t,Er(e,0,t<0?0:t)):[]}function rg(e,t){return e&&e.length?kn(e,ne(t,3),!0,!0):[]}function ig(e,t){return e&&e.length?kn(e,ne(t,3),!0):[]}function sg(e,t,s,a){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Yt(e,t,s)&&(s=0,a=l),Qp(e,t,s,a)):[]}function Wu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=s==null?0:we(s);return l<0&&(l=$t(a+l,0)),bn(e,ne(t,3),l)}function Ju(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=a-1;return s!==r&&(l=we(s),l=s<0?$t(a+l,0):Bt(l,a-1)),bn(e,ne(t,3),l,!0)}function Qu(e){var t=e==null?0:e.length;return t?kt(e,1):[]}function ng(e){var t=e==null?0:e.length;return t?kt(e,ce):[]}function og(e,t){var s=e==null?0:e.length;return s?(t=t===r?1:we(t),kt(e,t)):[]}function ag(e){for(var t=-1,s=e==null?0:e.length,a={};++t<s;){var l=e[t];a[l[0]]=l[1]}return a}function Yu(e){return e&&e.length?e[0]:r}function cg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=s==null?0:we(s);return l<0&&(l=$t(a+l,0)),Qi(e,t,l)}function ug(e){var t=e==null?0:e.length;return t?Er(e,0,-1):[]}var hg=Ie(function(e){var t=st(e,va);return t.length&&t[0]===e[0]?aa(t):[]}),lg=Ie(function(e){var t=xr(e),s=st(e,va);return t===xr(s)?t=r:s.pop(),s.length&&s[0]===e[0]?aa(s,ne(t,2)):[]}),fg=Ie(function(e){var t=xr(e),s=st(e,va);return t=typeof t=="function"?t:r,t&&s.pop(),s.length&&s[0]===e[0]?aa(s,r,t):[]});function pg(e,t){return e==null?"":up.call(e,t)}function xr(e){var t=e==null?0:e.length;return t?e[t-1]:r}function dg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=a;return s!==r&&(l=we(s),l=l<0?$t(a+l,0):Bt(l,a-1)),t===t?Gf(e,t,l):bn(e,Tc,l,!0)}function gg(e,t){return e&&e.length?cu(e,we(t)):r}var yg=Ie(Xu);function Xu(e,t){return e&&e.length&&t&&t.length?la(e,t):e}function vg(e,t,s){return e&&e.length&&t&&t.length?la(e,t,ne(s,2)):e}function mg(e,t,s){return e&&e.length&&t&&t.length?la(e,t,r,s):e}var wg=Yr(function(e,t){var s=e==null?0:e.length,a=ia(e,t);return lu(e,st(t,function(l){return Xr(l,s)?+l:l}).sort(bu)),a});function _g(e,t){var s=[];if(!(e&&e.length))return s;var a=-1,l=[],p=e.length;for(t=ne(t,3);++a<p;){var m=e[a];t(m,a,e)&&(s.push(m),l.push(a))}return lu(e,l),s}function Ta(e){return e==null?e:pp.call(e)}function bg(e,t,s){var a=e==null?0:e.length;return a?(s&&typeof s!="number"&&Yt(e,t,s)?(t=0,s=a):(t=t==null?0:we(t),s=s===r?a:we(s)),Er(e,t,s)):[]}function Eg(e,t){return zn(e,t)}function xg(e,t,s){return da(e,t,ne(s,2))}function Ig(e,t){var s=e==null?0:e.length;if(s){var a=zn(e,t);if(a<s&&Tr(e[a],t))return a}return-1}function Pg(e,t){return zn(e,t,!0)}function Sg(e,t,s){return da(e,t,ne(s,2),!0)}function Ag(e,t){var s=e==null?0:e.length;if(s){var a=zn(e,t,!0)-1;if(Tr(e[a],t))return a}return-1}function Rg(e){return e&&e.length?pu(e):[]}function Cg(e,t){return e&&e.length?pu(e,ne(t,2)):[]}function Og(e){var t=e==null?0:e.length;return t?Er(e,1,t):[]}function Tg(e,t,s){return e&&e.length?(t=s||t===r?1:we(t),Er(e,0,t<0?0:t)):[]}function Ng(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:we(t),t=a-t,Er(e,t<0?0:t,a)):[]}function Fg(e,t){return e&&e.length?kn(e,ne(t,3),!1,!0):[]}function Dg(e,t){return e&&e.length?kn(e,ne(t,3)):[]}var Lg=Ie(function(e){return di(kt(e,1,_t,!0))}),$g=Ie(function(e){var t=xr(e);return _t(t)&&(t=r),di(kt(e,1,_t,!0),ne(t,2))}),qg=Ie(function(e){var t=xr(e);return t=typeof t=="function"?t:r,di(kt(e,1,_t,!0),r,t)});function Mg(e){return e&&e.length?di(e):[]}function jg(e,t){return e&&e.length?di(e,ne(t,2)):[]}function Ug(e,t){return t=typeof t=="function"?t:r,e&&e.length?di(e,r,t):[]}function Na(e){if(!(e&&e.length))return[];var t=0;return e=ui(e,function(s){if(_t(s))return t=$t(s.length,t),!0}),Jo(t,function(s){return st(e,Ko(s))})}function Zu(e,t){if(!(e&&e.length))return[];var s=Na(e);return t==null?s:st(s,function(a){return Mt(t,r,a)})}var zg=Ie(function(e,t){return _t(e)?Rs(e,t):[]}),kg=Ie(function(e){return ya(ui(e,_t))}),Hg=Ie(function(e){var t=xr(e);return _t(t)&&(t=r),ya(ui(e,_t),ne(t,2))}),Bg=Ie(function(e){var t=xr(e);return t=typeof t=="function"?t:r,ya(ui(e,_t),r,t)}),Vg=Ie(Na);function Kg(e,t){return vu(e||[],t||[],As)}function Gg(e,t){return vu(e||[],t||[],Ts)}var Wg=Ie(function(e){var t=e.length,s=t>1?e[t-1]:r;return s=typeof s=="function"?(e.pop(),s):r,Zu(e,s)});function eh(e){var t=f(e);return t.__chain__=!0,t}function Jg(e,t){return t(e),e}function Yn(e,t){return t(e)}var Qg=Yr(function(e){var t=e.length,s=t?e[0]:0,a=this.__wrapped__,l=function(p){return ia(p,e)};return t>1||this.__actions__.length||!(a instanceof Ae)||!Xr(s)?this.thru(l):(a=a.slice(s,+s+(t?1:0)),a.__actions__.push({func:Yn,args:[l],thisArg:r}),new _r(a,this.__chain__).thru(function(p){return t&&!p.length&&p.push(r),p}))});function Yg(){return eh(this)}function Xg(){return new _r(this.value(),this.__chain__)}function Zg(){this.__values__===r&&(this.__values__=dh(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function ey(){return this}function ty(e){for(var t,s=this;s instanceof $n;){var a=Gu(s);a.__index__=0,a.__values__=r,t?l.__wrapped__=a:t=a;var l=a;s=s.__wrapped__}return l.__wrapped__=e,t}function ry(){var e=this.__wrapped__;if(e instanceof Ae){var t=e;return this.__actions__.length&&(t=new Ae(this)),t=t.reverse(),t.__actions__.push({func:Yn,args:[Ta],thisArg:r}),new _r(t,this.__chain__)}return this.thru(Ta)}function iy(){return yu(this.__wrapped__,this.__actions__)}var sy=Hn(function(e,t,s){je.call(e,s)?++e[s]:Jr(e,s,1)});function ny(e,t,s){var a=me(e)?Cc:Jp;return s&&Yt(e,t,s)&&(t=r),a(e,ne(t,3))}function oy(e,t){var s=me(e)?ui:Zc;return s(e,ne(t,3))}var ay=Au(Wu),cy=Au(Ju);function uy(e,t){return kt(Xn(e,t),1)}function hy(e,t){return kt(Xn(e,t),ce)}function ly(e,t,s){return s=s===r?1:we(s),kt(Xn(e,t),s)}function th(e,t){var s=me(e)?mr:pi;return s(e,ne(t,3))}function rh(e,t){var s=me(e)?Of:Xc;return s(e,ne(t,3))}var fy=Hn(function(e,t,s){je.call(e,s)?e[s].push(t):Jr(e,s,[t])});function py(e,t,s,a){e=sr(e)?e:cs(e),s=s&&!a?we(s):0;var l=e.length;return s<0&&(s=$t(l+s,0)),io(e)?s<=l&&e.indexOf(t,s)>-1:!!l&&Qi(e,t,s)>-1}var dy=Ie(function(e,t,s){var a=-1,l=typeof t=="function",p=sr(e)?R(e.length):[];return pi(e,function(m){p[++a]=l?Mt(t,m,s):Cs(m,t,s)}),p}),gy=Hn(function(e,t,s){Jr(e,s,t)});function Xn(e,t){var s=me(e)?st:nu;return s(e,ne(t,3))}function yy(e,t,s,a){return e==null?[]:(me(t)||(t=t==null?[]:[t]),s=a?r:s,me(s)||(s=s==null?[]:[s]),uu(e,t,s))}var vy=Hn(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function my(e,t,s){var a=me(e)?Bo:Fc,l=arguments.length<3;return a(e,ne(t,4),s,l,pi)}function wy(e,t,s){var a=me(e)?Tf:Fc,l=arguments.length<3;return a(e,ne(t,4),s,l,Xc)}function _y(e,t){var s=me(e)?ui:Zc;return s(e,to(ne(t,3)))}function by(e){var t=me(e)?Wc:pd;return t(e)}function Ey(e,t,s){(s?Yt(e,t,s):t===r)?t=1:t=we(t);var a=me(e)?Bp:dd;return a(e,t)}function xy(e){var t=me(e)?Vp:yd;return t(e)}function Iy(e){if(e==null)return 0;if(sr(e))return io(e)?Xi(e):e.length;var t=Vt(e);return t==_e||t==$e?e.size:ua(e).length}function Py(e,t,s){var a=me(e)?Vo:vd;return s&&Yt(e,t,s)&&(t=r),a(e,ne(t,3))}var Sy=Ie(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Yt(e,t[0],t[1])?t=[]:s>2&&Yt(t[0],t[1],t[2])&&(t=[t[0]]),uu(e,kt(t,1),[])}),Zn=op||function(){return Re.Date.now()};function Ay(e,t){if(typeof t!="function")throw new wr(d);return e=we(e),function(){if(--e<1)return t.apply(this,arguments)}}function ih(e,t,s){return t=s?r:t,t=e&&t==null?e.length:t,Qr(e,M,r,r,r,r,t)}function sh(e,t){var s;if(typeof t!="function")throw new wr(d);return e=we(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=r),s}}var Fa=Ie(function(e,t,s){var a=ie;if(s.length){var l=li(s,os(Fa));a|=le}return Qr(e,a,t,s,l)}),nh=Ie(function(e,t,s){var a=ie|Ee;if(s.length){var l=li(s,os(nh));a|=le}return Qr(t,a,e,s,l)});function oh(e,t,s){t=s?r:t;var a=Qr(e,pe,r,r,r,r,r,t);return a.placeholder=oh.placeholder,a}function ah(e,t,s){t=s?r:t;var a=Qr(e,he,r,r,r,r,r,t);return a.placeholder=ah.placeholder,a}function ch(e,t,s){var a,l,p,m,w,P,D=0,L=!1,U=!1,J=!0;if(typeof e!="function")throw new wr(d);t=Ir(t)||0,ct(s)&&(L=!!s.leading,U="maxWait"in s,p=U?$t(Ir(s.maxWait)||0,t):p,J="trailing"in s?!!s.trailing:J);function te(bt){var Nr=a,ti=l;return a=l=r,D=bt,m=e.apply(ti,Nr),m}function oe(bt){return D=bt,w=Ds(Pe,t),L?te(bt):m}function be(bt){var Nr=bt-P,ti=bt-D,Ah=t-Nr;return U?Bt(Ah,p-ti):Ah}function ae(bt){var Nr=bt-P,ti=bt-D;return P===r||Nr>=t||Nr<0||U&&ti>=p}function Pe(){var bt=Zn();if(ae(bt))return Ce(bt);w=Ds(Pe,be(bt))}function Ce(bt){return w=r,J&&a?te(bt):(a=l=r,m)}function dr(){w!==r&&mu(w),D=0,a=P=l=w=r}function Xt(){return w===r?m:Ce(Zn())}function gr(){var bt=Zn(),Nr=ae(bt);if(a=arguments,l=this,P=bt,Nr){if(w===r)return oe(P);if(U)return mu(w),w=Ds(Pe,t),te(P)}return w===r&&(w=Ds(Pe,t)),m}return gr.cancel=dr,gr.flush=Xt,gr}var Ry=Ie(function(e,t){return Yc(e,1,t)}),Cy=Ie(function(e,t,s){return Yc(e,Ir(t)||0,s)});function Oy(e){return Qr(e,ye)}function eo(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new wr(d);var s=function(){var a=arguments,l=t?t.apply(this,a):a[0],p=s.cache;if(p.has(l))return p.get(l);var m=e.apply(this,a);return s.cache=p.set(l,m)||p,m};return s.cache=new(eo.Cache||Wr),s}eo.Cache=Wr;function to(e){if(typeof e!="function")throw new wr(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Ty(e){return sh(2,e)}var Ny=md(function(e,t){t=t.length==1&&me(t[0])?st(t[0],lr(ne())):st(kt(t,1),lr(ne()));var s=t.length;return Ie(function(a){for(var l=-1,p=Bt(a.length,s);++l<p;)a[l]=t[l].call(this,a[l]);return Mt(e,this,a)})}),Da=Ie(function(e,t){var s=li(t,os(Da));return Qr(e,le,r,t,s)}),uh=Ie(function(e,t){var s=li(t,os(uh));return Qr(e,T,r,t,s)}),Fy=Yr(function(e,t){return Qr(e,G,r,r,r,t)});function Dy(e,t){if(typeof e!="function")throw new wr(d);return t=t===r?t:we(t),Ie(e,t)}function Ly(e,t){if(typeof e!="function")throw new wr(d);return t=t==null?0:$t(we(t),0),Ie(function(s){var a=s[t],l=yi(s,0,t);return a&&hi(l,a),Mt(e,this,l)})}function $y(e,t,s){var a=!0,l=!0;if(typeof e!="function")throw new wr(d);return ct(s)&&(a="leading"in s?!!s.leading:a,l="trailing"in s?!!s.trailing:l),ch(e,t,{leading:a,maxWait:t,trailing:l})}function qy(e){return ih(e,1)}function My(e,t){return Da(ma(t),e)}function jy(){if(!arguments.length)return[];var e=arguments[0];return me(e)?e:[e]}function Uy(e){return br(e,K)}function zy(e,t){return t=typeof t=="function"?t:r,br(e,K,t)}function ky(e){return br(e,k|K)}function Hy(e,t){return t=typeof t=="function"?t:r,br(e,k|K,t)}function By(e,t){return t==null||Qc(e,t,jt(t))}function Tr(e,t){return e===t||e!==e&&t!==t}var Vy=Gn(oa),Ky=Gn(function(e,t){return e>=t}),qi=ru(function(){return arguments}())?ru:function(e){return yt(e)&&je.call(e,"callee")&&!kc.call(e,"callee")},me=R.isArray,Gy=Jt?lr(Jt):td;function sr(e){return e!=null&&ro(e.length)&&!Zr(e)}function _t(e){return yt(e)&&sr(e)}function Wy(e){return e===!0||e===!1||yt(e)&&Qt(e)==C}var vi=cp||Va,Jy=Rr?lr(Rr):rd;function Qy(e){return yt(e)&&e.nodeType===1&&!Ls(e)}function Yy(e){if(e==null)return!0;if(sr(e)&&(me(e)||typeof e=="string"||typeof e.splice=="function"||vi(e)||as(e)||qi(e)))return!e.length;var t=Vt(e);if(t==_e||t==$e)return!e.size;if(Fs(e))return!ua(e).length;for(var s in e)if(je.call(e,s))return!1;return!0}function Xy(e,t){return Os(e,t)}function Zy(e,t,s){s=typeof s=="function"?s:r;var a=s?s(e,t):r;return a===r?Os(e,t,r,s):!!a}function La(e){if(!yt(e))return!1;var t=Qt(e);return t==b||t==c||typeof e.message=="string"&&typeof e.name=="string"&&!Ls(e)}function ev(e){return typeof e=="number"&&Bc(e)}function Zr(e){if(!ct(e))return!1;var t=Qt(e);return t==ee||t==fe||t==O||t==vt}function hh(e){return typeof e=="number"&&e==we(e)}function ro(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=H}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var lh=vr?lr(vr):sd;function tv(e,t){return e===t||ca(e,t,Pa(t))}function rv(e,t,s){return s=typeof s=="function"?s:r,ca(e,t,Pa(t),s)}function iv(e){return fh(e)&&e!=+e}function sv(e){if(zd(e))throw new de(h);return iu(e)}function nv(e){return e===null}function ov(e){return e==null}function fh(e){return typeof e=="number"||yt(e)&&Qt(e)==Ne}function Ls(e){if(!yt(e)||Qt(e)!=Se)return!1;var t=Cn(e);if(t===null)return!0;var s=je.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&Pn.call(s)==rp}var $a=Mr?lr(Mr):nd;function av(e){return hh(e)&&e>=-H&&e<=H}var ph=_s?lr(_s):od;function io(e){return typeof e=="string"||!me(e)&&yt(e)&&Qt(e)==Ye}function pr(e){return typeof e=="symbol"||yt(e)&&Qt(e)==Xe}var as=Ci?lr(Ci):ad;function cv(e){return e===r}function uv(e){return yt(e)&&Vt(e)==ze}function hv(e){return yt(e)&&Qt(e)==Ze}var lv=Gn(ha),fv=Gn(function(e,t){return e<=t});function dh(e){if(!e)return[];if(sr(e))return io(e)?Cr(e):ir(e);if(Es&&e[Es])return Bf(e[Es]());var t=Vt(e),s=t==_e?Yo:t==$e?En:cs;return s(e)}function ei(e){if(!e)return e===0?e:0;if(e=Ir(e),e===ce||e===-ce){var t=e<0?-1:1;return t*j}return e===e?e:0}function we(e){var t=ei(e),s=t%1;return t===t?s?t-s:t:0}function gh(e){return e?Fi(we(e),0,V):0}function Ir(e){if(typeof e=="number")return e;if(pr(e))return z;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Dc(e);var s=So.test(e);return s||Ro.test(e)?ve(e.slice(2),s?2:8):Po.test(e)?z:+e}function yh(e){return Ur(e,nr(e))}function pv(e){return e?Fi(we(e),-H,H):e===0?e:0}function qe(e){return e==null?"":fr(e)}var dv=ss(function(e,t){if(Fs(t)||sr(t)){Ur(t,jt(t),e);return}for(var s in t)je.call(t,s)&&As(e,s,t[s])}),vh=ss(function(e,t){Ur(t,nr(t),e)}),so=ss(function(e,t,s,a){Ur(t,nr(t),e,a)}),gv=ss(function(e,t,s,a){Ur(t,jt(t),e,a)}),yv=Yr(ia);function vv(e,t){var s=is(e);return t==null?s:Jc(s,t)}var mv=Ie(function(e,t){e=We(e);var s=-1,a=t.length,l=a>2?t[2]:r;for(l&&Yt(t[0],t[1],l)&&(a=1);++s<a;)for(var p=t[s],m=nr(p),w=-1,P=m.length;++w<P;){var D=m[w],L=e[D];(L===r||Tr(L,es[D])&&!je.call(e,D))&&(e[D]=p[D])}return e}),wv=Ie(function(e){return e.push(r,Du),Mt(mh,r,e)});function _v(e,t){return Oc(e,ne(t,3),jr)}function bv(e,t){return Oc(e,ne(t,3),na)}function Ev(e,t){return e==null?e:sa(e,ne(t,3),nr)}function xv(e,t){return e==null?e:eu(e,ne(t,3),nr)}function Iv(e,t){return e&&jr(e,ne(t,3))}function Pv(e,t){return e&&na(e,ne(t,3))}function Sv(e){return e==null?[]:jn(e,jt(e))}function Av(e){return e==null?[]:jn(e,nr(e))}function qa(e,t,s){var a=e==null?r:Di(e,t);return a===r?s:a}function Rv(e,t){return e!=null&&qu(e,t,Yp)}function Ma(e,t){return e!=null&&qu(e,t,Xp)}var Cv=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=Sn.call(t)),e[t]=s},Ua(or)),Ov=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=Sn.call(t)),je.call(e,t)?e[t].push(s):e[t]=[s]},ne),Tv=Ie(Cs);function jt(e){return sr(e)?Gc(e):ua(e)}function nr(e){return sr(e)?Gc(e,!0):cd(e)}function Nv(e,t){var s={};return t=ne(t,3),jr(e,function(a,l,p){Jr(s,t(a,l,p),a)}),s}function Fv(e,t){var s={};return t=ne(t,3),jr(e,function(a,l,p){Jr(s,l,t(a,l,p))}),s}var Dv=ss(function(e,t,s){Un(e,t,s)}),mh=ss(function(e,t,s,a){Un(e,t,s,a)}),Lv=Yr(function(e,t){var s={};if(e==null)return s;var a=!1;t=st(t,function(p){return p=gi(p,e),a||(a=p.length>1),p}),Ur(e,xa(e),s),a&&(s=br(s,k|B|K,Cd));for(var l=t.length;l--;)ga(s,t[l]);return s});function $v(e,t){return wh(e,to(ne(t)))}var qv=Yr(function(e,t){return e==null?{}:hd(e,t)});function wh(e,t){if(e==null)return{};var s=st(xa(e),function(a){return[a]});return t=ne(t),hu(e,s,function(a,l){return t(a,l[0])})}function Mv(e,t,s){t=gi(t,e);var a=-1,l=t.length;for(l||(l=1,e=r);++a<l;){var p=e==null?r:e[zr(t[a])];p===r&&(a=l,p=s),e=Zr(p)?p.call(e):p}return e}function jv(e,t,s){return e==null?e:Ts(e,t,s)}function Uv(e,t,s,a){return a=typeof a=="function"?a:r,e==null?e:Ts(e,t,s,a)}var _h=Nu(jt),bh=Nu(nr);function zv(e,t,s){var a=me(e),l=a||vi(e)||as(e);if(t=ne(t,4),s==null){var p=e&&e.constructor;l?s=a?new p:[]:ct(e)?s=Zr(p)?is(Cn(e)):{}:s={}}return(l?mr:jr)(e,function(m,w,P){return t(s,m,w,P)}),s}function kv(e,t){return e==null?!0:ga(e,t)}function Hv(e,t,s){return e==null?e:gu(e,t,ma(s))}function Bv(e,t,s,a){return a=typeof a=="function"?a:r,e==null?e:gu(e,t,ma(s),a)}function cs(e){return e==null?[]:Qo(e,jt(e))}function Vv(e){return e==null?[]:Qo(e,nr(e))}function Kv(e,t,s){return s===r&&(s=t,t=r),s!==r&&(s=Ir(s),s=s===s?s:0),t!==r&&(t=Ir(t),t=t===t?t:0),Fi(Ir(e),t,s)}function Gv(e,t,s){return t=ei(t),s===r?(s=t,t=0):s=ei(s),e=Ir(e),Zp(e,t,s)}function Wv(e,t,s){if(s&&typeof s!="boolean"&&Yt(e,t,s)&&(t=s=r),s===r&&(typeof t=="boolean"?(s=t,t=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ei(e),t===r?(t=e,e=0):t=ei(t)),e>t){var a=e;e=t,t=a}if(s||e%1||t%1){var l=Vc();return Bt(e+l*(t-e+Ke("1e-"+((l+"").length-1))),t)}return fa(e,t)}var Jv=ns(function(e,t,s){return t=t.toLowerCase(),e+(s?Eh(t):t)});function Eh(e){return ja(qe(e).toLowerCase())}function xh(e){return e=qe(e),e&&e.replace(Vr,jf).replace(zo,"")}function Qv(e,t,s){e=qe(e),t=fr(t);var a=e.length;s=s===r?a:Fi(we(s),0,a);var l=s;return s-=t.length,s>=0&&e.slice(s,l)==t}function Yv(e){return e=qe(e),e&&rt.test(e)?e.replace(Ii,Uf):e}function Xv(e){return e=qe(e),e&&Rt.test(e)?e.replace(pt,"\\$&"):e}var Zv=ns(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),e0=ns(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),t0=Su("toLowerCase");function r0(e,t,s){e=qe(e),t=we(t);var a=t?Xi(e):0;if(!t||a>=t)return e;var l=(t-a)/2;return Kn(Fn(l),s)+e+Kn(Nn(l),s)}function i0(e,t,s){e=qe(e),t=we(t);var a=t?Xi(e):0;return t&&a<t?e+Kn(t-a,s):e}function s0(e,t,s){e=qe(e),t=we(t);var a=t?Xi(e):0;return t&&a<t?Kn(t-a,s)+e:e}function n0(e,t,s){return s||t==null?t=0:t&&(t=+t),fp(qe(e).replace(dt,""),t||0)}function o0(e,t,s){return(s?Yt(e,t,s):t===r)?t=1:t=we(t),pa(qe(e),t)}function a0(){var e=arguments,t=qe(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var c0=ns(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function u0(e,t,s){return s&&typeof s!="number"&&Yt(e,t,s)&&(t=s=r),s=s===r?V:s>>>0,s?(e=qe(e),e&&(typeof t=="string"||t!=null&&!$a(t))&&(t=fr(t),!t&&Yi(e))?yi(Cr(e),0,s):e.split(t,s)):[]}var h0=ns(function(e,t,s){return e+(s?" ":"")+ja(t)});function l0(e,t,s){return e=qe(e),s=s==null?0:Fi(we(s),0,e.length),t=fr(t),e.slice(s,s+t.length)==t}function f0(e,t,s){var a=f.templateSettings;s&&Yt(e,t,s)&&(t=r),e=qe(e),t=so({},t,a,Fu);var l=so({},t.imports,a.imports,Fu),p=jt(l),m=Qo(l,p),w,P,D=0,L=t.interpolate||Hi,U="__p += '",J=Xo((t.escape||Hi).source+"|"+L.source+"|"+(L===at?Io:Hi).source+"|"+(t.evaluate||Hi).source+"|$","g"),te="//# sourceURL="+(je.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ko+"]")+`
`;e.replace(J,function(ae,Pe,Ce,dr,Xt,gr){return Ce||(Ce=dr),U+=e.slice(D,gr).replace(Oo,zf),Pe&&(w=!0,U+=`' +
__e(`+Pe+`) +
'`),Xt&&(P=!0,U+=`';
`+Xt+`;
__p += '`),Ce&&(U+=`' +
((__t = (`+Ce+`)) == null ? '' : __t) +
'`),D=gr+ae.length,ae}),U+=`';
`;var oe=je.call(t,"variable")&&t.variable;if(!oe)U=`with (obj) {
`+U+`
}
`;else if(Eo.test(oe))throw new de(v);U=(P?U.replace($r,""):U).replace(Wt,"$1").replace(Br,"$1;"),U="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+U+`return __p
}`;var be=Ph(function(){return Le(p,te+"return "+U).apply(r,m)});if(be.source=U,La(be))throw be;return be}function p0(e){return qe(e).toLowerCase()}function d0(e){return qe(e).toUpperCase()}function g0(e,t,s){if(e=qe(e),e&&(s||t===r))return Dc(e);if(!e||!(t=fr(t)))return e;var a=Cr(e),l=Cr(t),p=Lc(a,l),m=$c(a,l)+1;return yi(a,p,m).join("")}function y0(e,t,s){if(e=qe(e),e&&(s||t===r))return e.slice(0,Mc(e)+1);if(!e||!(t=fr(t)))return e;var a=Cr(e),l=$c(a,Cr(t))+1;return yi(a,0,l).join("")}function v0(e,t,s){if(e=qe(e),e&&(s||t===r))return e.replace(dt,"");if(!e||!(t=fr(t)))return e;var a=Cr(e),l=Lc(a,Cr(t));return yi(a,l).join("")}function m0(e,t){var s=re,a=ue;if(ct(t)){var l="separator"in t?t.separator:l;s="length"in t?we(t.length):s,a="omission"in t?fr(t.omission):a}e=qe(e);var p=e.length;if(Yi(e)){var m=Cr(e);p=m.length}if(s>=p)return e;var w=s-Xi(a);if(w<1)return a;var P=m?yi(m,0,w).join(""):e.slice(0,w);if(l===r)return P+a;if(m&&(w+=P.length-w),$a(l)){if(e.slice(w).search(l)){var D,L=P;for(l.global||(l=Xo(l.source,qe(yr.exec(l))+"g")),l.lastIndex=0;D=l.exec(L);)var U=D.index;P=P.slice(0,U===r?w:U)}}else if(e.indexOf(fr(l),w)!=w){var J=P.lastIndexOf(l);J>-1&&(P=P.slice(0,J))}return P+a}function w0(e){return e=qe(e),e&&ht.test(e)?e.replace(ai,Wf):e}var _0=ns(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),ja=Su("toUpperCase");function Ih(e,t,s){return e=qe(e),t=s?r:t,t===r?Hf(e)?Yf(e):Df(e):e.match(t)||[]}var Ph=Ie(function(e,t){try{return Mt(e,r,t)}catch(s){return La(s)?s:new de(s)}}),b0=Yr(function(e,t){return mr(t,function(s){s=zr(s),Jr(e,s,Fa(e[s],e))}),e});function E0(e){var t=e==null?0:e.length,s=ne();return e=t?st(e,function(a){if(typeof a[1]!="function")throw new wr(d);return[s(a[0]),a[1]]}):[],Ie(function(a){for(var l=-1;++l<t;){var p=e[l];if(Mt(p[0],this,a))return Mt(p[1],this,a)}})}function x0(e){return Wp(br(e,k))}function Ua(e){return function(){return e}}function I0(e,t){return e==null||e!==e?t:e}var P0=Ru(),S0=Ru(!0);function or(e){return e}function za(e){return su(typeof e=="function"?e:br(e,k))}function A0(e){return ou(br(e,k))}function R0(e,t){return au(e,br(t,k))}var C0=Ie(function(e,t){return function(s){return Cs(s,e,t)}}),O0=Ie(function(e,t){return function(s){return Cs(e,s,t)}});function ka(e,t,s){var a=jt(t),l=jn(t,a);s==null&&!(ct(t)&&(l.length||!a.length))&&(s=t,t=e,e=this,l=jn(t,jt(t)));var p=!(ct(s)&&"chain"in s)||!!s.chain,m=Zr(e);return mr(l,function(w){var P=t[w];e[w]=P,m&&(e.prototype[w]=function(){var D=this.__chain__;if(p||D){var L=e(this.__wrapped__),U=L.__actions__=ir(this.__actions__);return U.push({func:P,args:arguments,thisArg:e}),L.__chain__=D,L}return P.apply(e,hi([this.value()],arguments))})}),e}function T0(){return Re._===this&&(Re._=ip),this}function Ha(){}function N0(e){return e=we(e),Ie(function(t){return cu(t,e)})}var F0=_a(st),D0=_a(Cc),L0=_a(Vo);function Sh(e){return Aa(e)?Ko(zr(e)):ld(e)}function $0(e){return function(t){return e==null?r:Di(e,t)}}var q0=Ou(),M0=Ou(!0);function Ba(){return[]}function Va(){return!1}function j0(){return{}}function U0(){return""}function z0(){return!0}function k0(e,t){if(e=we(e),e<1||e>H)return[];var s=V,a=Bt(e,V);t=ne(t),e-=V;for(var l=Jo(a,t);++s<e;)t(s);return l}function H0(e){return me(e)?st(e,zr):pr(e)?[e]:ir(Ku(qe(e)))}function B0(e){var t=++tp;return qe(e)+t}var V0=Vn(function(e,t){return e+t},0),K0=ba("ceil"),G0=Vn(function(e,t){return e/t},1),W0=ba("floor");function J0(e){return e&&e.length?Mn(e,or,oa):r}function Q0(e,t){return e&&e.length?Mn(e,ne(t,2),oa):r}function Y0(e){return Nc(e,or)}function X0(e,t){return Nc(e,ne(t,2))}function Z0(e){return e&&e.length?Mn(e,or,ha):r}function e1(e,t){return e&&e.length?Mn(e,ne(t,2),ha):r}var t1=Vn(function(e,t){return e*t},1),r1=ba("round"),i1=Vn(function(e,t){return e-t},0);function s1(e){return e&&e.length?Wo(e,or):0}function n1(e,t){return e&&e.length?Wo(e,ne(t,2)):0}return f.after=Ay,f.ary=ih,f.assign=dv,f.assignIn=vh,f.assignInWith=so,f.assignWith=gv,f.at=yv,f.before=sh,f.bind=Fa,f.bindAll=b0,f.bindKey=nh,f.castArray=jy,f.chain=eh,f.chunk=Wd,f.compact=Jd,f.concat=Qd,f.cond=E0,f.conforms=x0,f.constant=Ua,f.countBy=sy,f.create=vv,f.curry=oh,f.curryRight=ah,f.debounce=ch,f.defaults=mv,f.defaultsDeep=wv,f.defer=Ry,f.delay=Cy,f.difference=Yd,f.differenceBy=Xd,f.differenceWith=Zd,f.drop=eg,f.dropRight=tg,f.dropRightWhile=rg,f.dropWhile=ig,f.fill=sg,f.filter=oy,f.flatMap=uy,f.flatMapDeep=hy,f.flatMapDepth=ly,f.flatten=Qu,f.flattenDeep=ng,f.flattenDepth=og,f.flip=Oy,f.flow=P0,f.flowRight=S0,f.fromPairs=ag,f.functions=Sv,f.functionsIn=Av,f.groupBy=fy,f.initial=ug,f.intersection=hg,f.intersectionBy=lg,f.intersectionWith=fg,f.invert=Cv,f.invertBy=Ov,f.invokeMap=dy,f.iteratee=za,f.keyBy=gy,f.keys=jt,f.keysIn=nr,f.map=Xn,f.mapKeys=Nv,f.mapValues=Fv,f.matches=A0,f.matchesProperty=R0,f.memoize=eo,f.merge=Dv,f.mergeWith=mh,f.method=C0,f.methodOf=O0,f.mixin=ka,f.negate=to,f.nthArg=N0,f.omit=Lv,f.omitBy=$v,f.once=Ty,f.orderBy=yy,f.over=F0,f.overArgs=Ny,f.overEvery=D0,f.overSome=L0,f.partial=Da,f.partialRight=uh,f.partition=vy,f.pick=qv,f.pickBy=wh,f.property=Sh,f.propertyOf=$0,f.pull=yg,f.pullAll=Xu,f.pullAllBy=vg,f.pullAllWith=mg,f.pullAt=wg,f.range=q0,f.rangeRight=M0,f.rearg=Fy,f.reject=_y,f.remove=_g,f.rest=Dy,f.reverse=Ta,f.sampleSize=Ey,f.set=jv,f.setWith=Uv,f.shuffle=xy,f.slice=bg,f.sortBy=Sy,f.sortedUniq=Rg,f.sortedUniqBy=Cg,f.split=u0,f.spread=Ly,f.tail=Og,f.take=Tg,f.takeRight=Ng,f.takeRightWhile=Fg,f.takeWhile=Dg,f.tap=Jg,f.throttle=$y,f.thru=Yn,f.toArray=dh,f.toPairs=_h,f.toPairsIn=bh,f.toPath=H0,f.toPlainObject=yh,f.transform=zv,f.unary=qy,f.union=Lg,f.unionBy=$g,f.unionWith=qg,f.uniq=Mg,f.uniqBy=jg,f.uniqWith=Ug,f.unset=kv,f.unzip=Na,f.unzipWith=Zu,f.update=Hv,f.updateWith=Bv,f.values=cs,f.valuesIn=Vv,f.without=zg,f.words=Ih,f.wrap=My,f.xor=kg,f.xorBy=Hg,f.xorWith=Bg,f.zip=Vg,f.zipObject=Kg,f.zipObjectDeep=Gg,f.zipWith=Wg,f.entries=_h,f.entriesIn=bh,f.extend=vh,f.extendWith=so,ka(f,f),f.add=V0,f.attempt=Ph,f.camelCase=Jv,f.capitalize=Eh,f.ceil=K0,f.clamp=Kv,f.clone=Uy,f.cloneDeep=ky,f.cloneDeepWith=Hy,f.cloneWith=zy,f.conformsTo=By,f.deburr=xh,f.defaultTo=I0,f.divide=G0,f.endsWith=Qv,f.eq=Tr,f.escape=Yv,f.escapeRegExp=Xv,f.every=ny,f.find=ay,f.findIndex=Wu,f.findKey=_v,f.findLast=cy,f.findLastIndex=Ju,f.findLastKey=bv,f.floor=W0,f.forEach=th,f.forEachRight=rh,f.forIn=Ev,f.forInRight=xv,f.forOwn=Iv,f.forOwnRight=Pv,f.get=qa,f.gt=Vy,f.gte=Ky,f.has=Rv,f.hasIn=Ma,f.head=Yu,f.identity=or,f.includes=py,f.indexOf=cg,f.inRange=Gv,f.invoke=Tv,f.isArguments=qi,f.isArray=me,f.isArrayBuffer=Gy,f.isArrayLike=sr,f.isArrayLikeObject=_t,f.isBoolean=Wy,f.isBuffer=vi,f.isDate=Jy,f.isElement=Qy,f.isEmpty=Yy,f.isEqual=Xy,f.isEqualWith=Zy,f.isError=La,f.isFinite=ev,f.isFunction=Zr,f.isInteger=hh,f.isLength=ro,f.isMap=lh,f.isMatch=tv,f.isMatchWith=rv,f.isNaN=iv,f.isNative=sv,f.isNil=ov,f.isNull=nv,f.isNumber=fh,f.isObject=ct,f.isObjectLike=yt,f.isPlainObject=Ls,f.isRegExp=$a,f.isSafeInteger=av,f.isSet=ph,f.isString=io,f.isSymbol=pr,f.isTypedArray=as,f.isUndefined=cv,f.isWeakMap=uv,f.isWeakSet=hv,f.join=pg,f.kebabCase=Zv,f.last=xr,f.lastIndexOf=dg,f.lowerCase=e0,f.lowerFirst=t0,f.lt=lv,f.lte=fv,f.max=J0,f.maxBy=Q0,f.mean=Y0,f.meanBy=X0,f.min=Z0,f.minBy=e1,f.stubArray=Ba,f.stubFalse=Va,f.stubObject=j0,f.stubString=U0,f.stubTrue=z0,f.multiply=t1,f.nth=gg,f.noConflict=T0,f.noop=Ha,f.now=Zn,f.pad=r0,f.padEnd=i0,f.padStart=s0,f.parseInt=n0,f.random=Wv,f.reduce=my,f.reduceRight=wy,f.repeat=o0,f.replace=a0,f.result=Mv,f.round=r1,f.runInContext=I,f.sample=by,f.size=Iy,f.snakeCase=c0,f.some=Py,f.sortedIndex=Eg,f.sortedIndexBy=xg,f.sortedIndexOf=Ig,f.sortedLastIndex=Pg,f.sortedLastIndexBy=Sg,f.sortedLastIndexOf=Ag,f.startCase=h0,f.startsWith=l0,f.subtract=i1,f.sum=s1,f.sumBy=n1,f.template=f0,f.times=k0,f.toFinite=ei,f.toInteger=we,f.toLength=gh,f.toLower=p0,f.toNumber=Ir,f.toSafeInteger=pv,f.toString=qe,f.toUpper=d0,f.trim=g0,f.trimEnd=y0,f.trimStart=v0,f.truncate=m0,f.unescape=w0,f.uniqueId=B0,f.upperCase=_0,f.upperFirst=ja,f.each=th,f.eachRight=rh,f.first=Yu,ka(f,function(){var e={};return jr(f,function(t,s){je.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),mr(["drop","take"],function(e,t){Ae.prototype[e]=function(s){s=s===r?1:$t(we(s),0);var a=this.__filtered__&&!t?new Ae(this):this.clone();return a.__filtered__?a.__takeCount__=Bt(s,a.__takeCount__):a.__views__.push({size:Bt(s,V),type:e+(a.__dir__<0?"Right":"")}),a},Ae.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),mr(["filter","map","takeWhile"],function(e,t){var s=t+1,a=s==y||s==Y;Ae.prototype[e]=function(l){var p=this.clone();return p.__iteratees__.push({iteratee:ne(l,3),type:s}),p.__filtered__=p.__filtered__||a,p}}),mr(["head","last"],function(e,t){var s="take"+(t?"Right":"");Ae.prototype[e]=function(){return this[s](1).value()[0]}}),mr(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Ae.prototype[e]=function(){return this.__filtered__?new Ae(this):this[s](1)}}),Ae.prototype.compact=function(){return this.filter(or)},Ae.prototype.find=function(e){return this.filter(e).head()},Ae.prototype.findLast=function(e){return this.reverse().find(e)},Ae.prototype.invokeMap=Ie(function(e,t){return typeof e=="function"?new Ae(this):this.map(function(s){return Cs(s,e,t)})}),Ae.prototype.reject=function(e){return this.filter(to(ne(e)))},Ae.prototype.slice=function(e,t){e=we(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Ae(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==r&&(t=we(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Ae.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ae.prototype.toArray=function(){return this.take(V)},jr(Ae.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),l=f[a?"take"+(t=="last"?"Right":""):t],p=a||/^find/.test(t);l&&(f.prototype[t]=function(){var m=this.__wrapped__,w=a?[1]:arguments,P=m instanceof Ae,D=w[0],L=P||me(m),U=function(Pe){var Ce=l.apply(f,hi([Pe],w));return a&&J?Ce[0]:Ce};L&&s&&typeof D=="function"&&D.length!=1&&(P=L=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=p&&!J,be=P&&!te;if(!p&&L){m=be?m:new Ae(this);var ae=e.apply(m,w);return ae.__actions__.push({func:Yn,args:[U],thisArg:r}),new _r(ae,J)}return oe&&be?e.apply(this,w):(ae=this.thru(U),oe?a?ae.value()[0]:ae.value():ae)})}),mr(["pop","push","shift","sort","splice","unshift"],function(e){var t=xn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var l=arguments;if(a&&!this.__chain__){var p=this.value();return t.apply(me(p)?p:[],l)}return this[s](function(m){return t.apply(me(m)?m:[],l)})}}),jr(Ae.prototype,function(e,t){var s=f[t];if(s){var a=s.name+"";je.call(rs,a)||(rs[a]=[]),rs[a].push({name:t,func:s})}}),rs[Bn(r,Ee).name]=[{name:"wrapper",func:r}],Ae.prototype.clone=wp,Ae.prototype.reverse=_p,Ae.prototype.value=bp,f.prototype.at=Qg,f.prototype.chain=Yg,f.prototype.commit=Xg,f.prototype.next=Zg,f.prototype.plant=ty,f.prototype.reverse=ry,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=iy,f.prototype.first=f.prototype.head,Es&&(f.prototype[Es]=ey),f},Zi=Xf();wt?((wt.exports=Zi)._=Zi,Ge._=Zi):Re._=Zi}).call(Vs)})(pc,pc.exports);var eE=Object.defineProperty,tE=Object.defineProperties,rE=Object.getOwnPropertyDescriptors,Cl=Object.getOwnPropertySymbols,iE=Object.prototype.hasOwnProperty,sE=Object.prototype.propertyIsEnumerable,Ol=(u,i,r)=>i in u?eE(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,ao=(u,i)=>{for(var r in i||(i={}))iE.call(i,r)&&Ol(u,r,i[r]);if(Cl)for(var r of Cl(i))sE.call(i,r)&&Ol(u,r,i[r]);return u},nE=(u,i)=>tE(u,rE(i));function ys(u,i,r){var n;const o=V1(u);return((n=i.rpcMap)==null?void 0:n[o.reference])||`${Zb}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function ki(u){return u.includes(":")?u.split(":")[1]:u}function Af(u){return u.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function oE(u,i){const r=Object.keys(i.namespaces).filter(o=>o.includes(u));if(!r.length)return[];const n=[];return r.forEach(o=>{const h=i.namespaces[o].accounts;n.push(...h)}),n}function aE(u={},i={}){const r=Tl(u),n=Tl(i);return pc.exports.merge(r,n)}function Tl(u){var i,r,n,o;const h={};if(!ho(u))return h;for(const[d,v]of Object.entries(u)){const _=Vl(d)?[d]:v.chains,S=v.methods||[],F=v.events||[],k=v.rpcMap||{},B=Ks(d);h[B]=nE(ao(ao({},h[B]),v),{chains:Ga(_,(i=h[B])==null?void 0:i.chains),methods:Ga(S,(r=h[B])==null?void 0:r.methods),events:Ga(F,(n=h[B])==null?void 0:n.events),rpcMap:ao(ao({},k),(o=h[B])==null?void 0:o.rpcMap)})}return h}function cE(u){return u.includes(":")?u.split(":")[2]:u}function uE(u){const i={};for(const[r,n]of Object.entries(u)){const o=n.methods||[],h=n.events||[],d=n.accounts||[],v=Vl(r)?[r]:n.chains?n.chains:Af(n.accounts);i[r]={chains:v,methods:o,events:h,accounts:d}}return i}function sc(u){return typeof u=="number"?u:u.includes("0x")?parseInt(u,16):u.includes(":")?Number(u.split(":")[1]):Number(u)}const Rf={},Et=u=>Rf[u],nc=(u,i)=>{Rf[u]=i};class hE{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const o=ki(r);i[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||ys(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new Ei(new zi(n,Et("disableProviderPing")))}}class lE{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(parseInt(i),r),this.chainId=parseInt(i),this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const n=r||ys(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new Ei(new zi(n,Et("disableProviderPing")))}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const o=parseInt(ki(r));i[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,n;let o=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class fE{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const o=ki(r);i[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||ys(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new Ei(new zi(n,Et("disableProviderPing")))}}class pE{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const o=ki(r);i[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||ys(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new Ei(new zi(n,Et("disableProviderPing")))}}class dE{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),o=ki(r);i[o]=this.createHttpProvider(o,n)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||this.getCardanoRPCUrl(i);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new Ei(new zi(n,Et("disableProviderPing")))}}class gE{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const o=ki(r);i[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||ys(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new Ei(new zi(n,Et("disableProviderPing")))}}class yE{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=Et("events"),this.client=Et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const o=ki(r);i[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||ys(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new Ei(new zi(n,Et("disableProviderPing")))}}var vE=Object.defineProperty,mE=Object.defineProperties,wE=Object.getOwnPropertyDescriptors,Nl=Object.getOwnPropertySymbols,_E=Object.prototype.hasOwnProperty,bE=Object.prototype.propertyIsEnumerable,Fl=(u,i,r)=>i in u?vE(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,co=(u,i)=>{for(var r in i||(i={}))_E.call(i,r)&&Fl(u,r,i[r]);if(Nl)for(var r of Nl(i))bE.call(i,r)&&Fl(u,r,i[r]);return u},oc=(u,i)=>mE(u,wE(i));class Ac{constructor(i){this.events=new vc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Oe.pino(Oe.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||Al})),this.disableProviderPing=(i==null?void 0:i.disableProviderPing)||!1}static async init(i){const r=new Ac(i);return await r.initialize(),r}async request(i,r){const[n,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:co({},i),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(i,r,n){this.request(i,n).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:er("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=uE(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Pf)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;const[n,o]=this.validateChain(i);this.getProvider(n).setDefaultChain(o,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(ds(r)){for(const n of r)i.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Kb.init({logger:this.providerOpts.logger||Al,relayUrl:this.providerOpts.relayUrl||Qb,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>Ks(r)))];nc("client",this.client),nc("events",this.events),nc("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const n=oE(r,this.session),o=Af(n),h=aE(this.namespaces,this.optionalNamespaces),d=oc(co({},h[r]),{accounts:n,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new lE({namespace:d});break;case"solana":this.rpcProviders[r]=new fE({namespace:d});break;case"cosmos":this.rpcProviders[r]=new pE({namespace:d});break;case"polkadot":this.rpcProviders[r]=new hE({namespace:d});break;case"cip34":this.rpcProviders[r]=new dE({namespace:d});break;case"elrond":this.rpcProviders[r]=new gE({namespace:d});break;case"multiversx":this.rpcProviders[r]=new yE({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:n}=r;if(n.name==="accountsChanged"){const o=n.data;o&&ds(o)&&this.events.emit("accountsChanged",o.map(cE))}else if(n.name==="chainChanged"){const o=r.chainId,h=r.event.data,d=Ks(o),v=sc(o)!==sc(h)?`${d}:${sc(h)}`:o;this.onChainChanged(v)}else this.events.emit(n.name,n.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var n;const{namespaces:o}=r,h=(n=this.client)==null?void 0:n.session.get(i);this.session=oc(co({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",oc(co({},er("USER_DISCONNECTED")),{data:i.topic}))}),this.on(xi.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:n,sessionProperties:o}=i;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(i){const[r,n]=(i==null?void 0:i.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(d=>Ks(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const o=Ks(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var n;if(!this.namespaces)return;const[o,h]=this.validateChain(i);r||this.getProvider(o).setDefaultChain(h),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${Rl}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${Rl}/${i}`)}}const EE=Ac,xE="wc",IE="ethereum_provider",PE=`${xE}@2:${IE}:`,SE="https://rpc.walletconnect.com/v1/",dc=["eth_sendTransaction","personal_sign"],AE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],gc=["chainChanged","accountsChanged"],RE=["chainChanged","accountsChanged","message","disconnect","connect"];var CE=Object.defineProperty,OE=Object.defineProperties,TE=Object.getOwnPropertyDescriptors,Dl=Object.getOwnPropertySymbols,NE=Object.prototype.hasOwnProperty,FE=Object.prototype.propertyIsEnumerable,Ll=(u,i,r)=>i in u?CE(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,Ws=(u,i)=>{for(var r in i||(i={}))NE.call(i,r)&&Ll(u,r,i[r]);if(Dl)for(var r of Dl(i))FE.call(i,r)&&Ll(u,r,i[r]);return u},$l=(u,i)=>OE(u,TE(i));function go(u){return Number(u[0].split(":")[1])}function ac(u){return`0x${u.toString(16)}`}function DE(u){const{chains:i,optionalChains:r,methods:n,optionalMethods:o,events:h,optionalEvents:d,rpcMap:v}=u;if(!ds(i))throw new Error("Invalid chains");const _={chains:i,methods:n||dc,events:h||gc,rpcMap:Ws({},i.length?{[go(i)]:v[go(i)]}:{})},S=h==null?void 0:h.filter(K=>!gc.includes(K)),F=n==null?void 0:n.filter(K=>!dc.includes(K));if(!r&&!d&&!o&&!(S!=null&&S.length)&&!(F!=null&&F.length))return{required:i.length?_:void 0};const k=(S==null?void 0:S.length)&&(F==null?void 0:F.length)||!r,B={chains:[...new Set(k?_.chains.concat(r||[]):r)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:AE))],events:[...new Set(_.events.concat(d!=null&&d.length?d:RE))],rpcMap:v};return{required:i.length?_:void 0,optional:r.length?B:void 0}}class Rc{constructor(){this.events=new Sr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=PE,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new Rc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:n}=DE(this.rpc);try{const o=await new Promise(async(d,v)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(S=>{!S.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect($l(Ws({namespaces:Ws({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:i==null?void 0:i.pairingTopic})).then(S=>{d(S)}).catch(S=>{v(new Error(S.message))})});if(!o)return;const h=K1(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:ac(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",ac(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",$l(Ws({},er("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",ac(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,n,o]=i.split(":");return{chainId:`${r}:${n}`,address:o}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,n;const o=(r=i==null?void 0:i.chains)!=null?r:[],h=(n=i==null?void 0:i.optionalChains)!=null?n:[],d=o.concat(h);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const v=o.length?(i==null?void 0:i.methods)||dc:[],_=o.length?(i==null?void 0:i.events)||gc:[],S=(i==null?void 0:i.optionalMethods)||[],F=(i==null?void 0:i.optionalEvents)||[],k=(i==null?void 0:i.rpcMap)||this.buildRpcMap(d,i.projectId),B=(i==null?void 0:i.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(K=>this.formatChainId(K)),optionalChains:h.map(K=>this.formatChainId(K)),methods:v,events:_,optionalMethods:S,optionalEvents:F,rpcMap:k,showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:B,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const n={};return i.forEach(o=>{n[o]=this.getRpcUrl(o,r)}),n}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?go(this.rpc.chains):go(this.rpc.optionalChains),this.signer=await EE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await G1(()=>import("./index-11088e38.js").then(o=>o.i),["./index-11088e38.js","./index-28437983.js","./index-75b6b6db.css"],import.meta.url);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Ws({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:n,rpcMap:o}=i;r&&ds(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),n&&ds(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(i,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[i])||`${SE}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const BE=Rc;export{BE as EthereumProvider,RE as OPTIONAL_EVENTS,AE as OPTIONAL_METHODS,gc as REQUIRED_EVENTS,dc as REQUIRED_METHODS,Rc as default};
